<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Week 3: Grammar of Graphics &amp; ggplot2</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visual Analytics & Data Storytelling with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Weeks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="week01.html">Week 1: Introduction to Data Viz &amp; R</a>
    </li>
    <li>
      <a href="week02.html">Week 2: Visual Perception &amp; Design</a>
    </li>
    <li>
      <a href="week03.html">Week 3: Grammar of Graphics &amp; ggplot2</a>
    </li>
    <li>
      <a href="week04.html">Week 4: Chart Types &amp; Variations</a>
    </li>
    <li>
      <a href="week05.html">Week 5: Data Wrangling Essentials</a>
    </li>
    <li>
      <a href="week06.html">Week 6: Interactive Visualizations</a>
    </li>
    <li>
      <a href="week07.html">Week 7: Geographic Visualization</a>
    </li>
    <li>
      <a href="week08.html">Week 8: Capstone ‚Äî Viz in Practice</a>
    </li>
  </ul>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/patilv/VizAnalytics4Biz">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Week 3: Grammar of Graphics &amp;
ggplot2</h1>

</div>


<div class="hero-banner">
<div class="week-badge">
3
</div>
<h1>
Grammar of Graphics &amp; ggplot2
</h1>
<p>
A systematic framework for constructing visualizations layer by layer in
R
</p>
</div>
<div id="learning-objectives" class="section level2 objectives">
<h2>Learning Objectives</h2>
<p>By the end of this week, you will be able to:</p>
<ul>
<li>Explain the grammar of graphics framework and its seven
components</li>
<li>Build ggplot2 graphics layer by layer from data to finished
visualization</li>
<li>Distinguish between aesthetic mappings inside and outside
<code>aes()</code></li>
<li>Use a variety of geometries (points, lines, bars, histograms,
boxplots)</li>
<li>Apply faceting to create small multiples</li>
<li>Customize scales, labels, and themes for publication-quality
graphics</li>
<li>Combine multiple plots into a single figure using the
<code>patchwork</code> package</li>
<li>Save plots at appropriate sizes and resolutions with
<code>ggsave()</code></li>
</ul>
</div>
<div id="the-grammar-of-graphics" class="section level2">
<h2>The Grammar of Graphics</h2>
<p>In 1999, statistician <strong>Leland Wilkinson</strong> published
<em>The Grammar of Graphics</em>, a book that would fundamentally change
how we think about building visualizations. Wilkinson‚Äôs central insight
was that statistical graphics are not a collection of unrelated chart
types ‚Äì scatterplots, bar charts, histograms, and so on ‚Äì but rather
that every graphic can be described as a combination of a few underlying
components, assembled according to a set of rules.</p>
<p>Just as English grammar gives us rules for constructing sentences
from nouns, verbs, and adjectives, the grammar of graphics gives us
rules for constructing visualizations from data, aesthetics, and
geometries. A sentence is not just a random collection of words; it
follows a structure. A graphic is not just a random collection of marks
on a page; it follows a structure too.</p>
<p>In 2005, <strong>Hadley Wickham</strong> translated Wilkinson‚Äôs
theoretical framework into a practical R package called
<strong>ggplot2</strong> (the ‚Äúgg‚Äù stands for ‚Äúgrammar of graphics‚Äù).
Wickham‚Äôs implementation, described in his 2010 paper ‚ÄúA Layered Grammar
of Graphics,‚Äù organizes every visualization into a series of layers.
This is the system we will use for the rest of the course.</p>
<div class="callout-info">
<p><strong>The ‚Äúgg‚Äù in ggplot2</strong> stands for <em>Grammar of
Graphics</em>. The ‚Äú2‚Äù indicates that this is the second iteration of
Wickham‚Äôs package. The first version, <code>ggplot</code>, was never
widely released. When we refer to ‚Äúggplot‚Äù in code, we mean the
<code>ggplot()</code> function from the <code>ggplot2</code>
package.</p>
</div>
<div id="the-seven-layers" class="section level3">
<h3>The Seven Layers</h3>
<p>Every ggplot2 graphic is constructed from up to seven layers. Not
every plot uses all seven, but understanding each one gives you complete
control over your visualizations:</p>
<table>
<colgroup>
<col width="24%" />
<col width="44%" />
<col width="31%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Layer</th>
<th align="left">Description</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Data</strong></td>
<td align="left">The dataset being visualized</td>
<td align="left"><code>ggplot(mpg, ...)</code></td>
</tr>
<tr class="even">
<td align="left"><strong>Aesthetics</strong></td>
<td align="left">Mappings from data variables to visual properties</td>
<td
align="left"><code>aes(x = displ, y = hwy, color = class)</code></td>
</tr>
<tr class="odd">
<td align="left"><strong>Geometries</strong></td>
<td align="left">The visual marks that represent data points</td>
<td align="left"><code>geom_point()</code>, <code>geom_line()</code>,
<code>geom_col()</code></td>
</tr>
<tr class="even">
<td align="left"><strong>Facets</strong></td>
<td align="left">Splitting the plot into panels by a variable</td>
<td align="left"><code>facet_wrap(~class)</code></td>
</tr>
<tr class="odd">
<td align="left"><strong>Statistics</strong></td>
<td align="left">Statistical transformations of the data</td>
<td align="left"><code>stat_smooth()</code>, binning, counting</td>
</tr>
<tr class="even">
<td align="left"><strong>Coordinates</strong></td>
<td align="left">The coordinate system</td>
<td align="left"><code>coord_flip()</code>,
<code>coord_polar()</code></td>
</tr>
<tr class="odd">
<td align="left"><strong>Themes</strong></td>
<td align="left">Non-data visual appearance</td>
<td align="left"><code>theme_minimal()</code>, font sizes, grid
lines</td>
</tr>
</tbody>
</table>
<p>Think of it this way: the <strong>data</strong> is your raw material.
<strong>Aesthetics</strong> are the instructions for how to translate
that material into visual form. <strong>Geometries</strong> are the
shapes that appear on the page. <strong>Facets</strong> let you repeat
the same plot for subsets of the data. <strong>Statistics</strong>
transform your data before it reaches the geometry.
<strong>Coordinates</strong> define the space in which everything is
drawn. And <strong>themes</strong> control the final appearance of
everything that is not data.</p>
<div class="callout-ignatian">
<p><strong>Ignatian Reflection: Intentional Design</strong></p>
<p>The grammar of graphics is, at its heart, a discipline of
intentionality. It asks you to be deliberate about every layer ‚Äì to
choose your data carefully, to map variables to aesthetics purposefully,
to select geometries that reveal rather than obscure. This mirrors the
Ignatian practice of discernment: every choice should be made with
reflection, every element should serve the truth. When you build a
ggplot, ask yourself at each layer: <em>Does this serve clarity? Does
this help the viewer see what is real?</em></p>
</div>
<hr />
</div>
</div>
<div id="try-it-grammar-of-graphics-layer-builder"
class="section level2">
<h2>Try It: Grammar of Graphics Layer Builder</h2>
<p>You have just learned how ggplot2 builds visualizations layer by
layer. Now construct your own plot interactively. The sandbox below lets
you toggle each layer on and off and see how the plot changes ‚Äî no
coding required.</p>
<div class="sandbox-section">
<div class="sandbox-header">
<p><span class="sandbox-icon">üß™</span> Grammar of Graphics Layer
Builder</p>
</div>
<iframe class="sandbox-frame" src="https://analytics.gonzaga.edu/week03-layers/" height="600" loading="lazy" allowfullscreen>
</iframe>
<div class="sandbox-cold-start">
<p>If the app takes a few seconds to load on first visit, that is normal
‚Äî the server is waking up.</p>
</div>
</div>
<div class="try-it-box">
<p><strong>Exploration Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Start with only the <strong>data</strong> and
<strong>geom_point</strong> layers enabled. What do you see?</li>
<li>Add a <strong>smooth line</strong> ‚Äî how does the story change?</li>
<li>Toggle on <strong>faceting</strong> ‚Äî what new patterns emerge when
the data is split by group?</li>
<li>Experiment with different <strong>themes</strong> ‚Äî which one do you
find most readable and professional?</li>
</ol>
</div>
<div class="callout-info">
<p><strong>What You Should Have Noticed:</strong> Each layer adds a
distinct piece of information to the plot. The beauty of the Grammar of
Graphics is that layers are independent ‚Äî you can add, remove, or modify
any layer without affecting the others. This modular approach makes
ggplot2 incredibly flexible.</p>
</div>
<div class="callout-ai">
<p><strong>AI &amp; This Concept</strong> When asking AI to build a
ggplot, describe the layers you want explicitly: ‚ÄúAdd a scatter layer,
then a smooth line, then facet by category.‚Äù AI tools produce better
results when you use the grammar of graphics vocabulary ‚Äî geom,
aesthetic, facet, scale, theme ‚Äî rather than vague requests like ‚Äúmake a
nice chart.‚Äù</p>
</div>
<hr />
</div>
<div id="common-ggplot2-errors" class="section level2">
<h2>Common ggplot2 Errors</h2>
<p>Before we start writing code, let us address the errors you are most
likely to encounter. In an asynchronous course, you cannot raise your
hand when something goes wrong ‚Äì so study this box carefully and
bookmark it. Nearly every student hits at least one of these during
their first week with ggplot2.</p>
<div class="callout-error">
<p><strong>Troubleshooting ggplot2: The Six Most Common
Errors</strong></p>
<p><strong>1. <code>Error: unexpected '+'</code></strong></p>
<p>You started a new line <em>before</em> the <code>+</code>. The
<code>+</code> must be at the <strong>end</strong> of the previous line,
not the beginning of the next.</p>
<pre><code># WRONG -- R thinks line 1 is a complete command
ggplot(mpg, aes(x = displ, y = hwy))
  + geom_point()

# RIGHT -- the + tells R &quot;there is more coming&quot;
ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point()</code></pre>
<p><strong>2. <code>Error: object 'displ' not found</code></strong></p>
<p>Did you forget <code>aes()</code>? Column names must be wrapped
inside <code>aes()</code> so that ggplot2 knows to look for them in the
data frame, not in your global environment.</p>
<pre><code># WRONG
ggplot(mpg, x = displ, y = hwy) + geom_point()

# RIGHT
ggplot(mpg, aes(x = displ, y = hwy)) + geom_point()</code></pre>
<p><strong>3.
<code>Error: could not find function "ggplot"</code></strong></p>
<p>You forgot to load the package. Run <code>library(tidyverse)</code>
(or <code>library(ggplot2)</code>) at the top of your script before
calling any ggplot functions. This must be done every time you start a
new R session.</p>
<p><strong>4. Plot colors are not changing</strong></p>
<p>Are you putting <code>color = "blue"</code> <em>inside</em> or
<em>outside</em> <code>aes()</code>? Inside <code>aes()</code> maps a
variable to color (each value gets a different color). Outside
<code>aes()</code> sets a single fixed color for all points.</p>
<pre><code># Maps the variable class to color (a legend appears)
geom_point(aes(color = class))

# Sets ALL points to blue (no legend)
geom_point(color = &quot;blue&quot;)

# COMMON MISTAKE -- puts a literal string inside aes()
# This creates a legend with one entry labeled &quot;blue&quot;
geom_point(aes(color = &quot;blue&quot;))</code></pre>
<p><strong>5.
<code>Error: stat_count() must not be used with a y aesthetic</code></strong></p>
<p>You used <code>geom_bar()</code> but also provided a <code>y</code>
aesthetic. <code>geom_bar()</code> counts rows for you ‚Äì it creates its
own y. If you already have pre-computed y values, use
<code>geom_col()</code> instead.</p>
<pre><code># WRONG -- geom_bar() tries to count, but you gave it y
ggplot(df, aes(x = category, y = value)) + geom_bar()

# RIGHT -- geom_col() uses the y values you provide
ggplot(df, aes(x = category, y = value)) + geom_col()</code></pre>
<p><strong>6. <code>Error: cannot open the connection</code> with
<code>ggsave()</code></strong></p>
<p>The file path you specified does not exist, or you do not have write
permission. Check that the folder exists before saving. Use
<code>dir.exists("my_folder")</code> to verify.</p>
<pre><code># Check the folder exists first
dir.exists(&quot;output&quot;)  # returns TRUE or FALSE

# Save to an existing folder
ggsave(&quot;output/my_plot.png&quot;, width = 8, height = 5, dpi = 300)</code></pre>
</div>
<hr />
</div>
<div id="building-a-plot-layer-by-layer" class="section level2">
<h2>Building a Plot Layer by Layer</h2>
<p>The best way to understand the grammar of graphics is to build a plot
one layer at a time. We will use the <code>mpg</code> dataset, which is
built into ggplot2 and contains fuel economy data for 234 cars.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Let us begin with nothing but the data and an aesthetic mapping, and
then add layers one at a time. Each step below is a separately runnable
code chunk ‚Äì run them in order and watch the plot evolve.</p>
<div id="step-1-data-and-aesthetic-mapping" class="section level3">
<h3>Step 1: Data and Aesthetic Mapping</h3>
<p>This creates an empty canvas. ggplot2 knows what data to use and
which variables to map to the x and y axes, but it has no instructions
for how to draw anything yet.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy))</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-layer-step1-1.png" alt="" width="768" /></p>
</div>
<div id="step-2-add-a-geometry" class="section level3">
<h3>Step 2: Add a Geometry</h3>
<p>Now we add <code>geom_point()</code>, and the data appears as a
scatterplot. The geometry tells ggplot2 <em>how</em> to represent each
observation ‚Äì in this case, as a dot.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-layer-step2-1.png" alt="" width="768" /></p>
</div>
<div id="step-3-map-color-to-a-variable" class="section level3">
<h3>Step 3: Map Color to a Variable</h3>
<p>By adding <code>color = class</code> inside <code>aes()</code>, each
vehicle class gets a distinct color. A legend is automatically
generated.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-layer-step3-1.png" alt="" width="768" /></p>
</div>
<div id="step-4-add-a-statistical-layer" class="section level3">
<h3>Step 4: Add a Statistical Layer</h3>
<p>A linear smoother for each class reveals the group-level trends. The
<code>se = FALSE</code> argument suppresses the confidence interval
shading to keep the plot clean.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-layer-step4-1.png" alt="" width="768" /></p>
</div>
<div id="step-5-add-labels" class="section level3">
<h3>Step 5: Add Labels</h3>
<p>Good labels tell the reader what they are looking at. The
<code>labs()</code> function sets the title, subtitle, axis labels, and
legend title all in one call.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Engine Size vs. Highway Fuel Economy&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Larger engines tend to have lower fuel economy&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine Displacement (L)&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Vehicle Class&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-layer-step5-1.png" alt="" width="768" /></p>
</div>
<div id="step-6-apply-a-theme" class="section level3">
<h3>Step 6: Apply a Theme</h3>
<p>Finally, we replace the default gray background with a cleaner
<code>theme_minimal()</code>. The <code>base_size</code> argument
controls the overall font size.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Engine Size vs. Highway Fuel Economy&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Larger engines tend to have lower fuel economy&quot;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine Displacement (L)&quot;</span>,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Vehicle Class&quot;</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-layer-step6-1.png" alt="" width="768" /></p>
<p>Notice how each layer adds something specific. The plot evolves from
an empty coordinate system to a rich, informative graphic. This is the
power of the layered grammar: you can think about one thing at a
time.</p>
</div>
<div id="the-fluent-pipeline-style" class="section level3">
<h3>The Fluent Pipeline Style</h3>
<p>Here is the same final plot written as a single, fluent pipeline ‚Äì
the style you will typically use in practice:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Engine Size vs. Highway Fuel Economy&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Larger engines tend to have lower fuel economy&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine Displacement (L)&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Vehicle Class&quot;</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-single-pipeline-1.png" alt="" width="768" /></p>
<div class="callout-tip">
<p><strong>Tip:</strong> The <code>+</code> operator in ggplot2 is how
you add layers. It is conceptually similar to the <code>%&gt;%</code>
pipe, but ggplot2 was created before the pipe became standard in R, so
it uses <code>+</code> instead. A common mistake is to use
<code>%&gt;%</code> inside a ggplot chain ‚Äì this will produce an error.
Use <code>%&gt;%</code> to pipe <em>data into</em>
<code>ggplot()</code>, then switch to <code>+</code> for adding
layers.</p>
</div>
<hr />
</div>
</div>
<div id="aesthetic-mappings-aes" class="section level2">
<h2>Aesthetic Mappings ‚Äì <code>aes()</code></h2>
<p>Aesthetics are the bridge between your data and the visual properties
of your plot. The <code>aes()</code> function maps variables in your
data to visual channels such as position (x, y), color, size, shape, and
transparency (alpha).</p>
<p>The critical distinction to understand is:</p>
<ul>
<li><strong>Inside <code>aes()</code></strong>: The visual property
varies with the data. Each data value gets a different color, size, or
position.</li>
<li><strong>Outside <code>aes()</code></strong>: The visual property is
fixed for all observations. Every point gets the same color, size, or
shape.</li>
</ul>
<p>This is one of the most common sources of confusion for beginners, so
let us see the difference side by side:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Color MAPPED to a data variable (inside aes)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color mapped to data (inside aes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># Color SET to a fixed value (outside aes)</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#C41E3A&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color fixed (outside aes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-aes-inside-outside-1.png" alt="" width="960" /></p>
<p>In the left panel, each vehicle class gets its own color, and a
legend is automatically generated. In the right panel, every point is
Gonzaga red regardless of its class, and there is no legend because
color is not encoding any information.</p>
<p>Here is a summary of common aesthetic mappings:</p>
<table>
<colgroup>
<col width="33%" />
<col width="39%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Aesthetic</th>
<th align="left">Description</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>x</code>, <code>y</code></td>
<td align="left">Position on the axes</td>
<td align="left"><code>aes(x = displ, y = hwy)</code></td>
</tr>
<tr class="even">
<td align="left"><code>color</code></td>
<td align="left">Outline color (points, lines) or fill color (text)</td>
<td align="left"><code>aes(color = class)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>fill</code></td>
<td align="left">Interior fill color (bars, boxes, areas)</td>
<td align="left"><code>aes(fill = class)</code></td>
</tr>
<tr class="even">
<td align="left"><code>size</code></td>
<td align="left">Size of points or width of lines</td>
<td align="left"><code>aes(size = cyl)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>shape</code></td>
<td align="left">Shape of points (circle, triangle, square, etc.)</td>
<td align="left"><code>aes(shape = drv)</code></td>
</tr>
<tr class="even">
<td align="left"><code>alpha</code></td>
<td align="left">Transparency (0 = invisible, 1 = opaque)</td>
<td align="left"><code>aes(alpha = year)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>linetype</code></td>
<td align="left">Type of line (solid, dashed, dotted)</td>
<td align="left"><code>aes(linetype = drv)</code></td>
</tr>
</tbody>
</table>
</div>
<div id="try-it-aesthetic-mapping-sandbox" class="section level2">
<h2>Try It: Aesthetic Mapping Sandbox</h2>
<p>You have just learned how <code>aes()</code> maps data variables to
visual properties. Now experiment interactively ‚Äî pick which variables
map to color, size, and shape, and watch both the plot and the generated
R code update in real time.</p>
<div class="sandbox-section">
<div class="sandbox-header">
<p><span class="sandbox-icon">üß™</span> Aesthetic Mapping Sandbox</p>
</div>
<iframe class="sandbox-frame" src="https://analytics.gonzaga.edu/week03-aestheticmapping/" height="600" loading="lazy" allowfullscreen>
</iframe>
<div class="sandbox-cold-start">
<p>If the app takes a few seconds to load on first visit, that is normal
‚Äî the server is waking up.</p>
</div>
</div>
<div class="try-it-box">
<p><strong>Exploration Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Start with just X and Y (the defaults). All points are navy ‚Äî color
carries no information.</li>
<li>Set <strong>Color</strong> to <code>class</code> ‚Äî how many vehicle
classes can you distinguish at a glance?</li>
<li>Now also set <strong>Size</strong> to <code>cty</code> ‚Äî does adding
a third channel help or hurt readability?</li>
<li>Turn on all three optional aesthetics. Read the overload warning ‚Äî
do you agree?</li>
</ol>
</div>
<div class="callout-info">
<p><strong>What You Should Have Noticed:</strong> Each aesthetic channel
can encode one variable. Mapping too many variables at once creates
cognitive overload ‚Äî the viewer cannot track more than 3-4 channels
simultaneously. The generated code panel shows you exactly what
<code>aes()</code> call produces each plot, reinforcing the connection
between code and visual output.</p>
</div>
<div class="callout-ai">
<p><strong>AI &amp; This Concept</strong> When prompting AI to build a
ggplot, specify your aesthetic mappings explicitly: ‚ÄúMap
<code>class</code> to color and <code>cty</code> to size inside
<code>aes()</code>.‚Äù AI tools often default to fixed colors when you say
‚Äúmake it colorful‚Äù instead of mapping a data variable. Using the
vocabulary ‚Äî <code>aes()</code>, mapped vs.¬†fixed, aesthetic channel ‚Äî
gets better results.</p>
</div>
<hr />
</div>
<div id="geometries" class="section level2 tabset">
<h2 class="tabset">Geometries</h2>
<p>Geometries ‚Äì or <strong>geoms</strong> ‚Äì are the visual marks that
represent your data. Choosing the right geom is one of the most
important decisions you make when building a visualization. Each geom is
suited to different types of data and different analytical
questions.</p>
<div id="points-geom_point" class="section level3">
<h3>Points (geom_point)</h3>
<p>Scatterplots are the workhorse of exploratory data analysis. Use
<code>geom_point()</code> when you want to show the relationship between
two continuous variables.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;#002967&quot;</span>, <span class="st">&quot;f&quot;</span> <span class="ot">=</span> <span class="st">&quot;#C41E3A&quot;</span>, <span class="st">&quot;r&quot;</span> <span class="ot">=</span> <span class="st">&quot;#B4975A&quot;</span>),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;4-wheel&quot;</span>, <span class="st">&quot;f&quot;</span> <span class="ot">=</span> <span class="st">&quot;Front&quot;</span>, <span class="st">&quot;r&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rear&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatterplot with geom_point()&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Engine displacement vs. highway MPG by drive type&quot;</span>,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine Displacement (L)&quot;</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Drive Type&quot;</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-geom-point-1.png" alt="" width="768" /></p>
</div>
<div id="lines-geom_line" class="section level3">
<h3>Lines (geom_line)</h3>
<p>Line charts are ideal for showing trends over time. Use
<code>geom_line()</code> when you have a continuous x-axis (often a date
or time) and want to emphasize the flow of values.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>economics <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy <span class="sc">/</span> <span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;U.S. Unemployment Over Time&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Monthly unemployment figures from 1967 to 2015&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Unemployed (millions)&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-geom-line-1.png" alt="" width="768" /></p>
</div>
<div id="bars-geom_col-geom_bar" class="section level3">
<h3>Bars (geom_col / geom_bar)</h3>
<p>Bar charts are excellent for comparing quantities across categories.
Use <code>geom_col()</code> when your data already contains the values
you want to plot; use <code>geom_bar()</code> when you want ggplot2 to
count observations for you.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">count</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">class =</span> <span class="fu">fct_reorder</span>(class, n)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> class)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Vehicle Count by Class&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Number of vehicles in the mpg dataset by class&quot;</span>,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Count&quot;</span>,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">70</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-geom-col-1.png" alt="" width="768" /></p>
</div>
<div id="histogram-geom_histogram" class="section level3">
<h3>Histogram (geom_histogram)</h3>
<p>Histograms show the distribution of a single continuous variable by
dividing it into bins and counting the number of observations in each
bin.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> hwy)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Distribution of Highway MPG&quot;</span>,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Binwidth = 2 MPG&quot;</span>,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-geom-histogram-1.png" alt="" width="768" /></p>
</div>
<div id="boxplot-geom_boxplot" class="section level3">
<h3>Boxplot (geom_boxplot)</h3>
<p>Boxplots summarize the distribution of a continuous variable across
groups. They show the median, interquartile range, and outliers at a
glance.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(class, hwy, <span class="at">.fun =</span> median), <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;#eff6ff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">outlier.color =</span> <span class="st">&quot;#C41E3A&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Highway MPG by Vehicle Class&quot;</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Classes ordered by median highway MPG&quot;</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-geom-boxplot-1.png" alt="" width="768" /></p>
</div>
</div>
<div id="section" class="section level2 unnumbered">
<h2 class="unnumbered"></h2>
<div class="callout-tip">
<p><strong>Choosing the Right Geom:</strong> The choice of geometry
depends on the types of variables you have and the question you are
asking. Two continuous variables? Start with <code>geom_point()</code>.
One continuous variable? Try <code>geom_histogram()</code> or
<code>geom_density()</code>. One categorical and one continuous?
Consider <code>geom_boxplot()</code> or <code>geom_col()</code>. A trend
over time? Use <code>geom_line()</code>. When in doubt, try several and
see which one reveals the most about your data.</p>
</div>
<hr />
</div>
<div id="faceting" class="section level2">
<h2>Faceting</h2>
<p><strong>Faceting</strong> splits your data by one or more categorical
variables and creates a separate panel for each level. This technique ‚Äì
sometimes called <strong>small multiples</strong> ‚Äì is one of the most
powerful tools in data visualization. It allows your viewer to compare
patterns across groups while keeping a consistent scale.</p>
<p>ggplot2 provides two faceting functions:</p>
<ul>
<li><code>facet_wrap(~variable)</code> ‚Äì wraps panels into a rectangular
layout. Best when you have a single faceting variable.</li>
<li><code>facet_grid(row_variable ~ col_variable)</code> ‚Äì creates a
matrix of panels. Best when you want to cross two variables.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;#C41E3A&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Displacement vs. Highway MPG by Vehicle Class&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Each panel shows one vehicle class with a linear trend line&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine Displacement (L)&quot;</span>,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-faceting-demo-1.png" alt="" width="960" /></p>
<p>Notice how the faceted view reveals patterns that a single
scatterplot obscures. For example, the relationship between displacement
and fuel economy is very different for 2-seater sports cars (which are
light despite large engines) compared to SUVs.</p>
<div class="callout-info">
<p><strong>Scales in facets:</strong> By default, all panels share the
same x and y scales. This is usually what you want because it makes
comparisons fair. If you need each panel to have its own scale (for
example, when the ranges differ dramatically), use
<code>scales = "free"</code>, <code>scales = "free_x"</code>, or
<code>scales = "free_y"</code> inside <code>facet_wrap()</code>.</p>
</div>
<hr />
</div>
<div id="scales" class="section level2">
<h2>Scales</h2>
<p><strong>Scales</strong> control how data values are mapped to visual
properties. Every aesthetic mapping has an associated scale, whether or
not you specify one explicitly. When you write
<code>aes(x = displ)</code>, ggplot2 automatically creates a continuous
x scale. When you write <code>aes(color = class)</code>, it creates a
discrete color scale.</p>
<p>Customizing scales gives you control over:</p>
<ul>
<li><strong>Axis breaks and labels</strong> ‚Äì where tick marks appear
and what they say</li>
<li><strong>Color palettes</strong> ‚Äì which colors represent your
data</li>
<li><strong>Transformations</strong> ‚Äì log scales, square root scales,
reversed axes</li>
<li><strong>Formatting</strong> ‚Äì dollar signs, percentages, commas</li>
</ul>
<div id="common-scale-functions" class="section level3">
<h3>Common Scale Functions</h3>
<table>
<colgroup>
<col width="52%" />
<col width="47%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>scale_x_continuous()</code> /
<code>scale_y_continuous()</code></td>
<td align="left">Customize continuous axes</td>
</tr>
<tr class="even">
<td align="left"><code>scale_x_discrete()</code> /
<code>scale_y_discrete()</code></td>
<td align="left">Customize categorical axes</td>
</tr>
<tr class="odd">
<td align="left"><code>scale_color_manual()</code> /
<code>scale_fill_manual()</code></td>
<td align="left">Set specific colors by hand</td>
</tr>
<tr class="even">
<td align="left"><code>scale_color_brewer()</code> /
<code>scale_fill_brewer()</code></td>
<td align="left">Use ColorBrewer palettes</td>
</tr>
<tr class="odd">
<td align="left"><code>scale_color_viridis_c()</code> /
<code>scale_fill_viridis_c()</code></td>
<td align="left">Perceptually uniform, colorblind-friendly</td>
</tr>
<tr class="even">
<td align="left"><code>scale_x_log10()</code> /
<code>scale_y_log10()</code></td>
<td align="left">Log-transformed axes</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">5000</span>), <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price, <span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Diamond Price vs. Carat&quot;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;5,000 randomly sampled diamonds from the diamonds dataset&quot;</span>,</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Carat&quot;</span>,</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Price (USD)&quot;</span>,</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Cut Quality&quot;</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-scales-demo-1.png" alt="" width="768" /></p>
</div>
<div id="gonzaga-color-palette" class="section level3">
<h3>Gonzaga Color Palette</h3>
<p>Throughout this course, we will frequently use Gonzaga‚Äôs official
colors. Here is a reference palette you can use in your own plots:</p>
<div class="figure">
<img src="images/05/color_palette.png" alt="Gonzaga University brand colors for use in data visualization." width="60%" />
<p class="caption">
Gonzaga University brand colors for use in data visualization.
</p>
</div>
<p>You can define a reusable vector of Gonzaga colors:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>gonzaga_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="at">navy =</span> <span class="st">&quot;#002967&quot;</span>,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="at">red  =</span> <span class="st">&quot;#C41E3A&quot;</span>,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="at">gold =</span> <span class="st">&quot;#B4975A&quot;</span>,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="at">light_blue =</span> <span class="st">&quot;#4A90D9&quot;</span>,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="at">light_gray =</span> <span class="st">&quot;#eff6ff&quot;</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="themes" class="section level2">
<h2>Themes</h2>
<p><strong>Themes</strong> control all of the non-data visual elements
of your plot: background colors, grid lines, font sizes, axis tick
marks, legend placement, and more. A well-chosen theme can elevate a
serviceable plot into a professional, publication-ready graphic.</p>
<div id="built-in-themes" class="section level3">
<h3>Built-in Themes</h3>
<p>ggplot2 ships with several built-in themes:</p>
<ul>
<li><code>theme_gray()</code> ‚Äì the default gray background with white
grid lines</li>
<li><code>theme_minimal()</code> ‚Äì a clean, minimal design (our course
default)</li>
<li><code>theme_classic()</code> ‚Äì a traditional look with axis lines
and no grid</li>
<li><code>theme_bw()</code> ‚Äì black and white with a border</li>
<li><code>theme_void()</code> ‚Äì completely blank (useful for maps and
diagrams)</li>
</ul>
<p>The <code>ggthemes</code> package adds many more, inspired by famous
publications and designers:</p>
<ul>
<li><code>theme_economist()</code> ‚Äì styled like <em>The Economist</em>
magazine</li>
<li><code>theme_fivethirtyeight()</code> ‚Äì styled like
FiveThirtyEight</li>
<li><code>theme_tufte()</code> ‚Äì inspired by Edward Tufte‚Äôs minimalist
philosophy</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Displacement (L)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;theme_minimal()&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;theme_classic()&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">theme_economist</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;theme_economist()&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>(base <span class="sc">+</span> <span class="fu">theme_tufte</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;theme_tufte()&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Theme Comparison&quot;</span>,</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)))</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-theme-comparison-1.png" alt="" width="960" /></p>
</div>
<div id="custom-theme-elements" class="section level3">
<h3>Custom Theme Elements</h3>
<p>You can override individual theme elements using the
<code>theme()</code> function. Every element is controlled by one of
four functions:</p>
<ul>
<li><code>element_text()</code> ‚Äì controls text (size, color, face,
family, angle)</li>
<li><code>element_line()</code> ‚Äì controls lines (color, linewidth,
linetype)</li>
<li><code>element_rect()</code> ‚Äì controls rectangles (fill, color,
linewidth)</li>
<li><code>element_blank()</code> ‚Äì removes the element entirely</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;A Custom-Themed Plot&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Demonstrating individual theme element overrides&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine Displacement (L)&quot;</span>,</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Vehicle Class&quot;</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>),</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-custom-theme-1.png" alt="" width="768" /></p>
<div class="callout-tip">
<p><strong>Tip: Build a reusable theme.</strong> If you find yourself
applying the same <code>theme()</code> overrides to every plot, create a
custom theme function. You can then apply it with a single
<code>+ theme_gonzaga()</code> call:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>theme_gonzaga <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">base_size =</span> <span class="dv">13</span>) {</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> base_size) <span class="sc">%+replace%</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">size =</span> base_size <span class="sc">+</span> <span class="dv">3</span>),</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>),</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>),</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    )</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="bonus-tuftes-redesigned-boxplot" class="section level3">
<h3>Bonus: Tufte‚Äôs Redesigned Boxplot</h3>
<p>Edward Tufte proposed a stripped-down version of the boxplot that
removes the ‚Äúbox‚Äù entirely, replacing it with a thin line for the
interquartile range and a point or gap for the median. This maximizes
the data-ink ratio while preserving all essential information. The
<code>ggthemes</code> package provides <code>geom_tufteboxplot()</code>
for this purpose.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="fu">geom_tufteboxplot</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Tufte-Style Boxplot&quot;</span>,</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Minimal ink, maximum data -- compare to the standard boxplot above&quot;</span>,</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Vehicle Class&quot;</span>,</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-tufte-boxplot-1.png" alt="" width="768" /></p>
<p>Compare this to the standard boxplot in the Geometries section above.
The Tufte version conveys the same distributional information ‚Äì median,
spread, outliers ‚Äì using far less ink. Every mark on the page is doing
real work. This is the data-ink ratio in action.</p>
<div class="callout-info">
<p><strong>About ggthemes:</strong> The <code>ggthemes</code> package
provides several Tufte-inspired elements including
<code>theme_tufte()</code>, <code>geom_tufteboxplot()</code>, and
<code>geom_rangeframe()</code>. These are excellent tools for applying
design principles directly in ggplot2.</p>
</div>
<hr />
</div>
</div>
<div id="combining-multiple-plots-with-patchwork"
class="section level2">
<h2>Combining Multiple Plots with patchwork</h2>
<p>The <code>patchwork</code> package makes it easy to combine multiple
ggplot2 plots into a single figure. You have already seen it in action
above. Here is a quick reference for its operators:</p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>p1 + p2</code></td>
<td align="left">Side by side</td>
</tr>
<tr class="even">
<td align="left"><code>p1 / p2</code></td>
<td align="left">Stacked vertically</td>
</tr>
<tr class="odd">
<td align="left"><code>p1 + p2 + plot_layout(ncol = 1)</code></td>
<td align="left">Stacked with explicit layout</td>
</tr>
<tr class="even">
<td align="left"><code>(p1 + p2) / p3</code></td>
<td align="left">Two on top, one on bottom</td>
</tr>
<tr class="odd">
<td align="left"><code>plot_annotation(title = "...")</code></td>
<td align="left">Add an overall title</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>p_scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Scatterplot&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Displacement&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>p_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> hwy)) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">&quot;#C41E3A&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Histogram&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Highway MPG&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>p_box <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> drv, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;#B4975A&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Boxplot&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Drive Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>)</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>p_scatter <span class="sc">+</span> p_hist <span class="sc">+</span> p_box <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Three Views of the mpg Dataset&quot;</span>,</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-patchwork-demo-1.png" alt="" width="960" /></p>
<hr />
</div>
<div id="saving-plots-with-ggsave" class="section level2">
<h2>Saving Plots with ggsave()</h2>
<p>Once you have created a publication-quality graphic, you need to save
it at the right size and resolution. The <code>ggsave()</code> function
makes this straightforward:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Save the last plot displayed</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;my_plot.png&quot;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co"># Save a specific plot object</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>my_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;my_plot.png&quot;</span>, <span class="at">plot =</span> my_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="co"># Save as PDF (vector format -- great for print)</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;my_plot.pdf&quot;</span>, <span class="at">plot =</span> my_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="co"># Save as SVG (vector format -- great for web)</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;my_plot.svg&quot;</span>, <span class="at">plot =</span> my_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<div class="callout-info">
<p><strong>Resolution guidelines:</strong></p>
<ul>
<li><strong>Screen/web:</strong> 72‚Äì150 dpi is sufficient</li>
<li><strong>Presentations:</strong> 150‚Äì200 dpi</li>
<li><strong>Print/publication:</strong> 300 dpi or higher</li>
<li><strong>Vector formats</strong> (PDF, SVG) are
resolution-independent and are preferred for publications</li>
</ul>
</div>
<hr />
</div>
<div id="putting-it-all-together" class="section level2">
<h2>Putting It All Together</h2>
<p>Let us build one more polished visualization that incorporates
everything we have learned this week. We will use the
<code>diamonds</code> dataset to create a comprehensive view of diamond
characteristics:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;#eff6ff&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">labels =</span> <span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cut, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Diamond Price vs. Carat by Cut Quality&quot;</span>,</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Hexagonal binning reveals density patterns across 50,000+ diamonds&quot;</span>,</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Carat&quot;</span>,</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Price (USD)&quot;</span>,</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Count&quot;</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>),</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>),</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="week03_files/figure-html/w3-putting-together-1.png" alt="" width="960" /></p>
<p>This single plot uses data (diamonds), aesthetics (x, y, fill), a
geometry (hexagonal bins), a scale (gradient fill, dollar-formatted
y-axis), faceting (by cut), labels, and a customized theme. Every layer
of the grammar of graphics is working together.</p>
<div class="callout-ignatian">
<p><strong>Ignatian Reflection: Magis in Visualization</strong></p>
<p>The Ignatian principle of <em>magis</em> ‚Äì the ‚Äúmore‚Äù ‚Äì calls us not
to settle for what is merely adequate but to pursue excellence for the
greater good. In data visualization, <em>magis</em> means not settling
for the default. The default gray theme, the default axis labels, the
default color palette ‚Äì these are starting points, not endpoints. Every
design choice is an opportunity to communicate more clearly, more
honestly, more beautifully. As Wickham himself wrote, ‚ÄúA good
visualization shows you things you did not expect, or raises new
questions about the data.‚Äù Pursue that <em>more</em>.</p>
</div>
<hr />
</div>
<div id="challenge-layer-cake" class="section level2">
<h2>Challenge: Layer Cake</h2>
<div class="sandbox-section">
<div class="sandbox-header">
<p><span class="sandbox-icon">üéÆ</span> Layer Cake ‚Äî Stack the grammar
of graphics in the right order</p>
</div>
<iframe class="sandbox-frame" src="https://analytics.gonzaga.edu/week03-game/" height="700" loading="lazy" allowfullscreen>
</iframe>
<div class="sandbox-cold-start">
<p>If the app takes a few seconds to load on first visit, that is normal
‚Äî the server is waking up.</p>
</div>
</div>
<div class="try-it-box">
<p><strong>How to Play:</strong></p>
<ol style="list-style-type: decimal">
<li>Enter your name and click <strong>Start Game</strong></li>
<li>Each round shows a target plot and scrambled ggplot2 layer
fragments</li>
<li>Drag and drop the layers into the correct order ‚Äî the app renders
your ordering vs.¬†the correct one</li>
<li>Complete all 8 rounds, then copy your completion report into the
Canvas assignment</li>
</ol>
</div>
<hr />
</div>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<div class="exercise-block">
<div class="exercise-header">
<p>Week 3 Exercises</p>
</div>
<div class="exercise-body">
<p><strong>Exercise 1: Your First Layered Plot</strong></p>
<p>Using the <code>mpg</code> dataset, build a scatterplot of
<code>cty</code> (city MPG, x-axis) vs.¬†<code>hwy</code> (highway MPG,
y-axis). Fill in the blanks in the template below. Map the
<code>drv</code> variable to color using Gonzaga colors, add axis labels
and a title, and apply <code>theme_minimal()</code>.</p>
<div class="template-code">
<p><strong>Template ‚Äì fill in the <code>___</code> blanks:</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">ggplot</span>(___, <span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;#002967&quot;</span>, <span class="st">&quot;f&quot;</span> <span class="ot">=</span> <span class="st">&quot;___&quot;</span>, <span class="st">&quot;r&quot;</span> <span class="ot">=</span> <span class="st">&quot;___&quot;</span>),</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;4-wheel&quot;</span>, <span class="st">&quot;f&quot;</span> <span class="ot">=</span> <span class="st">&quot;Front&quot;</span>, <span class="st">&quot;r&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rear&quot;</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;City MPG&quot;</span>,</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>,</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Drive Type&quot;</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
</div>
<p>After completing the template, write 1‚Äì2 sentences interpreting the
relationship between city and highway fuel economy. Is there a pattern?
Do the drive types cluster differently?</p>
<p><strong>Exercise 2: Bar Chart with geom_col()</strong></p>
<p>The code below summarizes the <code>diamonds</code> dataset by
<code>cut</code>, calculating the average price for each cut quality.
Fill in the blanks to create a horizontal bar chart with direct labels.
Remember: <code>geom_col()</code> is for pre-computed values,
<code>geom_bar()</code> is for counting.</p>
<div class="template-code">
<p><strong>Template ‚Äì fill in the <code>___</code> blanks:</strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_price =</span> <span class="fu">mean</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cut =</span> <span class="fu">fct_reorder</span>(cut, ___)) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_price, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;___&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(avg_price, <span class="dv">0</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Average price by cut quality&quot;</span>,</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Average Price (USD)&quot;</span>,</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> ___) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
</div>
<p>After completing the template, answer: which cut has the highest
average price? Is this what you expected? Why or why not? (Hint: think
about the relationship between cut quality and carat size in the
diamonds dataset.)</p>
<p><strong>Exercise 3: Faceted Exploration</strong></p>
<p>Install the <code>palmerpenguins</code> package
(<code>install.packages("palmerpenguins")</code>) and create a faceted
scatterplot. Fill in the blanks below.</p>
<div class="template-code">
<p><strong>Template ‚Äì fill in the <code>___</code> blanks:</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;___&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;female&quot;</span> <span class="ot">=</span> <span class="st">&quot;#C41E3A&quot;</span>, <span class="st">&quot;male&quot;</span> <span class="ot">=</span> <span class="st">&quot;#002967&quot;</span>)) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>___, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Penguin Bill Dimensions by Species and Sex&quot;</span>,</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Bill Length (mm)&quot;</span>,</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div>
</div>
<p>Write 2‚Äì3 sentences interpreting what the faceted view reveals. How
do bill dimensions differ across species? Does the relationship between
bill length and bill depth change by species?</p>
<p><strong>Exercise 4: Theme Customization and patchwork</strong></p>
<p>Create two plots of the <code>mpg</code> dataset ‚Äì a scatterplot and
a boxplot ‚Äì and combine them side by side using <code>patchwork</code>.
Fill in the blanks below. Then write a custom
<code>theme_gonzaga()</code> function and apply it to both plots.</p>
<div class="template-code">
<p><strong>Template ‚Äì fill in the <code>___</code> blanks:</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co"># Define the custom theme</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>theme_gonzaga <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">base_size =</span> <span class="dv">13</span>) {</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> base_size) <span class="sc">%+replace%</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;___&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">size =</span> base_size <span class="sc">+</span> <span class="dv">3</span>),</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>),</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;___&quot;</span>),</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;___&quot;</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>    )</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>}</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a><span class="co"># Plot 1: scatterplot</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Engine Size vs. MPG&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Displacement (L)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>  <span class="fu">theme_gonzaga</span>()</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a><span class="co"># Plot 2: boxplot</span></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;#eff6ff&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;MPG by Drive Type&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Drive Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>  <span class="fu">theme_gonzaga</span>()</span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<p><strong>Exercise 5: Complete Visualization from Scratch</strong></p>
<p>Using any built-in dataset (<code>mpg</code>, <code>diamonds</code>,
<code>economics</code>, or <code>mtcars</code>), build a polished
visualization entirely from scratch ‚Äì no template. Your plot must
include at least five of the seven grammar of graphics layers:</p>
<ol style="list-style-type: decimal">
<li>Data</li>
<li>Aesthetics (at least two mapped variables)</li>
<li>Geometry (your choice)</li>
<li>Faceting OR a second geometry layer</li>
<li>Labels (title, subtitle, axis labels)</li>
<li>A customized scale (color, axis formatting, or both)</li>
<li>A customized theme (modify at least two <code>theme()</code>
elements)</li>
</ol>
<p>Save your final plot using <code>ggsave()</code> at 300 dpi, 8 inches
wide and 5 inches tall. In a few sentences below your code, explain what
story your visualization tells and which design choices you made to
support that story.</p>
</div>
</div>
<hr />
</div>
<div id="attributions" class="section level2">
<h2>Attributions</h2>
<p>This course material draws on and is inspired by the work of many
scholars and practitioners:</p>
<ul>
<li><strong>Wilkinson, L.</strong> ‚Äì <em>The Grammar of Graphics</em>
(Springer, 1999; 2nd ed.¬†2005). The foundational theoretical framework
for systematic visualization construction.</li>
<li><strong>Wickham, H.</strong> ‚Äì <em>ggplot2: Elegant Graphics for
Data Analysis</em> (Springer, 3rd ed.). The definitive guide to the R
implementation of the grammar of graphics.</li>
<li><strong>Wickham, H.</strong> (2010). ‚ÄúA Layered Grammar of
Graphics.‚Äù <em>Journal of Computational and Graphical Statistics</em>,
19(1), 3‚Äì28. The academic paper describing ggplot2‚Äôs design
philosophy.</li>
<li><strong>Tufte, E.R.</strong> ‚Äì <em>The Visual Display of
Quantitative Information</em> (Graphics Press, 1983, 2001). Foundational
design principles including the data-ink ratio and lie factor.</li>
<li><strong>Vivek H. Patil</strong> ‚Äì foundational course design and
materials for data visualization at Gonzaga University.</li>
</ul>
<div class="page-nav">
<p><a href="week02.html">‚Üê Week 2: Visual Perception</a>
<a href="week04.html">Week 4: Chart Types ‚Üí</a></p>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIldlZWsgMzogR3JhbW1hciBvZiBHcmFwaGljcyAmIGdncGxvdDIiDQpvdXRwdXQ6DQogIGh0bWxfZG9jdW1lbnQ6DQogICAgdG9jOiB0cnVlDQogICAgdG9jX2Zsb2F0OiB0cnVlDQotLS0NCg0KPGRpdiBjbGFzcz0iaGVyby1iYW5uZXIiPg0KPGRpdiBjbGFzcz0id2Vlay1iYWRnZSI+MzwvZGl2Pg0KPGgxPkdyYW1tYXIgb2YgR3JhcGhpY3MgJmFtcDsgZ2dwbG90MjwvaDE+DQo8cD5BIHN5c3RlbWF0aWMgZnJhbWV3b3JrIGZvciBjb25zdHJ1Y3RpbmcgdmlzdWFsaXphdGlvbnMgbGF5ZXIgYnkgbGF5ZXIgaW4gUjwvcD4NCjwvZGl2Pg0KDQo6Ojogey5vYmplY3RpdmVzfQ0KIyMgTGVhcm5pbmcgT2JqZWN0aXZlcw0KDQpCeSB0aGUgZW5kIG9mIHRoaXMgd2VlaywgeW91IHdpbGwgYmUgYWJsZSB0bzoNCg0KLSBFeHBsYWluIHRoZSBncmFtbWFyIG9mIGdyYXBoaWNzIGZyYW1ld29yayBhbmQgaXRzIHNldmVuIGNvbXBvbmVudHMNCi0gQnVpbGQgZ2dwbG90MiBncmFwaGljcyBsYXllciBieSBsYXllciBmcm9tIGRhdGEgdG8gZmluaXNoZWQgdmlzdWFsaXphdGlvbg0KLSBEaXN0aW5ndWlzaCBiZXR3ZWVuIGFlc3RoZXRpYyBtYXBwaW5ncyBpbnNpZGUgYW5kIG91dHNpZGUgYGFlcygpYA0KLSBVc2UgYSB2YXJpZXR5IG9mIGdlb21ldHJpZXMgKHBvaW50cywgbGluZXMsIGJhcnMsIGhpc3RvZ3JhbXMsIGJveHBsb3RzKQ0KLSBBcHBseSBmYWNldGluZyB0byBjcmVhdGUgc21hbGwgbXVsdGlwbGVzDQotIEN1c3RvbWl6ZSBzY2FsZXMsIGxhYmVscywgYW5kIHRoZW1lcyBmb3IgcHVibGljYXRpb24tcXVhbGl0eSBncmFwaGljcw0KLSBDb21iaW5lIG11bHRpcGxlIHBsb3RzIGludG8gYSBzaW5nbGUgZmlndXJlIHVzaW5nIHRoZSBgcGF0Y2h3b3JrYCBwYWNrYWdlDQotIFNhdmUgcGxvdHMgYXQgYXBwcm9wcmlhdGUgc2l6ZXMgYW5kIHJlc29sdXRpb25zIHdpdGggYGdnc2F2ZSgpYA0KOjo6DQoNCiMjIFRoZSBHcmFtbWFyIG9mIEdyYXBoaWNzDQoNCkluIDE5OTksIHN0YXRpc3RpY2lhbiAqKkxlbGFuZCBXaWxraW5zb24qKiBwdWJsaXNoZWQgKlRoZSBHcmFtbWFyIG9mIEdyYXBoaWNzKiwgYSBib29rIHRoYXQgd291bGQgZnVuZGFtZW50YWxseSBjaGFuZ2UgaG93IHdlIHRoaW5rIGFib3V0IGJ1aWxkaW5nIHZpc3VhbGl6YXRpb25zLiBXaWxraW5zb24ncyBjZW50cmFsIGluc2lnaHQgd2FzIHRoYXQgc3RhdGlzdGljYWwgZ3JhcGhpY3MgYXJlIG5vdCBhIGNvbGxlY3Rpb24gb2YgdW5yZWxhdGVkIGNoYXJ0IHR5cGVzIC0tIHNjYXR0ZXJwbG90cywgYmFyIGNoYXJ0cywgaGlzdG9ncmFtcywgYW5kIHNvIG9uIC0tIGJ1dCByYXRoZXIgdGhhdCBldmVyeSBncmFwaGljIGNhbiBiZSBkZXNjcmliZWQgYXMgYSBjb21iaW5hdGlvbiBvZiBhIGZldyB1bmRlcmx5aW5nIGNvbXBvbmVudHMsIGFzc2VtYmxlZCBhY2NvcmRpbmcgdG8gYSBzZXQgb2YgcnVsZXMuDQoNCkp1c3QgYXMgRW5nbGlzaCBncmFtbWFyIGdpdmVzIHVzIHJ1bGVzIGZvciBjb25zdHJ1Y3Rpbmcgc2VudGVuY2VzIGZyb20gbm91bnMsIHZlcmJzLCBhbmQgYWRqZWN0aXZlcywgdGhlIGdyYW1tYXIgb2YgZ3JhcGhpY3MgZ2l2ZXMgdXMgcnVsZXMgZm9yIGNvbnN0cnVjdGluZyB2aXN1YWxpemF0aW9ucyBmcm9tIGRhdGEsIGFlc3RoZXRpY3MsIGFuZCBnZW9tZXRyaWVzLiBBIHNlbnRlbmNlIGlzIG5vdCBqdXN0IGEgcmFuZG9tIGNvbGxlY3Rpb24gb2Ygd29yZHM7IGl0IGZvbGxvd3MgYSBzdHJ1Y3R1cmUuIEEgZ3JhcGhpYyBpcyBub3QganVzdCBhIHJhbmRvbSBjb2xsZWN0aW9uIG9mIG1hcmtzIG9uIGEgcGFnZTsgaXQgZm9sbG93cyBhIHN0cnVjdHVyZSB0b28uDQoNCkluIDIwMDUsICoqSGFkbGV5IFdpY2toYW0qKiB0cmFuc2xhdGVkIFdpbGtpbnNvbidzIHRoZW9yZXRpY2FsIGZyYW1ld29yayBpbnRvIGEgcHJhY3RpY2FsIFIgcGFja2FnZSBjYWxsZWQgKipnZ3Bsb3QyKiogKHRoZSAiZ2ciIHN0YW5kcyBmb3IgImdyYW1tYXIgb2YgZ3JhcGhpY3MiKS4gV2lja2hhbSdzIGltcGxlbWVudGF0aW9uLCBkZXNjcmliZWQgaW4gaGlzIDIwMTAgcGFwZXIgIkEgTGF5ZXJlZCBHcmFtbWFyIG9mIEdyYXBoaWNzLCIgb3JnYW5pemVzIGV2ZXJ5IHZpc3VhbGl6YXRpb24gaW50byBhIHNlcmllcyBvZiBsYXllcnMuIFRoaXMgaXMgdGhlIHN5c3RlbSB3ZSB3aWxsIHVzZSBmb3IgdGhlIHJlc3Qgb2YgdGhlIGNvdXJzZS4NCg0KOjo6IHsuY2FsbG91dC1pbmZvfQ0KKipUaGUgImdnIiBpbiBnZ3Bsb3QyKiogc3RhbmRzIGZvciAqR3JhbW1hciBvZiBHcmFwaGljcyouIFRoZSAiMiIgaW5kaWNhdGVzIHRoYXQgdGhpcyBpcyB0aGUgc2Vjb25kIGl0ZXJhdGlvbiBvZiBXaWNraGFtJ3MgcGFja2FnZS4gVGhlIGZpcnN0IHZlcnNpb24sIGBnZ3Bsb3RgLCB3YXMgbmV2ZXIgd2lkZWx5IHJlbGVhc2VkLiBXaGVuIHdlIHJlZmVyIHRvICJnZ3Bsb3QiIGluIGNvZGUsIHdlIG1lYW4gdGhlIGBnZ3Bsb3QoKWAgZnVuY3Rpb24gZnJvbSB0aGUgYGdncGxvdDJgIHBhY2thZ2UuDQo6OjoNCg0KIyMjIFRoZSBTZXZlbiBMYXllcnMNCg0KRXZlcnkgZ2dwbG90MiBncmFwaGljIGlzIGNvbnN0cnVjdGVkIGZyb20gdXAgdG8gc2V2ZW4gbGF5ZXJzLiBOb3QgZXZlcnkgcGxvdCB1c2VzIGFsbCBzZXZlbiwgYnV0IHVuZGVyc3RhbmRpbmcgZWFjaCBvbmUgZ2l2ZXMgeW91IGNvbXBsZXRlIGNvbnRyb2wgb3ZlciB5b3VyIHZpc3VhbGl6YXRpb25zOg0KDQp8IExheWVyIHwgRGVzY3JpcHRpb24gfCBFeGFtcGxlIHwNCnw6LS0tLS0tfDotLS0tLS0tLS0tLS18Oi0tLS0tLS0tfA0KfCAqKkRhdGEqKiB8IFRoZSBkYXRhc2V0IGJlaW5nIHZpc3VhbGl6ZWQgfCBgZ2dwbG90KG1wZywgLi4uKWAgfA0KfCAqKkFlc3RoZXRpY3MqKiB8IE1hcHBpbmdzIGZyb20gZGF0YSB2YXJpYWJsZXMgdG8gdmlzdWFsIHByb3BlcnRpZXMgfCBgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSwgY29sb3IgPSBjbGFzcylgIHwNCnwgKipHZW9tZXRyaWVzKiogfCBUaGUgdmlzdWFsIG1hcmtzIHRoYXQgcmVwcmVzZW50IGRhdGEgcG9pbnRzIHwgYGdlb21fcG9pbnQoKWAsIGBnZW9tX2xpbmUoKWAsIGBnZW9tX2NvbCgpYCB8DQp8ICoqRmFjZXRzKiogfCBTcGxpdHRpbmcgdGhlIHBsb3QgaW50byBwYW5lbHMgYnkgYSB2YXJpYWJsZSB8IGBmYWNldF93cmFwKH5jbGFzcylgIHwNCnwgKipTdGF0aXN0aWNzKiogfCBTdGF0aXN0aWNhbCB0cmFuc2Zvcm1hdGlvbnMgb2YgdGhlIGRhdGEgfCBgc3RhdF9zbW9vdGgoKWAsIGJpbm5pbmcsIGNvdW50aW5nIHwNCnwgKipDb29yZGluYXRlcyoqIHwgVGhlIGNvb3JkaW5hdGUgc3lzdGVtIHwgYGNvb3JkX2ZsaXAoKWAsIGBjb29yZF9wb2xhcigpYCB8DQp8ICoqVGhlbWVzKiogfCBOb24tZGF0YSB2aXN1YWwgYXBwZWFyYW5jZSB8IGB0aGVtZV9taW5pbWFsKClgLCBmb250IHNpemVzLCBncmlkIGxpbmVzIHwNCg0KVGhpbmsgb2YgaXQgdGhpcyB3YXk6IHRoZSAqKmRhdGEqKiBpcyB5b3VyIHJhdyBtYXRlcmlhbC4gKipBZXN0aGV0aWNzKiogYXJlIHRoZSBpbnN0cnVjdGlvbnMgZm9yIGhvdyB0byB0cmFuc2xhdGUgdGhhdCBtYXRlcmlhbCBpbnRvIHZpc3VhbCBmb3JtLiAqKkdlb21ldHJpZXMqKiBhcmUgdGhlIHNoYXBlcyB0aGF0IGFwcGVhciBvbiB0aGUgcGFnZS4gKipGYWNldHMqKiBsZXQgeW91IHJlcGVhdCB0aGUgc2FtZSBwbG90IGZvciBzdWJzZXRzIG9mIHRoZSBkYXRhLiAqKlN0YXRpc3RpY3MqKiB0cmFuc2Zvcm0geW91ciBkYXRhIGJlZm9yZSBpdCByZWFjaGVzIHRoZSBnZW9tZXRyeS4gKipDb29yZGluYXRlcyoqIGRlZmluZSB0aGUgc3BhY2UgaW4gd2hpY2ggZXZlcnl0aGluZyBpcyBkcmF3bi4gQW5kICoqdGhlbWVzKiogY29udHJvbCB0aGUgZmluYWwgYXBwZWFyYW5jZSBvZiBldmVyeXRoaW5nIHRoYXQgaXMgbm90IGRhdGEuDQoNCjo6OiB7LmNhbGxvdXQtaWduYXRpYW59DQoqKklnbmF0aWFuIFJlZmxlY3Rpb246IEludGVudGlvbmFsIERlc2lnbioqDQoNClRoZSBncmFtbWFyIG9mIGdyYXBoaWNzIGlzLCBhdCBpdHMgaGVhcnQsIGEgZGlzY2lwbGluZSBvZiBpbnRlbnRpb25hbGl0eS4gSXQgYXNrcyB5b3UgdG8gYmUgZGVsaWJlcmF0ZSBhYm91dCBldmVyeSBsYXllciAtLSB0byBjaG9vc2UgeW91ciBkYXRhIGNhcmVmdWxseSwgdG8gbWFwIHZhcmlhYmxlcyB0byBhZXN0aGV0aWNzIHB1cnBvc2VmdWxseSwgdG8gc2VsZWN0IGdlb21ldHJpZXMgdGhhdCByZXZlYWwgcmF0aGVyIHRoYW4gb2JzY3VyZS4gVGhpcyBtaXJyb3JzIHRoZSBJZ25hdGlhbiBwcmFjdGljZSBvZiBkaXNjZXJubWVudDogZXZlcnkgY2hvaWNlIHNob3VsZCBiZSBtYWRlIHdpdGggcmVmbGVjdGlvbiwgZXZlcnkgZWxlbWVudCBzaG91bGQgc2VydmUgdGhlIHRydXRoLiBXaGVuIHlvdSBidWlsZCBhIGdncGxvdCwgYXNrIHlvdXJzZWxmIGF0IGVhY2ggbGF5ZXI6ICpEb2VzIHRoaXMgc2VydmUgY2xhcml0eT8gRG9lcyB0aGlzIGhlbHAgdGhlIHZpZXdlciBzZWUgd2hhdCBpcyByZWFsPyoNCjo6Og0KDQotLS0NCg0KIyMgVHJ5IEl0OiBHcmFtbWFyIG9mIEdyYXBoaWNzIExheWVyIEJ1aWxkZXINCg0KWW91IGhhdmUganVzdCBsZWFybmVkIGhvdyBnZ3Bsb3QyIGJ1aWxkcyB2aXN1YWxpemF0aW9ucyBsYXllciBieSBsYXllci4gTm93IGNvbnN0cnVjdCB5b3VyIG93biBwbG90IGludGVyYWN0aXZlbHkuIFRoZSBzYW5kYm94IGJlbG93IGxldHMgeW91IHRvZ2dsZSBlYWNoIGxheWVyIG9uIGFuZCBvZmYgYW5kIHNlZSBob3cgdGhlIHBsb3QgY2hhbmdlcyDigJQgbm8gY29kaW5nIHJlcXVpcmVkLg0KDQo8ZGl2IGNsYXNzPSJzYW5kYm94LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ic2FuZGJveC1oZWFkZXIiPg0KPHNwYW4gY2xhc3M9InNhbmRib3gtaWNvbiI+8J+nqjwvc3Bhbj4gR3JhbW1hciBvZiBHcmFwaGljcyBMYXllciBCdWlsZGVyDQo8L2Rpdj4NCjxpZnJhbWUgY2xhc3M9InNhbmRib3gtZnJhbWUiIHNyYz0iaHR0cHM6Ly9hbmFseXRpY3MuZ29uemFnYS5lZHUvd2VlazAzLWxheWVycy8iDQogICAgICAgIGhlaWdodD0iNjAwIiBsb2FkaW5nPSJsYXp5IiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+DQo8ZGl2IGNsYXNzPSJzYW5kYm94LWNvbGQtc3RhcnQiPg0KSWYgdGhlIGFwcCB0YWtlcyBhIGZldyBzZWNvbmRzIHRvIGxvYWQgb24gZmlyc3QgdmlzaXQsIHRoYXQgaXMgbm9ybWFsIOKAlCB0aGUgc2VydmVyIGlzIHdha2luZyB1cC4NCjwvZGl2Pg0KPC9kaXY+DQoNCjo6OiB7LnRyeS1pdC1ib3h9DQoqKkV4cGxvcmF0aW9uIFRhc2tzOioqDQoNCjEuIFN0YXJ0IHdpdGggb25seSB0aGUgKipkYXRhKiogYW5kICoqZ2VvbV9wb2ludCoqIGxheWVycyBlbmFibGVkLiBXaGF0IGRvIHlvdSBzZWU/DQoyLiBBZGQgYSAqKnNtb290aCBsaW5lKiog4oCUIGhvdyBkb2VzIHRoZSBzdG9yeSBjaGFuZ2U/DQozLiBUb2dnbGUgb24gKipmYWNldGluZyoqIOKAlCB3aGF0IG5ldyBwYXR0ZXJucyBlbWVyZ2Ugd2hlbiB0aGUgZGF0YSBpcyBzcGxpdCBieSBncm91cD8NCjQuIEV4cGVyaW1lbnQgd2l0aCBkaWZmZXJlbnQgKip0aGVtZXMqKiDigJQgd2hpY2ggb25lIGRvIHlvdSBmaW5kIG1vc3QgcmVhZGFibGUgYW5kIHByb2Zlc3Npb25hbD8NCjo6Og0KDQo6Ojogey5jYWxsb3V0LWluZm99DQoqKldoYXQgWW91IFNob3VsZCBIYXZlIE5vdGljZWQ6KiogRWFjaCBsYXllciBhZGRzIGEgZGlzdGluY3QgcGllY2Ugb2YgaW5mb3JtYXRpb24gdG8gdGhlIHBsb3QuIFRoZSBiZWF1dHkgb2YgdGhlIEdyYW1tYXIgb2YgR3JhcGhpY3MgaXMgdGhhdCBsYXllcnMgYXJlIGluZGVwZW5kZW50IOKAlCB5b3UgY2FuIGFkZCwgcmVtb3ZlLCBvciBtb2RpZnkgYW55IGxheWVyIHdpdGhvdXQgYWZmZWN0aW5nIHRoZSBvdGhlcnMuIFRoaXMgbW9kdWxhciBhcHByb2FjaCBtYWtlcyBnZ3Bsb3QyIGluY3JlZGlibHkgZmxleGlibGUuDQo6OjoNCg0KOjo6IHsuY2FsbG91dC1haX0NCioqQUkgJiBUaGlzIENvbmNlcHQqKg0KV2hlbiBhc2tpbmcgQUkgdG8gYnVpbGQgYSBnZ3Bsb3QsIGRlc2NyaWJlIHRoZSBsYXllcnMgeW91IHdhbnQgZXhwbGljaXRseTogIkFkZCBhIHNjYXR0ZXIgbGF5ZXIsIHRoZW4gYSBzbW9vdGggbGluZSwgdGhlbiBmYWNldCBieSBjYXRlZ29yeS4iIEFJIHRvb2xzIHByb2R1Y2UgYmV0dGVyIHJlc3VsdHMgd2hlbiB5b3UgdXNlIHRoZSBncmFtbWFyIG9mIGdyYXBoaWNzIHZvY2FidWxhcnkg4oCUIGdlb20sIGFlc3RoZXRpYywgZmFjZXQsIHNjYWxlLCB0aGVtZSDigJQgcmF0aGVyIHRoYW4gdmFndWUgcmVxdWVzdHMgbGlrZSAibWFrZSBhIG5pY2UgY2hhcnQuIg0KOjo6DQoNCi0tLQ0KDQojIyBDb21tb24gZ2dwbG90MiBFcnJvcnMNCg0KQmVmb3JlIHdlIHN0YXJ0IHdyaXRpbmcgY29kZSwgbGV0IHVzIGFkZHJlc3MgdGhlIGVycm9ycyB5b3UgYXJlIG1vc3QgbGlrZWx5IHRvIGVuY291bnRlci4gSW4gYW4gYXN5bmNocm9ub3VzIGNvdXJzZSwgeW91IGNhbm5vdCByYWlzZSB5b3VyIGhhbmQgd2hlbiBzb21ldGhpbmcgZ29lcyB3cm9uZyAtLSBzbyBzdHVkeSB0aGlzIGJveCBjYXJlZnVsbHkgYW5kIGJvb2ttYXJrIGl0LiBOZWFybHkgZXZlcnkgc3R1ZGVudCBoaXRzIGF0IGxlYXN0IG9uZSBvZiB0aGVzZSBkdXJpbmcgdGhlaXIgZmlyc3Qgd2VlayB3aXRoIGdncGxvdDIuDQoNCjo6OiB7LmNhbGxvdXQtZXJyb3J9DQoqKlRyb3VibGVzaG9vdGluZyBnZ3Bsb3QyOiBUaGUgU2l4IE1vc3QgQ29tbW9uIEVycm9ycyoqDQoNCioqMS4gYEVycm9yOiB1bmV4cGVjdGVkICcrJ2AqKg0KDQpZb3Ugc3RhcnRlZCBhIG5ldyBsaW5lICpiZWZvcmUqIHRoZSBgK2AuIFRoZSBgK2AgbXVzdCBiZSBhdCB0aGUgKiplbmQqKiBvZiB0aGUgcHJldmlvdXMgbGluZSwgbm90IHRoZSBiZWdpbm5pbmcgb2YgdGhlIG5leHQuDQoNCmBgYA0KIyBXUk9ORyAtLSBSIHRoaW5rcyBsaW5lIDEgaXMgYSBjb21wbGV0ZSBjb21tYW5kDQpnZ3Bsb3QobXBnLCBhZXMoeCA9IGRpc3BsLCB5ID0gaHd5KSkNCiAgKyBnZW9tX3BvaW50KCkNCg0KIyBSSUdIVCAtLSB0aGUgKyB0ZWxscyBSICJ0aGVyZSBpcyBtb3JlIGNvbWluZyINCmdncGxvdChtcGcsIGFlcyh4ID0gZGlzcGwsIHkgPSBod3kpKSArDQogIGdlb21fcG9pbnQoKQ0KYGBgDQoNCioqMi4gYEVycm9yOiBvYmplY3QgJ2Rpc3BsJyBub3QgZm91bmRgKioNCg0KRGlkIHlvdSBmb3JnZXQgYGFlcygpYD8gQ29sdW1uIG5hbWVzIG11c3QgYmUgd3JhcHBlZCBpbnNpZGUgYGFlcygpYCBzbyB0aGF0IGdncGxvdDIga25vd3MgdG8gbG9vayBmb3IgdGhlbSBpbiB0aGUgZGF0YSBmcmFtZSwgbm90IGluIHlvdXIgZ2xvYmFsIGVudmlyb25tZW50Lg0KDQpgYGANCiMgV1JPTkcNCmdncGxvdChtcGcsIHggPSBkaXNwbCwgeSA9IGh3eSkgKyBnZW9tX3BvaW50KCkNCg0KIyBSSUdIVA0KZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSkpICsgZ2VvbV9wb2ludCgpDQpgYGANCg0KKiozLiBgRXJyb3I6IGNvdWxkIG5vdCBmaW5kIGZ1bmN0aW9uICJnZ3Bsb3QiYCoqDQoNCllvdSBmb3Jnb3QgdG8gbG9hZCB0aGUgcGFja2FnZS4gUnVuIGBsaWJyYXJ5KHRpZHl2ZXJzZSlgIChvciBgbGlicmFyeShnZ3Bsb3QyKWApIGF0IHRoZSB0b3Agb2YgeW91ciBzY3JpcHQgYmVmb3JlIGNhbGxpbmcgYW55IGdncGxvdCBmdW5jdGlvbnMuIFRoaXMgbXVzdCBiZSBkb25lIGV2ZXJ5IHRpbWUgeW91IHN0YXJ0IGEgbmV3IFIgc2Vzc2lvbi4NCg0KKio0LiBQbG90IGNvbG9ycyBhcmUgbm90IGNoYW5naW5nKioNCg0KQXJlIHlvdSBwdXR0aW5nIGBjb2xvciA9ICJibHVlImAgKmluc2lkZSogb3IgKm91dHNpZGUqIGBhZXMoKWA/IEluc2lkZSBgYWVzKClgIG1hcHMgYSB2YXJpYWJsZSB0byBjb2xvciAoZWFjaCB2YWx1ZSBnZXRzIGEgZGlmZmVyZW50IGNvbG9yKS4gT3V0c2lkZSBgYWVzKClgIHNldHMgYSBzaW5nbGUgZml4ZWQgY29sb3IgZm9yIGFsbCBwb2ludHMuDQoNCmBgYA0KIyBNYXBzIHRoZSB2YXJpYWJsZSBjbGFzcyB0byBjb2xvciAoYSBsZWdlbmQgYXBwZWFycykNCmdlb21fcG9pbnQoYWVzKGNvbG9yID0gY2xhc3MpKQ0KDQojIFNldHMgQUxMIHBvaW50cyB0byBibHVlIChubyBsZWdlbmQpDQpnZW9tX3BvaW50KGNvbG9yID0gImJsdWUiKQ0KDQojIENPTU1PTiBNSVNUQUtFIC0tIHB1dHMgYSBsaXRlcmFsIHN0cmluZyBpbnNpZGUgYWVzKCkNCiMgVGhpcyBjcmVhdGVzIGEgbGVnZW5kIHdpdGggb25lIGVudHJ5IGxhYmVsZWQgImJsdWUiDQpnZW9tX3BvaW50KGFlcyhjb2xvciA9ICJibHVlIikpDQpgYGANCg0KKio1LiBgRXJyb3I6IHN0YXRfY291bnQoKSBtdXN0IG5vdCBiZSB1c2VkIHdpdGggYSB5IGFlc3RoZXRpY2AqKg0KDQpZb3UgdXNlZCBgZ2VvbV9iYXIoKWAgYnV0IGFsc28gcHJvdmlkZWQgYSBgeWAgYWVzdGhldGljLiBgZ2VvbV9iYXIoKWAgY291bnRzIHJvd3MgZm9yIHlvdSAtLSBpdCBjcmVhdGVzIGl0cyBvd24geS4gSWYgeW91IGFscmVhZHkgaGF2ZSBwcmUtY29tcHV0ZWQgeSB2YWx1ZXMsIHVzZSBgZ2VvbV9jb2woKWAgaW5zdGVhZC4NCg0KYGBgDQojIFdST05HIC0tIGdlb21fYmFyKCkgdHJpZXMgdG8gY291bnQsIGJ1dCB5b3UgZ2F2ZSBpdCB5DQpnZ3Bsb3QoZGYsIGFlcyh4ID0gY2F0ZWdvcnksIHkgPSB2YWx1ZSkpICsgZ2VvbV9iYXIoKQ0KDQojIFJJR0hUIC0tIGdlb21fY29sKCkgdXNlcyB0aGUgeSB2YWx1ZXMgeW91IHByb3ZpZGUNCmdncGxvdChkZiwgYWVzKHggPSBjYXRlZ29yeSwgeSA9IHZhbHVlKSkgKyBnZW9tX2NvbCgpDQpgYGANCg0KKio2LiBgRXJyb3I6IGNhbm5vdCBvcGVuIHRoZSBjb25uZWN0aW9uYCB3aXRoIGBnZ3NhdmUoKWAqKg0KDQpUaGUgZmlsZSBwYXRoIHlvdSBzcGVjaWZpZWQgZG9lcyBub3QgZXhpc3QsIG9yIHlvdSBkbyBub3QgaGF2ZSB3cml0ZSBwZXJtaXNzaW9uLiBDaGVjayB0aGF0IHRoZSBmb2xkZXIgZXhpc3RzIGJlZm9yZSBzYXZpbmcuIFVzZSBgZGlyLmV4aXN0cygibXlfZm9sZGVyIilgIHRvIHZlcmlmeS4NCg0KYGBgDQojIENoZWNrIHRoZSBmb2xkZXIgZXhpc3RzIGZpcnN0DQpkaXIuZXhpc3RzKCJvdXRwdXQiKSAgIyByZXR1cm5zIFRSVUUgb3IgRkFMU0UNCg0KIyBTYXZlIHRvIGFuIGV4aXN0aW5nIGZvbGRlcg0KZ2dzYXZlKCJvdXRwdXQvbXlfcGxvdC5wbmciLCB3aWR0aCA9IDgsIGhlaWdodCA9IDUsIGRwaSA9IDMwMCkNCmBgYA0KOjo6DQoNCi0tLQ0KDQojIyBCdWlsZGluZyBhIFBsb3QgTGF5ZXIgYnkgTGF5ZXINCg0KVGhlIGJlc3Qgd2F5IHRvIHVuZGVyc3RhbmQgdGhlIGdyYW1tYXIgb2YgZ3JhcGhpY3MgaXMgdG8gYnVpbGQgYSBwbG90IG9uZSBsYXllciBhdCBhIHRpbWUuIFdlIHdpbGwgdXNlIHRoZSBgbXBnYCBkYXRhc2V0LCB3aGljaCBpcyBidWlsdCBpbnRvIGdncGxvdDIgYW5kIGNvbnRhaW5zIGZ1ZWwgZWNvbm9teSBkYXRhIGZvciAyMzQgY2Fycy4NCg0KYGBge3IgdzMtc2V0dXAsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQpsaWJyYXJ5KHRpZHl2ZXJzZSkNCmBgYA0KDQpMZXQgdXMgYmVnaW4gd2l0aCBub3RoaW5nIGJ1dCB0aGUgZGF0YSBhbmQgYW4gYWVzdGhldGljIG1hcHBpbmcsIGFuZCB0aGVuIGFkZCBsYXllcnMgb25lIGF0IGEgdGltZS4gRWFjaCBzdGVwIGJlbG93IGlzIGEgc2VwYXJhdGVseSBydW5uYWJsZSBjb2RlIGNodW5rIC0tIHJ1biB0aGVtIGluIG9yZGVyIGFuZCB3YXRjaCB0aGUgcGxvdCBldm9sdmUuDQoNCiMjIyBTdGVwIDE6IERhdGEgYW5kIEFlc3RoZXRpYyBNYXBwaW5nDQoNClRoaXMgY3JlYXRlcyBhbiBlbXB0eSBjYW52YXMuIGdncGxvdDIga25vd3Mgd2hhdCBkYXRhIHRvIHVzZSBhbmQgd2hpY2ggdmFyaWFibGVzIHRvIG1hcCB0byB0aGUgeCBhbmQgeSBheGVzLCBidXQgaXQgaGFzIG5vIGluc3RydWN0aW9ucyBmb3IgaG93IHRvIGRyYXcgYW55dGhpbmcgeWV0Lg0KDQpgYGB7ciB3My1sYXllci1zdGVwMSwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NX0NCmdncGxvdChtcGcsIGFlcyh4ID0gZGlzcGwsIHkgPSBod3kpKQ0KYGBgDQoNCiMjIyBTdGVwIDI6IEFkZCBhIEdlb21ldHJ5DQoNCk5vdyB3ZSBhZGQgYGdlb21fcG9pbnQoKWAsIGFuZCB0aGUgZGF0YSBhcHBlYXJzIGFzIGEgc2NhdHRlcnBsb3QuIFRoZSBnZW9tZXRyeSB0ZWxscyBnZ3Bsb3QyICpob3cqIHRvIHJlcHJlc2VudCBlYWNoIG9ic2VydmF0aW9uIC0tIGluIHRoaXMgY2FzZSwgYXMgYSBkb3QuDQoNCmBgYHtyIHczLWxheWVyLXN0ZXAyLCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD01fQ0KZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSkpICsNCiAgZ2VvbV9wb2ludCgpDQpgYGANCg0KIyMjIFN0ZXAgMzogTWFwIENvbG9yIHRvIGEgVmFyaWFibGUNCg0KQnkgYWRkaW5nIGBjb2xvciA9IGNsYXNzYCBpbnNpZGUgYGFlcygpYCwgZWFjaCB2ZWhpY2xlIGNsYXNzIGdldHMgYSBkaXN0aW5jdCBjb2xvci4gQSBsZWdlbmQgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQuDQoNCmBgYHtyIHczLWxheWVyLXN0ZXAzLCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD01fQ0KZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSwgY29sb3IgPSBjbGFzcykpICsNCiAgZ2VvbV9wb2ludCgpDQpgYGANCg0KIyMjIFN0ZXAgNDogQWRkIGEgU3RhdGlzdGljYWwgTGF5ZXINCg0KQSBsaW5lYXIgc21vb3RoZXIgZm9yIGVhY2ggY2xhc3MgcmV2ZWFscyB0aGUgZ3JvdXAtbGV2ZWwgdHJlbmRzLiBUaGUgYHNlID0gRkFMU0VgIGFyZ3VtZW50IHN1cHByZXNzZXMgdGhlIGNvbmZpZGVuY2UgaW50ZXJ2YWwgc2hhZGluZyB0byBrZWVwIHRoZSBwbG90IGNsZWFuLg0KDQpgYGB7ciB3My1sYXllci1zdGVwNCwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCmdncGxvdChtcGcsIGFlcyh4ID0gZGlzcGwsIHkgPSBod3ksIGNvbG9yID0gY2xhc3MpKSArDQogIGdlb21fcG9pbnQoKSArDQogIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRkFMU0UpDQpgYGANCg0KIyMjIFN0ZXAgNTogQWRkIExhYmVscw0KDQpHb29kIGxhYmVscyB0ZWxsIHRoZSByZWFkZXIgd2hhdCB0aGV5IGFyZSBsb29raW5nIGF0LiBUaGUgYGxhYnMoKWAgZnVuY3Rpb24gc2V0cyB0aGUgdGl0bGUsIHN1YnRpdGxlLCBheGlzIGxhYmVscywgYW5kIGxlZ2VuZCB0aXRsZSBhbGwgaW4gb25lIGNhbGwuDQoNCmBgYHtyIHczLWxheWVyLXN0ZXA1LCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD01LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSwgY29sb3IgPSBjbGFzcykpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgc2UgPSBGQUxTRSkgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIkVuZ2luZSBTaXplIHZzLiBIaWdod2F5IEZ1ZWwgRWNvbm9teSIsDQogICAgc3VidGl0bGUgPSAiTGFyZ2VyIGVuZ2luZXMgdGVuZCB0byBoYXZlIGxvd2VyIGZ1ZWwgZWNvbm9teSIsDQogICAgeCA9ICJFbmdpbmUgRGlzcGxhY2VtZW50IChMKSIsDQogICAgeSA9ICJIaWdod2F5IE1QRyIsDQogICAgY29sb3IgPSAiVmVoaWNsZSBDbGFzcyINCiAgKQ0KYGBgDQoNCiMjIyBTdGVwIDY6IEFwcGx5IGEgVGhlbWUNCg0KRmluYWxseSwgd2UgcmVwbGFjZSB0aGUgZGVmYXVsdCBncmF5IGJhY2tncm91bmQgd2l0aCBhIGNsZWFuZXIgYHRoZW1lX21pbmltYWwoKWAuIFRoZSBgYmFzZV9zaXplYCBhcmd1bWVudCBjb250cm9scyB0aGUgb3ZlcmFsbCBmb250IHNpemUuDQoNCmBgYHtyIHczLWxheWVyLXN0ZXA2LCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD01LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSwgY29sb3IgPSBjbGFzcykpICsNCiAgZ2VvbV9wb2ludCgpICsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxtIiwgc2UgPSBGQUxTRSkgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIkVuZ2luZSBTaXplIHZzLiBIaWdod2F5IEZ1ZWwgRWNvbm9teSIsDQogICAgc3VidGl0bGUgPSAiTGFyZ2VyIGVuZ2luZXMgdGVuZCB0byBoYXZlIGxvd2VyIGZ1ZWwgZWNvbm9teSIsDQogICAgeCA9ICJFbmdpbmUgRGlzcGxhY2VtZW50IChMKSIsDQogICAgeSA9ICJIaWdod2F5IE1QRyIsDQogICAgY29sb3IgPSAiVmVoaWNsZSBDbGFzcyINCiAgKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTQpDQpgYGANCg0KTm90aWNlIGhvdyBlYWNoIGxheWVyIGFkZHMgc29tZXRoaW5nIHNwZWNpZmljLiBUaGUgcGxvdCBldm9sdmVzIGZyb20gYW4gZW1wdHkgY29vcmRpbmF0ZSBzeXN0ZW0gdG8gYSByaWNoLCBpbmZvcm1hdGl2ZSBncmFwaGljLiBUaGlzIGlzIHRoZSBwb3dlciBvZiB0aGUgbGF5ZXJlZCBncmFtbWFyOiB5b3UgY2FuIHRoaW5rIGFib3V0IG9uZSB0aGluZyBhdCBhIHRpbWUuDQoNCiMjIyBUaGUgRmx1ZW50IFBpcGVsaW5lIFN0eWxlDQoNCkhlcmUgaXMgdGhlIHNhbWUgZmluYWwgcGxvdCB3cml0dGVuIGFzIGEgc2luZ2xlLCBmbHVlbnQgcGlwZWxpbmUgLS0gdGhlIHN0eWxlIHlvdSB3aWxsIHR5cGljYWxseSB1c2UgaW4gcHJhY3RpY2U6DQoNCmBgYHtyIHczLXNpbmdsZS1waXBlbGluZSwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCmdncGxvdChtcGcsIGFlcyh4ID0gZGlzcGwsIHkgPSBod3ksIGNvbG9yID0gY2xhc3MpKSArDQogIGdlb21fcG9pbnQoc2l6ZSA9IDIsIGFscGhhID0gMC43KSArDQogIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRkFMU0UsIGxpbmV3aWR0aCA9IDAuOCkgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIkVuZ2luZSBTaXplIHZzLiBIaWdod2F5IEZ1ZWwgRWNvbm9teSIsDQogICAgc3VidGl0bGUgPSAiTGFyZ2VyIGVuZ2luZXMgdGVuZCB0byBoYXZlIGxvd2VyIGZ1ZWwgZWNvbm9teSIsDQogICAgeCA9ICJFbmdpbmUgRGlzcGxhY2VtZW50IChMKSIsDQogICAgeSA9ICJIaWdod2F5IE1QRyIsDQogICAgY29sb3IgPSAiVmVoaWNsZSBDbGFzcyINCiAgKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTQpDQpgYGANCg0KOjo6IHsuY2FsbG91dC10aXB9DQoqKlRpcDoqKiBUaGUgYCtgIG9wZXJhdG9yIGluIGdncGxvdDIgaXMgaG93IHlvdSBhZGQgbGF5ZXJzLiBJdCBpcyBjb25jZXB0dWFsbHkgc2ltaWxhciB0byB0aGUgYCU+JWAgcGlwZSwgYnV0IGdncGxvdDIgd2FzIGNyZWF0ZWQgYmVmb3JlIHRoZSBwaXBlIGJlY2FtZSBzdGFuZGFyZCBpbiBSLCBzbyBpdCB1c2VzIGArYCBpbnN0ZWFkLiBBIGNvbW1vbiBtaXN0YWtlIGlzIHRvIHVzZSBgJT4lYCBpbnNpZGUgYSBnZ3Bsb3QgY2hhaW4gLS0gdGhpcyB3aWxsIHByb2R1Y2UgYW4gZXJyb3IuIFVzZSBgJT4lYCB0byBwaXBlICpkYXRhIGludG8qIGBnZ3Bsb3QoKWAsIHRoZW4gc3dpdGNoIHRvIGArYCBmb3IgYWRkaW5nIGxheWVycy4NCjo6Og0KDQotLS0NCg0KIyMgQWVzdGhldGljIE1hcHBpbmdzIC0tIGBhZXMoKWANCg0KQWVzdGhldGljcyBhcmUgdGhlIGJyaWRnZSBiZXR3ZWVuIHlvdXIgZGF0YSBhbmQgdGhlIHZpc3VhbCBwcm9wZXJ0aWVzIG9mIHlvdXIgcGxvdC4gVGhlIGBhZXMoKWAgZnVuY3Rpb24gbWFwcyB2YXJpYWJsZXMgaW4geW91ciBkYXRhIHRvIHZpc3VhbCBjaGFubmVscyBzdWNoIGFzIHBvc2l0aW9uICh4LCB5KSwgY29sb3IsIHNpemUsIHNoYXBlLCBhbmQgdHJhbnNwYXJlbmN5IChhbHBoYSkuDQoNClRoZSBjcml0aWNhbCBkaXN0aW5jdGlvbiB0byB1bmRlcnN0YW5kIGlzOg0KDQotICoqSW5zaWRlIGBhZXMoKWAqKjogVGhlIHZpc3VhbCBwcm9wZXJ0eSB2YXJpZXMgd2l0aCB0aGUgZGF0YS4gRWFjaCBkYXRhIHZhbHVlIGdldHMgYSBkaWZmZXJlbnQgY29sb3IsIHNpemUsIG9yIHBvc2l0aW9uLg0KLSAqKk91dHNpZGUgYGFlcygpYCoqOiBUaGUgdmlzdWFsIHByb3BlcnR5IGlzIGZpeGVkIGZvciBhbGwgb2JzZXJ2YXRpb25zLiBFdmVyeSBwb2ludCBnZXRzIHRoZSBzYW1lIGNvbG9yLCBzaXplLCBvciBzaGFwZS4NCg0KVGhpcyBpcyBvbmUgb2YgdGhlIG1vc3QgY29tbW9uIHNvdXJjZXMgb2YgY29uZnVzaW9uIGZvciBiZWdpbm5lcnMsIHNvIGxldCB1cyBzZWUgdGhlIGRpZmZlcmVuY2Ugc2lkZSBieSBzaWRlOg0KDQpgYGB7ciB3My1hZXMtaW5zaWRlLW91dHNpZGUsIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD00LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KbGlicmFyeShwYXRjaHdvcmspDQoNCiMgQ29sb3IgTUFQUEVEIHRvIGEgZGF0YSB2YXJpYWJsZSAoaW5zaWRlIGFlcykNCnAxIDwtIGdncGxvdChtcGcsIGFlcyh4ID0gZGlzcGwsIHkgPSBod3kpKSArDQogIGdlb21fcG9pbnQoYWVzKGNvbG9yID0gY2xhc3MpLCBzaXplID0gMiwgYWxwaGEgPSAwLjgpICsNCiAgbGFicyh0aXRsZSA9ICJDb2xvciBtYXBwZWQgdG8gZGF0YSAoaW5zaWRlIGFlcykiKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTIpDQoNCiMgQ29sb3IgU0VUIHRvIGEgZml4ZWQgdmFsdWUgKG91dHNpZGUgYWVzKQ0KcDIgPC0gZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSkpICsNCiAgZ2VvbV9wb2ludChjb2xvciA9ICIjQzQxRTNBIiwgc2l6ZSA9IDIsIGFscGhhID0gMC44KSArDQogIGxhYnModGl0bGUgPSAiQ29sb3IgZml4ZWQgKG91dHNpZGUgYWVzKSIpICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMikNCg0KcDEgKyBwMg0KYGBgDQoNCkluIHRoZSBsZWZ0IHBhbmVsLCBlYWNoIHZlaGljbGUgY2xhc3MgZ2V0cyBpdHMgb3duIGNvbG9yLCBhbmQgYSBsZWdlbmQgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQuIEluIHRoZSByaWdodCBwYW5lbCwgZXZlcnkgcG9pbnQgaXMgR29uemFnYSByZWQgcmVnYXJkbGVzcyBvZiBpdHMgY2xhc3MsIGFuZCB0aGVyZSBpcyBubyBsZWdlbmQgYmVjYXVzZSBjb2xvciBpcyBub3QgZW5jb2RpbmcgYW55IGluZm9ybWF0aW9uLg0KDQpIZXJlIGlzIGEgc3VtbWFyeSBvZiBjb21tb24gYWVzdGhldGljIG1hcHBpbmdzOg0KDQp8IEFlc3RoZXRpYyB8IERlc2NyaXB0aW9uIHwgRXhhbXBsZSB8DQp8Oi0tLS0tLS0tLS18Oi0tLS0tLS0tLS0tLXw6LS0tLS0tLS18DQp8IGB4YCwgYHlgIHwgUG9zaXRpb24gb24gdGhlIGF4ZXMgfCBgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSlgIHwNCnwgYGNvbG9yYCB8IE91dGxpbmUgY29sb3IgKHBvaW50cywgbGluZXMpIG9yIGZpbGwgY29sb3IgKHRleHQpIHwgYGFlcyhjb2xvciA9IGNsYXNzKWAgfA0KfCBgZmlsbGAgfCBJbnRlcmlvciBmaWxsIGNvbG9yIChiYXJzLCBib3hlcywgYXJlYXMpIHwgYGFlcyhmaWxsID0gY2xhc3MpYCB8DQp8IGBzaXplYCB8IFNpemUgb2YgcG9pbnRzIG9yIHdpZHRoIG9mIGxpbmVzIHwgYGFlcyhzaXplID0gY3lsKWAgfA0KfCBgc2hhcGVgIHwgU2hhcGUgb2YgcG9pbnRzIChjaXJjbGUsIHRyaWFuZ2xlLCBzcXVhcmUsIGV0Yy4pIHwgYGFlcyhzaGFwZSA9IGRydilgIHwNCnwgYGFscGhhYCB8IFRyYW5zcGFyZW5jeSAoMCA9IGludmlzaWJsZSwgMSA9IG9wYXF1ZSkgfCBgYWVzKGFscGhhID0geWVhcilgIHwNCnwgYGxpbmV0eXBlYCB8IFR5cGUgb2YgbGluZSAoc29saWQsIGRhc2hlZCwgZG90dGVkKSB8IGBhZXMobGluZXR5cGUgPSBkcnYpYCB8DQoNCiMjIFRyeSBJdDogQWVzdGhldGljIE1hcHBpbmcgU2FuZGJveA0KDQpZb3UgaGF2ZSBqdXN0IGxlYXJuZWQgaG93IGBhZXMoKWAgbWFwcyBkYXRhIHZhcmlhYmxlcyB0byB2aXN1YWwgcHJvcGVydGllcy4gTm93IGV4cGVyaW1lbnQgaW50ZXJhY3RpdmVseSDigJQgcGljayB3aGljaCB2YXJpYWJsZXMgbWFwIHRvIGNvbG9yLCBzaXplLCBhbmQgc2hhcGUsIGFuZCB3YXRjaCBib3RoIHRoZSBwbG90IGFuZCB0aGUgZ2VuZXJhdGVkIFIgY29kZSB1cGRhdGUgaW4gcmVhbCB0aW1lLg0KDQo8ZGl2IGNsYXNzPSJzYW5kYm94LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ic2FuZGJveC1oZWFkZXIiPg0KPHNwYW4gY2xhc3M9InNhbmRib3gtaWNvbiI+JiN4MUY5RUE7PC9zcGFuPiBBZXN0aGV0aWMgTWFwcGluZyBTYW5kYm94DQo8L2Rpdj4NCjxpZnJhbWUgY2xhc3M9InNhbmRib3gtZnJhbWUiIHNyYz0iaHR0cHM6Ly9hbmFseXRpY3MuZ29uemFnYS5lZHUvd2VlazAzLWFlc3RoZXRpY21hcHBpbmcvIg0KICAgICAgICBoZWlnaHQ9IjYwMCIgbG9hZGluZz0ibGF6eSIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPg0KPGRpdiBjbGFzcz0ic2FuZGJveC1jb2xkLXN0YXJ0Ij4NCklmIHRoZSBhcHAgdGFrZXMgYSBmZXcgc2Vjb25kcyB0byBsb2FkIG9uIGZpcnN0IHZpc2l0LCB0aGF0IGlzIG5vcm1hbCDigJQgdGhlIHNlcnZlciBpcyB3YWtpbmcgdXAuDQo8L2Rpdj4NCjwvZGl2Pg0KDQo6Ojogey50cnktaXQtYm94fQ0KKipFeHBsb3JhdGlvbiBUYXNrczoqKg0KDQoxLiBTdGFydCB3aXRoIGp1c3QgWCBhbmQgWSAodGhlIGRlZmF1bHRzKS4gQWxsIHBvaW50cyBhcmUgbmF2eSDigJQgY29sb3IgY2FycmllcyBubyBpbmZvcm1hdGlvbi4NCjIuIFNldCAqKkNvbG9yKiogdG8gYGNsYXNzYCDigJQgaG93IG1hbnkgdmVoaWNsZSBjbGFzc2VzIGNhbiB5b3UgZGlzdGluZ3Vpc2ggYXQgYSBnbGFuY2U/DQozLiBOb3cgYWxzbyBzZXQgKipTaXplKiogdG8gYGN0eWAg4oCUIGRvZXMgYWRkaW5nIGEgdGhpcmQgY2hhbm5lbCBoZWxwIG9yIGh1cnQgcmVhZGFiaWxpdHk/DQo0LiBUdXJuIG9uIGFsbCB0aHJlZSBvcHRpb25hbCBhZXN0aGV0aWNzLiBSZWFkIHRoZSBvdmVybG9hZCB3YXJuaW5nIOKAlCBkbyB5b3UgYWdyZWU/DQo6OjoNCg0KOjo6IHsuY2FsbG91dC1pbmZvfQ0KKipXaGF0IFlvdSBTaG91bGQgSGF2ZSBOb3RpY2VkOioqIEVhY2ggYWVzdGhldGljIGNoYW5uZWwgY2FuIGVuY29kZSBvbmUgdmFyaWFibGUuIE1hcHBpbmcgdG9vIG1hbnkgdmFyaWFibGVzIGF0IG9uY2UgY3JlYXRlcyBjb2duaXRpdmUgb3ZlcmxvYWQg4oCUIHRoZSB2aWV3ZXIgY2Fubm90IHRyYWNrIG1vcmUgdGhhbiAzLTQgY2hhbm5lbHMgc2ltdWx0YW5lb3VzbHkuIFRoZSBnZW5lcmF0ZWQgY29kZSBwYW5lbCBzaG93cyB5b3UgZXhhY3RseSB3aGF0IGBhZXMoKWAgY2FsbCBwcm9kdWNlcyBlYWNoIHBsb3QsIHJlaW5mb3JjaW5nIHRoZSBjb25uZWN0aW9uIGJldHdlZW4gY29kZSBhbmQgdmlzdWFsIG91dHB1dC4NCjo6Og0KDQo6Ojogey5jYWxsb3V0LWFpfQ0KKipBSSAmIFRoaXMgQ29uY2VwdCoqDQpXaGVuIHByb21wdGluZyBBSSB0byBidWlsZCBhIGdncGxvdCwgc3BlY2lmeSB5b3VyIGFlc3RoZXRpYyBtYXBwaW5ncyBleHBsaWNpdGx5OiAiTWFwIGBjbGFzc2AgdG8gY29sb3IgYW5kIGBjdHlgIHRvIHNpemUgaW5zaWRlIGBhZXMoKWAuIiBBSSB0b29scyBvZnRlbiBkZWZhdWx0IHRvIGZpeGVkIGNvbG9ycyB3aGVuIHlvdSBzYXkgIm1ha2UgaXQgY29sb3JmdWwiIGluc3RlYWQgb2YgbWFwcGluZyBhIGRhdGEgdmFyaWFibGUuIFVzaW5nIHRoZSB2b2NhYnVsYXJ5IOKAlCBgYWVzKClgLCBtYXBwZWQgdnMuIGZpeGVkLCBhZXN0aGV0aWMgY2hhbm5lbCDigJQgZ2V0cyBiZXR0ZXIgcmVzdWx0cy4NCjo6Og0KDQotLS0NCg0KIyMgR2VvbWV0cmllcyB7LnRhYnNldH0NCg0KR2VvbWV0cmllcyAtLSBvciAqKmdlb21zKiogLS0gYXJlIHRoZSB2aXN1YWwgbWFya3MgdGhhdCByZXByZXNlbnQgeW91ciBkYXRhLiBDaG9vc2luZyB0aGUgcmlnaHQgZ2VvbSBpcyBvbmUgb2YgdGhlIG1vc3QgaW1wb3J0YW50IGRlY2lzaW9ucyB5b3UgbWFrZSB3aGVuIGJ1aWxkaW5nIGEgdmlzdWFsaXphdGlvbi4gRWFjaCBnZW9tIGlzIHN1aXRlZCB0byBkaWZmZXJlbnQgdHlwZXMgb2YgZGF0YSBhbmQgZGlmZmVyZW50IGFuYWx5dGljYWwgcXVlc3Rpb25zLg0KDQojIyMgUG9pbnRzIChnZW9tX3BvaW50KQ0KDQpTY2F0dGVycGxvdHMgYXJlIHRoZSB3b3JraG9yc2Ugb2YgZXhwbG9yYXRvcnkgZGF0YSBhbmFseXNpcy4gVXNlIGBnZW9tX3BvaW50KClgIHdoZW4geW91IHdhbnQgdG8gc2hvdyB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gdHdvIGNvbnRpbnVvdXMgdmFyaWFibGVzLg0KDQpgYGB7ciB3My1nZW9tLXBvaW50LCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD01fQ0KZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSwgY29sb3IgPSBkcnYpKSArDQogIGdlb21fcG9pbnQoc2l6ZSA9IDIsIGFscGhhID0gMC43KSArDQogIHNjYWxlX2NvbG9yX21hbnVhbCgNCiAgICB2YWx1ZXMgPSBjKCI0IiA9ICIjMDAyOTY3IiwgImYiID0gIiNDNDFFM0EiLCAiciIgPSAiI0I0OTc1QSIpLA0KICAgIGxhYmVscyA9IGMoIjQiID0gIjQtd2hlZWwiLCAiZiIgPSAiRnJvbnQiLCAiciIgPSAiUmVhciIpDQogICkgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIlNjYXR0ZXJwbG90IHdpdGggZ2VvbV9wb2ludCgpIiwNCiAgICBzdWJ0aXRsZSA9ICJFbmdpbmUgZGlzcGxhY2VtZW50IHZzLiBoaWdod2F5IE1QRyBieSBkcml2ZSB0eXBlIiwNCiAgICB4ID0gIkVuZ2luZSBEaXNwbGFjZW1lbnQgKEwpIiwNCiAgICB5ID0gIkhpZ2h3YXkgTVBHIiwNCiAgICBjb2xvciA9ICJEcml2ZSBUeXBlIg0KICApICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMykNCmBgYA0KDQojIyMgTGluZXMgKGdlb21fbGluZSkNCg0KTGluZSBjaGFydHMgYXJlIGlkZWFsIGZvciBzaG93aW5nIHRyZW5kcyBvdmVyIHRpbWUuIFVzZSBgZ2VvbV9saW5lKClgIHdoZW4geW91IGhhdmUgYSBjb250aW51b3VzIHgtYXhpcyAob2Z0ZW4gYSBkYXRlIG9yIHRpbWUpIGFuZCB3YW50IHRvIGVtcGhhc2l6ZSB0aGUgZmxvdyBvZiB2YWx1ZXMuDQoNCmBgYHtyIHczLWdlb20tbGluZSwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NX0NCmVjb25vbWljcyAlPiUNCiAgZ2dwbG90KGFlcyh4ID0gZGF0ZSwgeSA9IHVuZW1wbG95IC8gMTAwMCkpICsNCiAgZ2VvbV9saW5lKGNvbG9yID0gIiMwMDI5NjciLCBsaW5ld2lkdGggPSAwLjgpICsNCiAgbGFicygNCiAgICB0aXRsZSA9ICJVLlMuIFVuZW1wbG95bWVudCBPdmVyIFRpbWUiLA0KICAgIHN1YnRpdGxlID0gIk1vbnRobHkgdW5lbXBsb3ltZW50IGZpZ3VyZXMgZnJvbSAxOTY3IHRvIDIwMTUiLA0KICAgIHkgPSAiVW5lbXBsb3llZCAobWlsbGlvbnMpIiwNCiAgICB4ID0gTlVMTA0KICApICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMykNCmBgYA0KDQojIyMgQmFycyAoZ2VvbV9jb2wgLyBnZW9tX2JhcikNCg0KQmFyIGNoYXJ0cyBhcmUgZXhjZWxsZW50IGZvciBjb21wYXJpbmcgcXVhbnRpdGllcyBhY3Jvc3MgY2F0ZWdvcmllcy4gVXNlIGBnZW9tX2NvbCgpYCB3aGVuIHlvdXIgZGF0YSBhbHJlYWR5IGNvbnRhaW5zIHRoZSB2YWx1ZXMgeW91IHdhbnQgdG8gcGxvdDsgdXNlIGBnZW9tX2JhcigpYCB3aGVuIHlvdSB3YW50IGdncGxvdDIgdG8gY291bnQgb2JzZXJ2YXRpb25zIGZvciB5b3UuDQoNCmBgYHtyIHczLWdlb20tY29sLCBmaWcud2lkdGg9OCwgZmlnLmhlaWdodD01fQ0KbXBnICU+JQ0KICBjb3VudChjbGFzcykgJT4lDQogIG11dGF0ZShjbGFzcyA9IGZjdF9yZW9yZGVyKGNsYXNzLCBuKSkgJT4lDQogIGdncGxvdChhZXMoeCA9IG4sIHkgPSBjbGFzcykpICsNCiAgZ2VvbV9jb2woZmlsbCA9ICIjMDAyOTY3IikgKw0KICBnZW9tX3RleHQoYWVzKGxhYmVsID0gbiksIGhqdXN0ID0gLTAuMywgc2l6ZSA9IDQsIGNvbG9yID0gIiMwMDI5NjciKSArDQogIGxhYnMoDQogICAgdGl0bGUgPSAiVmVoaWNsZSBDb3VudCBieSBDbGFzcyIsDQogICAgc3VidGl0bGUgPSAiTnVtYmVyIG9mIHZlaGljbGVzIGluIHRoZSBtcGcgZGF0YXNldCBieSBjbGFzcyIsDQogICAgeCA9ICJDb3VudCIsDQogICAgeSA9IE5VTEwNCiAgKSArDQogIGV4cGFuZF9saW1pdHMoeCA9IDcwKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTMpDQpgYGANCg0KIyMjIEhpc3RvZ3JhbSAoZ2VvbV9oaXN0b2dyYW0pDQoNCkhpc3RvZ3JhbXMgc2hvdyB0aGUgZGlzdHJpYnV0aW9uIG9mIGEgc2luZ2xlIGNvbnRpbnVvdXMgdmFyaWFibGUgYnkgZGl2aWRpbmcgaXQgaW50byBiaW5zIGFuZCBjb3VudGluZyB0aGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBpbiBlYWNoIGJpbi4NCg0KYGBge3IgdzMtZ2VvbS1oaXN0b2dyYW0sIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTUsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQpnZ3Bsb3QobXBnLCBhZXMoeCA9IGh3eSkpICsNCiAgZ2VvbV9oaXN0b2dyYW0oYmlud2lkdGggPSAyLCBmaWxsID0gIiMwMDI5NjciLCBjb2xvciA9ICJ3aGl0ZSIpICsNCiAgbGFicygNCiAgICB0aXRsZSA9ICJEaXN0cmlidXRpb24gb2YgSGlnaHdheSBNUEciLA0KICAgIHN1YnRpdGxlID0gIkJpbndpZHRoID0gMiBNUEciLA0KICAgIHggPSAiSGlnaHdheSBNUEciLA0KICAgIHkgPSAiQ291bnQiDQogICkgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDEzKQ0KYGBgDQoNCiMjIyBCb3hwbG90IChnZW9tX2JveHBsb3QpDQoNCkJveHBsb3RzIHN1bW1hcml6ZSB0aGUgZGlzdHJpYnV0aW9uIG9mIGEgY29udGludW91cyB2YXJpYWJsZSBhY3Jvc3MgZ3JvdXBzLiBUaGV5IHNob3cgdGhlIG1lZGlhbiwgaW50ZXJxdWFydGlsZSByYW5nZSwgYW5kIG91dGxpZXJzIGF0IGEgZ2xhbmNlLg0KDQpgYGB7ciB3My1nZW9tLWJveHBsb3QsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTV9DQpnZ3Bsb3QobXBnLCBhZXMoeCA9IGZjdF9yZW9yZGVyKGNsYXNzLCBod3ksIC5mdW4gPSBtZWRpYW4pLCB5ID0gaHd5KSkgKw0KICBnZW9tX2JveHBsb3QoZmlsbCA9ICIjZWZmNmZmIiwgY29sb3IgPSAiIzAwMjk2NyIsIG91dGxpZXIuY29sb3IgPSAiI0M0MUUzQSIpICsNCiAgY29vcmRfZmxpcCgpICsNCiAgbGFicygNCiAgICB0aXRsZSA9ICJIaWdod2F5IE1QRyBieSBWZWhpY2xlIENsYXNzIiwNCiAgICBzdWJ0aXRsZSA9ICJDbGFzc2VzIG9yZGVyZWQgYnkgbWVkaWFuIGhpZ2h3YXkgTVBHIiwNCiAgICB4ID0gTlVMTCwNCiAgICB5ID0gIkhpZ2h3YXkgTVBHIg0KICApICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMykNCmBgYA0KDQojIyB7LX0NCg0KOjo6IHsuY2FsbG91dC10aXB9DQoqKkNob29zaW5nIHRoZSBSaWdodCBHZW9tOioqIFRoZSBjaG9pY2Ugb2YgZ2VvbWV0cnkgZGVwZW5kcyBvbiB0aGUgdHlwZXMgb2YgdmFyaWFibGVzIHlvdSBoYXZlIGFuZCB0aGUgcXVlc3Rpb24geW91IGFyZSBhc2tpbmcuIFR3byBjb250aW51b3VzIHZhcmlhYmxlcz8gU3RhcnQgd2l0aCBgZ2VvbV9wb2ludCgpYC4gT25lIGNvbnRpbnVvdXMgdmFyaWFibGU/IFRyeSBgZ2VvbV9oaXN0b2dyYW0oKWAgb3IgYGdlb21fZGVuc2l0eSgpYC4gT25lIGNhdGVnb3JpY2FsIGFuZCBvbmUgY29udGludW91cz8gQ29uc2lkZXIgYGdlb21fYm94cGxvdCgpYCBvciBgZ2VvbV9jb2woKWAuIEEgdHJlbmQgb3ZlciB0aW1lPyBVc2UgYGdlb21fbGluZSgpYC4gV2hlbiBpbiBkb3VidCwgdHJ5IHNldmVyYWwgYW5kIHNlZSB3aGljaCBvbmUgcmV2ZWFscyB0aGUgbW9zdCBhYm91dCB5b3VyIGRhdGEuDQo6OjoNCg0KLS0tDQoNCiMjIEZhY2V0aW5nDQoNCioqRmFjZXRpbmcqKiBzcGxpdHMgeW91ciBkYXRhIGJ5IG9uZSBvciBtb3JlIGNhdGVnb3JpY2FsIHZhcmlhYmxlcyBhbmQgY3JlYXRlcyBhIHNlcGFyYXRlIHBhbmVsIGZvciBlYWNoIGxldmVsLiBUaGlzIHRlY2huaXF1ZSAtLSBzb21ldGltZXMgY2FsbGVkICoqc21hbGwgbXVsdGlwbGVzKiogLS0gaXMgb25lIG9mIHRoZSBtb3N0IHBvd2VyZnVsIHRvb2xzIGluIGRhdGEgdmlzdWFsaXphdGlvbi4gSXQgYWxsb3dzIHlvdXIgdmlld2VyIHRvIGNvbXBhcmUgcGF0dGVybnMgYWNyb3NzIGdyb3VwcyB3aGlsZSBrZWVwaW5nIGEgY29uc2lzdGVudCBzY2FsZS4NCg0KZ2dwbG90MiBwcm92aWRlcyB0d28gZmFjZXRpbmcgZnVuY3Rpb25zOg0KDQotIGBmYWNldF93cmFwKH52YXJpYWJsZSlgIC0tIHdyYXBzIHBhbmVscyBpbnRvIGEgcmVjdGFuZ3VsYXIgbGF5b3V0LiBCZXN0IHdoZW4geW91IGhhdmUgYSBzaW5nbGUgZmFjZXRpbmcgdmFyaWFibGUuDQotIGBmYWNldF9ncmlkKHJvd192YXJpYWJsZSB+IGNvbF92YXJpYWJsZSlgIC0tIGNyZWF0ZXMgYSBtYXRyaXggb2YgcGFuZWxzLiBCZXN0IHdoZW4geW91IHdhbnQgdG8gY3Jvc3MgdHdvIHZhcmlhYmxlcy4NCg0KYGBge3IgdzMtZmFjZXRpbmctZGVtbywgZmlnLndpZHRoPTEwLCBmaWcuaGVpZ2h0PTYsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQpnZ3Bsb3QobXBnLCBhZXMoeCA9IGRpc3BsLCB5ID0gaHd5KSkgKw0KICBnZW9tX3BvaW50KGNvbG9yID0gIiMwMDI5NjciLCBhbHBoYSA9IDAuNiwgc2l6ZSA9IDEuNSkgKw0KICBnZW9tX3Ntb290aChtZXRob2QgPSAibG0iLCBzZSA9IEZBTFNFLCBjb2xvciA9ICIjQzQxRTNBIiwgbGluZXdpZHRoID0gMC44KSArDQogIGZhY2V0X3dyYXAofmNsYXNzLCBuY29sID0gNCkgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIkRpc3BsYWNlbWVudCB2cy4gSGlnaHdheSBNUEcgYnkgVmVoaWNsZSBDbGFzcyIsDQogICAgc3VidGl0bGUgPSAiRWFjaCBwYW5lbCBzaG93cyBvbmUgdmVoaWNsZSBjbGFzcyB3aXRoIGEgbGluZWFyIHRyZW5kIGxpbmUiLA0KICAgIHggPSAiRW5naW5lIERpc3BsYWNlbWVudCAoTCkiLA0KICAgIHkgPSAiSGlnaHdheSBNUEciDQogICkgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDEyKQ0KYGBgDQoNCk5vdGljZSBob3cgdGhlIGZhY2V0ZWQgdmlldyByZXZlYWxzIHBhdHRlcm5zIHRoYXQgYSBzaW5nbGUgc2NhdHRlcnBsb3Qgb2JzY3VyZXMuIEZvciBleGFtcGxlLCB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gZGlzcGxhY2VtZW50IGFuZCBmdWVsIGVjb25vbXkgaXMgdmVyeSBkaWZmZXJlbnQgZm9yIDItc2VhdGVyIHNwb3J0cyBjYXJzICh3aGljaCBhcmUgbGlnaHQgZGVzcGl0ZSBsYXJnZSBlbmdpbmVzKSBjb21wYXJlZCB0byBTVVZzLg0KDQo6Ojogey5jYWxsb3V0LWluZm99DQoqKlNjYWxlcyBpbiBmYWNldHM6KiogQnkgZGVmYXVsdCwgYWxsIHBhbmVscyBzaGFyZSB0aGUgc2FtZSB4IGFuZCB5IHNjYWxlcy4gVGhpcyBpcyB1c3VhbGx5IHdoYXQgeW91IHdhbnQgYmVjYXVzZSBpdCBtYWtlcyBjb21wYXJpc29ucyBmYWlyLiBJZiB5b3UgbmVlZCBlYWNoIHBhbmVsIHRvIGhhdmUgaXRzIG93biBzY2FsZSAoZm9yIGV4YW1wbGUsIHdoZW4gdGhlIHJhbmdlcyBkaWZmZXIgZHJhbWF0aWNhbGx5KSwgdXNlIGBzY2FsZXMgPSAiZnJlZSJgLCBgc2NhbGVzID0gImZyZWVfeCJgLCBvciBgc2NhbGVzID0gImZyZWVfeSJgIGluc2lkZSBgZmFjZXRfd3JhcCgpYC4NCjo6Og0KDQotLS0NCg0KIyMgU2NhbGVzDQoNCioqU2NhbGVzKiogY29udHJvbCBob3cgZGF0YSB2YWx1ZXMgYXJlIG1hcHBlZCB0byB2aXN1YWwgcHJvcGVydGllcy4gRXZlcnkgYWVzdGhldGljIG1hcHBpbmcgaGFzIGFuIGFzc29jaWF0ZWQgc2NhbGUsIHdoZXRoZXIgb3Igbm90IHlvdSBzcGVjaWZ5IG9uZSBleHBsaWNpdGx5LiBXaGVuIHlvdSB3cml0ZSBgYWVzKHggPSBkaXNwbClgLCBnZ3Bsb3QyIGF1dG9tYXRpY2FsbHkgY3JlYXRlcyBhIGNvbnRpbnVvdXMgeCBzY2FsZS4gV2hlbiB5b3Ugd3JpdGUgYGFlcyhjb2xvciA9IGNsYXNzKWAsIGl0IGNyZWF0ZXMgYSBkaXNjcmV0ZSBjb2xvciBzY2FsZS4NCg0KQ3VzdG9taXppbmcgc2NhbGVzIGdpdmVzIHlvdSBjb250cm9sIG92ZXI6DQoNCi0gKipBeGlzIGJyZWFrcyBhbmQgbGFiZWxzKiogLS0gd2hlcmUgdGljayBtYXJrcyBhcHBlYXIgYW5kIHdoYXQgdGhleSBzYXkNCi0gKipDb2xvciBwYWxldHRlcyoqIC0tIHdoaWNoIGNvbG9ycyByZXByZXNlbnQgeW91ciBkYXRhDQotICoqVHJhbnNmb3JtYXRpb25zKiogLS0gbG9nIHNjYWxlcywgc3F1YXJlIHJvb3Qgc2NhbGVzLCByZXZlcnNlZCBheGVzDQotICoqRm9ybWF0dGluZyoqIC0tIGRvbGxhciBzaWducywgcGVyY2VudGFnZXMsIGNvbW1hcw0KDQojIyMgQ29tbW9uIFNjYWxlIEZ1bmN0aW9ucw0KDQp8IEZ1bmN0aW9uIHwgUHVycG9zZSB8DQp8Oi0tLS0tLS0tLXw6LS0tLS0tLS18DQp8IGBzY2FsZV94X2NvbnRpbnVvdXMoKWAgLyBgc2NhbGVfeV9jb250aW51b3VzKClgIHwgQ3VzdG9taXplIGNvbnRpbnVvdXMgYXhlcyB8DQp8IGBzY2FsZV94X2Rpc2NyZXRlKClgIC8gYHNjYWxlX3lfZGlzY3JldGUoKWAgfCBDdXN0b21pemUgY2F0ZWdvcmljYWwgYXhlcyB8DQp8IGBzY2FsZV9jb2xvcl9tYW51YWwoKWAgLyBgc2NhbGVfZmlsbF9tYW51YWwoKWAgfCBTZXQgc3BlY2lmaWMgY29sb3JzIGJ5IGhhbmQgfA0KfCBgc2NhbGVfY29sb3JfYnJld2VyKClgIC8gYHNjYWxlX2ZpbGxfYnJld2VyKClgIHwgVXNlIENvbG9yQnJld2VyIHBhbGV0dGVzIHwNCnwgYHNjYWxlX2NvbG9yX3ZpcmlkaXNfYygpYCAvIGBzY2FsZV9maWxsX3ZpcmlkaXNfYygpYCB8IFBlcmNlcHR1YWxseSB1bmlmb3JtLCBjb2xvcmJsaW5kLWZyaWVuZGx5IHwNCnwgYHNjYWxlX3hfbG9nMTAoKWAgLyBgc2NhbGVfeV9sb2cxMCgpYCB8IExvZy10cmFuc2Zvcm1lZCBheGVzIHwNCg0KYGBge3IgdzMtc2NhbGVzLWRlbW8sIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTUsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQpsaWJyYXJ5KHNjYWxlcykNCg0KZ2dwbG90KGRpYW1vbmRzICU+JSBzYW1wbGVfbig1MDAwKSwgYWVzKHggPSBjYXJhdCwgeSA9IHByaWNlLCBjb2xvciA9IGN1dCkpICsNCiAgZ2VvbV9wb2ludChhbHBoYSA9IDAuNCwgc2l6ZSA9IDEpICsNCiAgc2NhbGVfeV9jb250aW51b3VzKGxhYmVscyA9IGRvbGxhcl9mb3JtYXQoKSkgKw0KICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsIDUsIGJ5ID0gMC41KSkgKw0KICBzY2FsZV9jb2xvcl9icmV3ZXIocGFsZXR0ZSA9ICJEYXJrMiIpICsNCiAgbGFicygNCiAgICB0aXRsZSA9ICJEaWFtb25kIFByaWNlIHZzLiBDYXJhdCIsDQogICAgc3VidGl0bGUgPSAiNSwwMDAgcmFuZG9tbHkgc2FtcGxlZCBkaWFtb25kcyBmcm9tIHRoZSBkaWFtb25kcyBkYXRhc2V0IiwNCiAgICB4ID0gIkNhcmF0IiwNCiAgICB5ID0gIlByaWNlIChVU0QpIiwNCiAgICBjb2xvciA9ICJDdXQgUXVhbGl0eSINCiAgKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTMpDQpgYGANCg0KIyMjIEdvbnphZ2EgQ29sb3IgUGFsZXR0ZQ0KDQpUaHJvdWdob3V0IHRoaXMgY291cnNlLCB3ZSB3aWxsIGZyZXF1ZW50bHkgdXNlIEdvbnphZ2EncyBvZmZpY2lhbCBjb2xvcnMuIEhlcmUgaXMgYSByZWZlcmVuY2UgcGFsZXR0ZSB5b3UgY2FuIHVzZSBpbiB5b3VyIG93biBwbG90czoNCg0KYGBge3IgdzMtZ29uemFnYS1wYWxldHRlLCBlY2hvPUZBTFNFLCBmaWcuY2FwPSJHb256YWdhIFVuaXZlcnNpdHkgYnJhbmQgY29sb3JzIGZvciB1c2UgaW4gZGF0YSB2aXN1YWxpemF0aW9uLiIsIG91dC53aWR0aD0iNjAlIn0NCmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJpbWFnZXMvMDUvY29sb3JfcGFsZXR0ZS5wbmciKQ0KYGBgDQoNCllvdSBjYW4gZGVmaW5lIGEgcmV1c2FibGUgdmVjdG9yIG9mIEdvbnphZ2EgY29sb3JzOg0KDQpgYGB7ciB3My1nb256YWdhLWNvbG9yc30NCmdvbnphZ2FfY29sb3JzIDwtIGMoDQogIG5hdnkgPSAiIzAwMjk2NyIsDQogIHJlZCAgPSAiI0M0MUUzQSIsDQogIGdvbGQgPSAiI0I0OTc1QSIsDQogIGxpZ2h0X2JsdWUgPSAiIzRBOTBEOSIsDQogIGxpZ2h0X2dyYXkgPSAiI2VmZjZmZiINCikNCmBgYA0KDQotLS0NCg0KIyMgVGhlbWVzDQoNCioqVGhlbWVzKiogY29udHJvbCBhbGwgb2YgdGhlIG5vbi1kYXRhIHZpc3VhbCBlbGVtZW50cyBvZiB5b3VyIHBsb3Q6IGJhY2tncm91bmQgY29sb3JzLCBncmlkIGxpbmVzLCBmb250IHNpemVzLCBheGlzIHRpY2sgbWFya3MsIGxlZ2VuZCBwbGFjZW1lbnQsIGFuZCBtb3JlLiBBIHdlbGwtY2hvc2VuIHRoZW1lIGNhbiBlbGV2YXRlIGEgc2VydmljZWFibGUgcGxvdCBpbnRvIGEgcHJvZmVzc2lvbmFsLCBwdWJsaWNhdGlvbi1yZWFkeSBncmFwaGljLg0KDQojIyMgQnVpbHQtaW4gVGhlbWVzDQoNCmdncGxvdDIgc2hpcHMgd2l0aCBzZXZlcmFsIGJ1aWx0LWluIHRoZW1lczoNCg0KLSBgdGhlbWVfZ3JheSgpYCAtLSB0aGUgZGVmYXVsdCBncmF5IGJhY2tncm91bmQgd2l0aCB3aGl0ZSBncmlkIGxpbmVzDQotIGB0aGVtZV9taW5pbWFsKClgIC0tIGEgY2xlYW4sIG1pbmltYWwgZGVzaWduIChvdXIgY291cnNlIGRlZmF1bHQpDQotIGB0aGVtZV9jbGFzc2ljKClgIC0tIGEgdHJhZGl0aW9uYWwgbG9vayB3aXRoIGF4aXMgbGluZXMgYW5kIG5vIGdyaWQNCi0gYHRoZW1lX2J3KClgIC0tIGJsYWNrIGFuZCB3aGl0ZSB3aXRoIGEgYm9yZGVyDQotIGB0aGVtZV92b2lkKClgIC0tIGNvbXBsZXRlbHkgYmxhbmsgKHVzZWZ1bCBmb3IgbWFwcyBhbmQgZGlhZ3JhbXMpDQoNClRoZSBgZ2d0aGVtZXNgIHBhY2thZ2UgYWRkcyBtYW55IG1vcmUsIGluc3BpcmVkIGJ5IGZhbW91cyBwdWJsaWNhdGlvbnMgYW5kIGRlc2lnbmVyczoNCg0KLSBgdGhlbWVfZWNvbm9taXN0KClgIC0tIHN0eWxlZCBsaWtlICpUaGUgRWNvbm9taXN0KiBtYWdhemluZQ0KLSBgdGhlbWVfZml2ZXRoaXJ0eWVpZ2h0KClgIC0tIHN0eWxlZCBsaWtlIEZpdmVUaGlydHlFaWdodA0KLSBgdGhlbWVfdHVmdGUoKWAgLS0gaW5zcGlyZWQgYnkgRWR3YXJkIFR1ZnRlJ3MgbWluaW1hbGlzdCBwaGlsb3NvcGh5DQoNCmBgYHtyIHczLXRoZW1lLWNvbXBhcmlzb24sIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD04LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KbGlicmFyeShnZ3RoZW1lcykNCg0KYmFzZSA8LSBnZ3Bsb3QobXBnLCBhZXMoeCA9IGRpc3BsLCB5ID0gaHd5KSkgKw0KICBnZW9tX3BvaW50KGNvbG9yID0gIiMwMDI5NjciLCBhbHBoYSA9IDAuNykgKw0KICBsYWJzKHggPSAiRGlzcGxhY2VtZW50IChMKSIsIHkgPSAiSGlnaHdheSBNUEciKQ0KDQooYmFzZSArIHRoZW1lX21pbmltYWwoKSArIGxhYnMoc3VidGl0bGUgPSAidGhlbWVfbWluaW1hbCgpIikpICsNCihiYXNlICsgdGhlbWVfY2xhc3NpYygpICsgbGFicyhzdWJ0aXRsZSA9ICJ0aGVtZV9jbGFzc2ljKCkiKSkgKw0KKGJhc2UgKyB0aGVtZV9lY29ub21pc3QoKSArIGxhYnMoc3VidGl0bGUgPSAidGhlbWVfZWNvbm9taXN0KCkiKSkgKw0KKGJhc2UgKyB0aGVtZV90dWZ0ZSgpICsgbGFicyhzdWJ0aXRsZSA9ICJ0aGVtZV90dWZ0ZSgpIikpICsNCiAgcGxvdF9sYXlvdXQobmNvbCA9IDIpICsNCiAgcGxvdF9hbm5vdGF0aW9uKHRpdGxlID0gIlRoZW1lIENvbXBhcmlzb24iLA0KICAgICAgICAgICAgICAgICAgdGhlbWUgPSB0aGVtZShwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNiwgZmFjZSA9ICJib2xkIikpKQ0KYGBgDQoNCiMjIyBDdXN0b20gVGhlbWUgRWxlbWVudHMNCg0KWW91IGNhbiBvdmVycmlkZSBpbmRpdmlkdWFsIHRoZW1lIGVsZW1lbnRzIHVzaW5nIHRoZSBgdGhlbWUoKWAgZnVuY3Rpb24uIEV2ZXJ5IGVsZW1lbnQgaXMgY29udHJvbGxlZCBieSBvbmUgb2YgZm91ciBmdW5jdGlvbnM6DQoNCi0gYGVsZW1lbnRfdGV4dCgpYCAtLSBjb250cm9scyB0ZXh0IChzaXplLCBjb2xvciwgZmFjZSwgZmFtaWx5LCBhbmdsZSkNCi0gYGVsZW1lbnRfbGluZSgpYCAtLSBjb250cm9scyBsaW5lcyAoY29sb3IsIGxpbmV3aWR0aCwgbGluZXR5cGUpDQotIGBlbGVtZW50X3JlY3QoKWAgLS0gY29udHJvbHMgcmVjdGFuZ2xlcyAoZmlsbCwgY29sb3IsIGxpbmV3aWR0aCkNCi0gYGVsZW1lbnRfYmxhbmsoKWAgLS0gcmVtb3ZlcyB0aGUgZWxlbWVudCBlbnRpcmVseQ0KDQpgYGB7ciB3My1jdXN0b20tdGhlbWUsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTV9DQpnZ3Bsb3QobXBnLCBhZXMoeCA9IGRpc3BsLCB5ID0gaHd5LCBjb2xvciA9IGNsYXNzKSkgKw0KICBnZW9tX3BvaW50KHNpemUgPSAyLCBhbHBoYSA9IDAuNykgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIkEgQ3VzdG9tLVRoZW1lZCBQbG90IiwNCiAgICBzdWJ0aXRsZSA9ICJEZW1vbnN0cmF0aW5nIGluZGl2aWR1YWwgdGhlbWUgZWxlbWVudCBvdmVycmlkZXMiLA0KICAgIHggPSAiRW5naW5lIERpc3BsYWNlbWVudCAoTCkiLA0KICAgIHkgPSAiSGlnaHdheSBNUEciLA0KICAgIGNvbG9yID0gIlZlaGljbGUgQ2xhc3MiDQogICkgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDEzKSArDQogIHRoZW1lKA0KICAgIHBsb3QudGl0bGUgPSBlbGVtZW50X3RleHQoZmFjZSA9ICJib2xkIiwgY29sb3IgPSAiIzAwMjk2NyIsIHNpemUgPSAxNiksDQogICAgcGxvdC5zdWJ0aXRsZSA9IGVsZW1lbnRfdGV4dChjb2xvciA9ICIjNjY2NjY2Iiwgc2l6ZSA9IDEyKSwNCiAgICBheGlzLnRpdGxlID0gZWxlbWVudF90ZXh0KGNvbG9yID0gIiMwMDI5NjciKSwNCiAgICBwYW5lbC5ncmlkLm1pbm9yID0gZWxlbWVudF9ibGFuaygpLA0KICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iLA0KICAgIGxlZ2VuZC50aXRsZSA9IGVsZW1lbnRfdGV4dChmYWNlID0gImJvbGQiKQ0KICApDQpgYGANCg0KOjo6IHsuY2FsbG91dC10aXB9DQoqKlRpcDogQnVpbGQgYSByZXVzYWJsZSB0aGVtZS4qKiBJZiB5b3UgZmluZCB5b3Vyc2VsZiBhcHBseWluZyB0aGUgc2FtZSBgdGhlbWUoKWAgb3ZlcnJpZGVzIHRvIGV2ZXJ5IHBsb3QsIGNyZWF0ZSBhIGN1c3RvbSB0aGVtZSBmdW5jdGlvbi4gWW91IGNhbiB0aGVuIGFwcGx5IGl0IHdpdGggYSBzaW5nbGUgYCsgdGhlbWVfZ29uemFnYSgpYCBjYWxsOg0KDQpgYGByDQp0aGVtZV9nb256YWdhIDwtIGZ1bmN0aW9uKGJhc2Vfc2l6ZSA9IDEzKSB7DQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gYmFzZV9zaXplKSAlK3JlcGxhY2UlDQogICAgdGhlbWUoDQogICAgICBwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KGZhY2UgPSAiYm9sZCIsIGNvbG9yID0gIiMwMDI5NjciLCBzaXplID0gYmFzZV9zaXplICsgMyksDQogICAgICBwbG90LnN1YnRpdGxlID0gZWxlbWVudF90ZXh0KGNvbG9yID0gIiM2NjY2NjYiKSwNCiAgICAgIGF4aXMudGl0bGUgPSBlbGVtZW50X3RleHQoY29sb3IgPSAiIzAwMjk2NyIpLA0KICAgICAgcGFuZWwuZ3JpZC5taW5vciA9IGVsZW1lbnRfYmxhbmsoKSwNCiAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iDQogICAgKQ0KfQ0KYGBgDQo6OjoNCg0KIyMjIEJvbnVzOiBUdWZ0ZSdzIFJlZGVzaWduZWQgQm94cGxvdA0KDQpFZHdhcmQgVHVmdGUgcHJvcG9zZWQgYSBzdHJpcHBlZC1kb3duIHZlcnNpb24gb2YgdGhlIGJveHBsb3QgdGhhdCByZW1vdmVzIHRoZSAiYm94IiBlbnRpcmVseSwgcmVwbGFjaW5nIGl0IHdpdGggYSB0aGluIGxpbmUgZm9yIHRoZSBpbnRlcnF1YXJ0aWxlIHJhbmdlIGFuZCBhIHBvaW50IG9yIGdhcCBmb3IgdGhlIG1lZGlhbi4gVGhpcyBtYXhpbWl6ZXMgdGhlIGRhdGEtaW5rIHJhdGlvIHdoaWxlIHByZXNlcnZpbmcgYWxsIGVzc2VudGlhbCBpbmZvcm1hdGlvbi4gVGhlIGBnZ3RoZW1lc2AgcGFja2FnZSBwcm92aWRlcyBgZ2VvbV90dWZ0ZWJveHBsb3QoKWAgZm9yIHRoaXMgcHVycG9zZS4NCg0KYGBge3IgdzMtdHVmdGUtYm94cGxvdCwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCmdncGxvdChtcGcsIGFlcyh4ID0gY2xhc3MsIHkgPSBod3kpKSArDQogIGdlb21fdHVmdGVib3hwbG90KGNvbG9yID0gIiMwMDI5NjciKSArDQogIGxhYnMoDQogICAgdGl0bGUgPSAiVHVmdGUtU3R5bGUgQm94cGxvdCIsDQogICAgc3VidGl0bGUgPSAiTWluaW1hbCBpbmssIG1heGltdW0gZGF0YSAtLSBjb21wYXJlIHRvIHRoZSBzdGFuZGFyZCBib3hwbG90IGFib3ZlIiwNCiAgICB4ID0gIlZlaGljbGUgQ2xhc3MiLA0KICAgIHkgPSAiSGlnaHdheSBNUEciDQogICkgKw0KICB0aGVtZV90dWZ0ZShiYXNlX3NpemUgPSAxMykgKw0KICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChhbmdsZSA9IDMwLCBoanVzdCA9IDEpKQ0KYGBgDQoNCkNvbXBhcmUgdGhpcyB0byB0aGUgc3RhbmRhcmQgYm94cGxvdCBpbiB0aGUgR2VvbWV0cmllcyBzZWN0aW9uIGFib3ZlLiBUaGUgVHVmdGUgdmVyc2lvbiBjb252ZXlzIHRoZSBzYW1lIGRpc3RyaWJ1dGlvbmFsIGluZm9ybWF0aW9uIC0tIG1lZGlhbiwgc3ByZWFkLCBvdXRsaWVycyAtLSB1c2luZyBmYXIgbGVzcyBpbmsuIEV2ZXJ5IG1hcmsgb24gdGhlIHBhZ2UgaXMgZG9pbmcgcmVhbCB3b3JrLiBUaGlzIGlzIHRoZSBkYXRhLWluayByYXRpbyBpbiBhY3Rpb24uDQoNCjo6OiB7LmNhbGxvdXQtaW5mb30NCioqQWJvdXQgZ2d0aGVtZXM6KiogVGhlIGBnZ3RoZW1lc2AgcGFja2FnZSBwcm92aWRlcyBzZXZlcmFsIFR1ZnRlLWluc3BpcmVkIGVsZW1lbnRzIGluY2x1ZGluZyBgdGhlbWVfdHVmdGUoKWAsIGBnZW9tX3R1ZnRlYm94cGxvdCgpYCwgYW5kIGBnZW9tX3JhbmdlZnJhbWUoKWAuIFRoZXNlIGFyZSBleGNlbGxlbnQgdG9vbHMgZm9yIGFwcGx5aW5nIGRlc2lnbiBwcmluY2lwbGVzIGRpcmVjdGx5IGluIGdncGxvdDIuDQo6OjoNCg0KLS0tDQoNCiMjIENvbWJpbmluZyBNdWx0aXBsZSBQbG90cyB3aXRoIHBhdGNod29yaw0KDQpUaGUgYHBhdGNod29ya2AgcGFja2FnZSBtYWtlcyBpdCBlYXN5IHRvIGNvbWJpbmUgbXVsdGlwbGUgZ2dwbG90MiBwbG90cyBpbnRvIGEgc2luZ2xlIGZpZ3VyZS4gWW91IGhhdmUgYWxyZWFkeSBzZWVuIGl0IGluIGFjdGlvbiBhYm92ZS4gSGVyZSBpcyBhIHF1aWNrIHJlZmVyZW5jZSBmb3IgaXRzIG9wZXJhdG9yczoNCg0KfCBPcGVyYXRvciB8IEVmZmVjdCB8DQp8Oi0tLS0tLS0tLXw6LS0tLS0tLXwNCnwgYHAxICsgcDJgIHwgU2lkZSBieSBzaWRlIHwNCnwgYHAxIC8gcDJgIHwgU3RhY2tlZCB2ZXJ0aWNhbGx5IHwNCnwgYHAxICsgcDIgKyBwbG90X2xheW91dChuY29sID0gMSlgIHwgU3RhY2tlZCB3aXRoIGV4cGxpY2l0IGxheW91dCB8DQp8IGAocDEgKyBwMikgLyBwM2AgfCBUd28gb24gdG9wLCBvbmUgb24gYm90dG9tIHwNCnwgYHBsb3RfYW5ub3RhdGlvbih0aXRsZSA9ICIuLi4iKWAgfCBBZGQgYW4gb3ZlcmFsbCB0aXRsZSB8DQoNCmBgYHtyIHczLXBhdGNod29yay1kZW1vLCBmaWcud2lkdGg9MTAsIGZpZy5oZWlnaHQ9NCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCnBfc2NhdHRlciA8LSBnZ3Bsb3QobXBnLCBhZXMoZGlzcGwsIGh3eSkpICsNCiAgZ2VvbV9wb2ludChjb2xvciA9ICIjMDAyOTY3IiwgYWxwaGEgPSAwLjYpICsNCiAgbGFicyh0aXRsZSA9ICJTY2F0dGVycGxvdCIsIHggPSAiRGlzcGxhY2VtZW50IiwgeSA9ICJIaWdod2F5IE1QRyIpICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMSkNCg0KcF9oaXN0IDwtIGdncGxvdChtcGcsIGFlcyh4ID0gaHd5KSkgKw0KICBnZW9tX2hpc3RvZ3JhbShiaW53aWR0aCA9IDIsIGZpbGwgPSAiI0M0MUUzQSIsIGNvbG9yID0gIndoaXRlIikgKw0KICBsYWJzKHRpdGxlID0gIkhpc3RvZ3JhbSIsIHggPSAiSGlnaHdheSBNUEciLCB5ID0gIkNvdW50IikgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDExKQ0KDQpwX2JveCA8LSBnZ3Bsb3QobXBnLCBhZXMoeCA9IGRydiwgeSA9IGh3eSkpICsNCiAgZ2VvbV9ib3hwbG90KGZpbGwgPSAiI0I0OTc1QSIsIGNvbG9yID0gIiMwMDI5NjciKSArDQogIGxhYnModGl0bGUgPSAiQm94cGxvdCIsIHggPSAiRHJpdmUgVHlwZSIsIHkgPSAiSGlnaHdheSBNUEciKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTEpDQoNCnBfc2NhdHRlciArIHBfaGlzdCArIHBfYm94ICsNCiAgcGxvdF9hbm5vdGF0aW9uKA0KICAgIHRpdGxlID0gIlRocmVlIFZpZXdzIG9mIHRoZSBtcGcgRGF0YXNldCIsDQogICAgdGhlbWUgPSB0aGVtZShwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KGZhY2UgPSAiYm9sZCIsIHNpemUgPSAxNCkpDQogICkNCmBgYA0KDQotLS0NCg0KIyMgU2F2aW5nIFBsb3RzIHdpdGggZ2dzYXZlKCkNCg0KT25jZSB5b3UgaGF2ZSBjcmVhdGVkIGEgcHVibGljYXRpb24tcXVhbGl0eSBncmFwaGljLCB5b3UgbmVlZCB0byBzYXZlIGl0IGF0IHRoZSByaWdodCBzaXplIGFuZCByZXNvbHV0aW9uLiBUaGUgYGdnc2F2ZSgpYCBmdW5jdGlvbiBtYWtlcyB0aGlzIHN0cmFpZ2h0Zm9yd2FyZDoNCg0KYGBge3IgdzMtc2F2aW5nLXBsb3RzLCBldmFsPUZBTFNFfQ0KIyBTYXZlIHRoZSBsYXN0IHBsb3QgZGlzcGxheWVkDQpnZ3NhdmUoIm15X3Bsb3QucG5nIiwgd2lkdGggPSA4LCBoZWlnaHQgPSA1LCBkcGkgPSAzMDApDQoNCiMgU2F2ZSBhIHNwZWNpZmljIHBsb3Qgb2JqZWN0DQpteV9wbG90IDwtIGdncGxvdChtcGcsIGFlcyhkaXNwbCwgaHd5KSkgKw0KICBnZW9tX3BvaW50KGNvbG9yID0gIiMwMDI5NjciKSArDQogIHRoZW1lX21pbmltYWwoKQ0KDQpnZ3NhdmUoIm15X3Bsb3QucG5nIiwgcGxvdCA9IG15X3Bsb3QsIHdpZHRoID0gOCwgaGVpZ2h0ID0gNSwgZHBpID0gMzAwKQ0KDQojIFNhdmUgYXMgUERGICh2ZWN0b3IgZm9ybWF0IC0tIGdyZWF0IGZvciBwcmludCkNCmdnc2F2ZSgibXlfcGxvdC5wZGYiLCBwbG90ID0gbXlfcGxvdCwgd2lkdGggPSA4LCBoZWlnaHQgPSA1KQ0KDQojIFNhdmUgYXMgU1ZHICh2ZWN0b3IgZm9ybWF0IC0tIGdyZWF0IGZvciB3ZWIpDQpnZ3NhdmUoIm15X3Bsb3Quc3ZnIiwgcGxvdCA9IG15X3Bsb3QsIHdpZHRoID0gOCwgaGVpZ2h0ID0gNSkNCmBgYA0KDQo6Ojogey5jYWxsb3V0LWluZm99DQoqKlJlc29sdXRpb24gZ3VpZGVsaW5lczoqKg0KDQotICoqU2NyZWVuL3dlYjoqKiA3Mi0tMTUwIGRwaSBpcyBzdWZmaWNpZW50DQotICoqUHJlc2VudGF0aW9uczoqKiAxNTAtLTIwMCBkcGkNCi0gKipQcmludC9wdWJsaWNhdGlvbjoqKiAzMDAgZHBpIG9yIGhpZ2hlcg0KLSAqKlZlY3RvciBmb3JtYXRzKiogKFBERiwgU1ZHKSBhcmUgcmVzb2x1dGlvbi1pbmRlcGVuZGVudCBhbmQgYXJlIHByZWZlcnJlZCBmb3IgcHVibGljYXRpb25zDQo6OjoNCg0KLS0tDQoNCiMjIFB1dHRpbmcgSXQgQWxsIFRvZ2V0aGVyDQoNCkxldCB1cyBidWlsZCBvbmUgbW9yZSBwb2xpc2hlZCB2aXN1YWxpemF0aW9uIHRoYXQgaW5jb3Jwb3JhdGVzIGV2ZXJ5dGhpbmcgd2UgaGF2ZSBsZWFybmVkIHRoaXMgd2Vlay4gV2Ugd2lsbCB1c2UgdGhlIGBkaWFtb25kc2AgZGF0YXNldCB0byBjcmVhdGUgYSBjb21wcmVoZW5zaXZlIHZpZXcgb2YgZGlhbW9uZCBjaGFyYWN0ZXJpc3RpY3M6DQoNCmBgYHtyIHczLXB1dHRpbmctdG9nZXRoZXIsIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD02LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KZGlhbW9uZHMgJT4lDQogIGZpbHRlcihjYXJhdCA8PSAzKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0gY2FyYXQsIHkgPSBwcmljZSkpICsNCiAgZ2VvbV9oZXgoYmlucyA9IDQwKSArDQogIHNjYWxlX2ZpbGxfZ3JhZGllbnQobG93ID0gIiNlZmY2ZmYiLCBoaWdoID0gIiMwMDI5NjciLCBsYWJlbHMgPSBjb21tYV9mb3JtYXQoKSkgKw0KICBzY2FsZV95X2NvbnRpbnVvdXMobGFiZWxzID0gZG9sbGFyX2Zvcm1hdCgpKSArDQogIGZhY2V0X3dyYXAofmN1dCwgbmNvbCA9IDUpICsNCiAgbGFicygNCiAgICB0aXRsZSA9ICJEaWFtb25kIFByaWNlIHZzLiBDYXJhdCBieSBDdXQgUXVhbGl0eSIsDQogICAgc3VidGl0bGUgPSAiSGV4YWdvbmFsIGJpbm5pbmcgcmV2ZWFscyBkZW5zaXR5IHBhdHRlcm5zIGFjcm9zcyA1MCwwMDArIGRpYW1vbmRzIiwNCiAgICB4ID0gIkNhcmF0IiwNCiAgICB5ID0gIlByaWNlIChVU0QpIiwNCiAgICBmaWxsID0gIkNvdW50Ig0KICApICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMSkgKw0KICB0aGVtZSgNCiAgICBwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KGZhY2UgPSAiYm9sZCIsIGNvbG9yID0gIiMwMDI5NjciKSwNCiAgICBzdHJpcC50ZXh0ID0gZWxlbWVudF90ZXh0KGZhY2UgPSAiYm9sZCIsIGNvbG9yID0gIiMwMDI5NjciKSwNCiAgICBsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIg0KICApDQpgYGANCg0KVGhpcyBzaW5nbGUgcGxvdCB1c2VzIGRhdGEgKGRpYW1vbmRzKSwgYWVzdGhldGljcyAoeCwgeSwgZmlsbCksIGEgZ2VvbWV0cnkgKGhleGFnb25hbCBiaW5zKSwgYSBzY2FsZSAoZ3JhZGllbnQgZmlsbCwgZG9sbGFyLWZvcm1hdHRlZCB5LWF4aXMpLCBmYWNldGluZyAoYnkgY3V0KSwgbGFiZWxzLCBhbmQgYSBjdXN0b21pemVkIHRoZW1lLiBFdmVyeSBsYXllciBvZiB0aGUgZ3JhbW1hciBvZiBncmFwaGljcyBpcyB3b3JraW5nIHRvZ2V0aGVyLg0KDQo6Ojogey5jYWxsb3V0LWlnbmF0aWFufQ0KKipJZ25hdGlhbiBSZWZsZWN0aW9uOiBNYWdpcyBpbiBWaXN1YWxpemF0aW9uKioNCg0KVGhlIElnbmF0aWFuIHByaW5jaXBsZSBvZiAqbWFnaXMqIC0tIHRoZSAibW9yZSIgLS0gY2FsbHMgdXMgbm90IHRvIHNldHRsZSBmb3Igd2hhdCBpcyBtZXJlbHkgYWRlcXVhdGUgYnV0IHRvIHB1cnN1ZSBleGNlbGxlbmNlIGZvciB0aGUgZ3JlYXRlciBnb29kLiBJbiBkYXRhIHZpc3VhbGl6YXRpb24sICptYWdpcyogbWVhbnMgbm90IHNldHRsaW5nIGZvciB0aGUgZGVmYXVsdC4gVGhlIGRlZmF1bHQgZ3JheSB0aGVtZSwgdGhlIGRlZmF1bHQgYXhpcyBsYWJlbHMsIHRoZSBkZWZhdWx0IGNvbG9yIHBhbGV0dGUgLS0gdGhlc2UgYXJlIHN0YXJ0aW5nIHBvaW50cywgbm90IGVuZHBvaW50cy4gRXZlcnkgZGVzaWduIGNob2ljZSBpcyBhbiBvcHBvcnR1bml0eSB0byBjb21tdW5pY2F0ZSBtb3JlIGNsZWFybHksIG1vcmUgaG9uZXN0bHksIG1vcmUgYmVhdXRpZnVsbHkuIEFzIFdpY2toYW0gaGltc2VsZiB3cm90ZSwgIkEgZ29vZCB2aXN1YWxpemF0aW9uIHNob3dzIHlvdSB0aGluZ3MgeW91IGRpZCBub3QgZXhwZWN0LCBvciByYWlzZXMgbmV3IHF1ZXN0aW9ucyBhYm91dCB0aGUgZGF0YS4iIFB1cnN1ZSB0aGF0ICptb3JlKi4NCjo6Og0KDQotLS0NCg0KIyMgQ2hhbGxlbmdlOiBMYXllciBDYWtlDQoNCjxkaXYgY2xhc3M9InNhbmRib3gtc2VjdGlvbiI+DQo8ZGl2IGNsYXNzPSJzYW5kYm94LWhlYWRlciI+DQo8c3BhbiBjbGFzcz0ic2FuZGJveC1pY29uIj7wn46uPC9zcGFuPiBMYXllciBDYWtlIOKAlCBTdGFjayB0aGUgZ3JhbW1hciBvZiBncmFwaGljcyBpbiB0aGUgcmlnaHQgb3JkZXINCjwvZGl2Pg0KPGlmcmFtZSBjbGFzcz0ic2FuZGJveC1mcmFtZSIgc3JjPSJodHRwczovL2FuYWx5dGljcy5nb256YWdhLmVkdS93ZWVrMDMtZ2FtZS8iDQogICAgICAgIGhlaWdodD0iNzAwIiBsb2FkaW5nPSJsYXp5IiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+DQo8ZGl2IGNsYXNzPSJzYW5kYm94LWNvbGQtc3RhcnQiPg0KSWYgdGhlIGFwcCB0YWtlcyBhIGZldyBzZWNvbmRzIHRvIGxvYWQgb24gZmlyc3QgdmlzaXQsIHRoYXQgaXMgbm9ybWFsIOKAlCB0aGUgc2VydmVyIGlzIHdha2luZyB1cC4NCjwvZGl2Pg0KPC9kaXY+DQoNCjo6OiB7LnRyeS1pdC1ib3h9DQoqKkhvdyB0byBQbGF5OioqDQoNCjEuIEVudGVyIHlvdXIgbmFtZSBhbmQgY2xpY2sgKipTdGFydCBHYW1lKioNCjIuIEVhY2ggcm91bmQgc2hvd3MgYSB0YXJnZXQgcGxvdCBhbmQgc2NyYW1ibGVkIGdncGxvdDIgbGF5ZXIgZnJhZ21lbnRzDQozLiBEcmFnIGFuZCBkcm9wIHRoZSBsYXllcnMgaW50byB0aGUgY29ycmVjdCBvcmRlciDigJQgdGhlIGFwcCByZW5kZXJzIHlvdXIgb3JkZXJpbmcgdnMuIHRoZSBjb3JyZWN0IG9uZQ0KNC4gQ29tcGxldGUgYWxsIDggcm91bmRzLCB0aGVuIGNvcHkgeW91ciBjb21wbGV0aW9uIHJlcG9ydCBpbnRvIHRoZSBDYW52YXMgYXNzaWdubWVudA0KOjo6DQoNCi0tLQ0KDQojIyBFeGVyY2lzZXMNCg0KOjo6IHsuZXhlcmNpc2UtYmxvY2t9DQo6Ojogey5leGVyY2lzZS1oZWFkZXJ9DQpXZWVrIDMgRXhlcmNpc2VzDQo6OjoNCjo6OiB7LmV4ZXJjaXNlLWJvZHl9DQoNCioqRXhlcmNpc2UgMTogWW91ciBGaXJzdCBMYXllcmVkIFBsb3QqKg0KDQpVc2luZyB0aGUgYG1wZ2AgZGF0YXNldCwgYnVpbGQgYSBzY2F0dGVycGxvdCBvZiBgY3R5YCAoY2l0eSBNUEcsIHgtYXhpcykgdnMuIGBod3lgIChoaWdod2F5IE1QRywgeS1heGlzKS4gRmlsbCBpbiB0aGUgYmxhbmtzIGluIHRoZSB0ZW1wbGF0ZSBiZWxvdy4gTWFwIHRoZSBgZHJ2YCB2YXJpYWJsZSB0byBjb2xvciB1c2luZyBHb256YWdhIGNvbG9ycywgYWRkIGF4aXMgbGFiZWxzIGFuZCBhIHRpdGxlLCBhbmQgYXBwbHkgYHRoZW1lX21pbmltYWwoKWAuDQoNCjo6OiB7LnRlbXBsYXRlLWNvZGV9DQoqKlRlbXBsYXRlIC0tIGZpbGwgaW4gdGhlIGBfX19gIGJsYW5rczoqKg0KDQpgYGByDQpsaWJyYXJ5KHRpZHl2ZXJzZSkNCg0KZ2dwbG90KF9fXywgYWVzKHggPSBfX18sIHkgPSBfX18sIGNvbG9yID0gX19fKSkgKw0KICBnZW9tX3BvaW50KHNpemUgPSAyLCBhbHBoYSA9IDAuNykgKw0KICBzY2FsZV9jb2xvcl9tYW51YWwoDQogICAgdmFsdWVzID0gYygiNCIgPSAiIzAwMjk2NyIsICJmIiA9ICJfX18iLCAiciIgPSAiX19fIiksDQogICAgbGFiZWxzID0gYygiNCIgPSAiNC13aGVlbCIsICJmIiA9ICJGcm9udCIsICJyIiA9ICJSZWFyIikNCiAgKSArDQogIGxhYnMoDQogICAgdGl0bGUgPSAiX19fIiwNCiAgICB4ID0gIkNpdHkgTVBHIiwNCiAgICB5ID0gIkhpZ2h3YXkgTVBHIiwNCiAgICBjb2xvciA9ICJEcml2ZSBUeXBlIg0KICApICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMykNCmBgYA0KOjo6DQoNCkFmdGVyIGNvbXBsZXRpbmcgdGhlIHRlbXBsYXRlLCB3cml0ZSAxLS0yIHNlbnRlbmNlcyBpbnRlcnByZXRpbmcgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGNpdHkgYW5kIGhpZ2h3YXkgZnVlbCBlY29ub215LiBJcyB0aGVyZSBhIHBhdHRlcm4/IERvIHRoZSBkcml2ZSB0eXBlcyBjbHVzdGVyIGRpZmZlcmVudGx5Pw0KDQoqKkV4ZXJjaXNlIDI6IEJhciBDaGFydCB3aXRoIGdlb21fY29sKCkqKg0KDQpUaGUgY29kZSBiZWxvdyBzdW1tYXJpemVzIHRoZSBgZGlhbW9uZHNgIGRhdGFzZXQgYnkgYGN1dGAsIGNhbGN1bGF0aW5nIHRoZSBhdmVyYWdlIHByaWNlIGZvciBlYWNoIGN1dCBxdWFsaXR5LiBGaWxsIGluIHRoZSBibGFua3MgdG8gY3JlYXRlIGEgaG9yaXpvbnRhbCBiYXIgY2hhcnQgd2l0aCBkaXJlY3QgbGFiZWxzLiBSZW1lbWJlcjogYGdlb21fY29sKClgIGlzIGZvciBwcmUtY29tcHV0ZWQgdmFsdWVzLCBgZ2VvbV9iYXIoKWAgaXMgZm9yIGNvdW50aW5nLg0KDQo6Ojogey50ZW1wbGF0ZS1jb2RlfQ0KKipUZW1wbGF0ZSAtLSBmaWxsIGluIHRoZSBgX19fYCBibGFua3M6KioNCg0KYGBgcg0KZGlhbW9uZHMgJT4lDQogIGdyb3VwX2J5KF9fXykgJT4lDQogIHN1bW1hcml6ZShhdmdfcHJpY2UgPSBtZWFuKHByaWNlKSkgJT4lDQogIG11dGF0ZShjdXQgPSBmY3RfcmVvcmRlcihjdXQsIF9fXykpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSBhdmdfcHJpY2UsIHkgPSBfX18pKSArDQogIGdlb21fY29sKGZpbGwgPSAiX19fIikgKw0KICBnZW9tX3RleHQoYWVzKGxhYmVsID0gcm91bmQoYXZnX3ByaWNlLCAwKSksIGhqdXN0ID0gLTAuMiwgc2l6ZSA9IDMuNSkgKw0KICBzY2FsZV94X2NvbnRpbnVvdXMobGFiZWxzID0gc2NhbGVzOjpkb2xsYXJfZm9ybWF0KCkpICsNCiAgbGFicygNCiAgICB0aXRsZSA9ICJfX18iLA0KICAgIHN1YnRpdGxlID0gIkF2ZXJhZ2UgcHJpY2UgYnkgY3V0IHF1YWxpdHkiLA0KICAgIHggPSAiQXZlcmFnZSBQcmljZSAoVVNEKSIsDQogICAgeSA9IE5VTEwNCiAgKSArDQogIGV4cGFuZF9saW1pdHMoeCA9IF9fXykgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDEzKQ0KYGBgDQo6OjoNCg0KQWZ0ZXIgY29tcGxldGluZyB0aGUgdGVtcGxhdGUsIGFuc3dlcjogd2hpY2ggY3V0IGhhcyB0aGUgaGlnaGVzdCBhdmVyYWdlIHByaWNlPyBJcyB0aGlzIHdoYXQgeW91IGV4cGVjdGVkPyBXaHkgb3Igd2h5IG5vdD8gKEhpbnQ6IHRoaW5rIGFib3V0IHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBjdXQgcXVhbGl0eSBhbmQgY2FyYXQgc2l6ZSBpbiB0aGUgZGlhbW9uZHMgZGF0YXNldC4pDQoNCioqRXhlcmNpc2UgMzogRmFjZXRlZCBFeHBsb3JhdGlvbioqDQoNCkluc3RhbGwgdGhlIGBwYWxtZXJwZW5ndWluc2AgcGFja2FnZSAoYGluc3RhbGwucGFja2FnZXMoInBhbG1lcnBlbmd1aW5zIilgKSBhbmQgY3JlYXRlIGEgZmFjZXRlZCBzY2F0dGVycGxvdC4gRmlsbCBpbiB0aGUgYmxhbmtzIGJlbG93Lg0KDQo6Ojogey50ZW1wbGF0ZS1jb2RlfQ0KKipUZW1wbGF0ZSAtLSBmaWxsIGluIHRoZSBgX19fYCBibGFua3M6KioNCg0KYGBgcg0KbGlicmFyeShwYWxtZXJwZW5ndWlucykNCg0KcGVuZ3VpbnMgJT4lDQogIGZpbHRlcighaXMubmEoc2V4KSkgJT4lDQogIGdncGxvdChhZXMoeCA9IGJpbGxfbGVuZ3RoX21tLCB5ID0gX19fLCBjb2xvciA9IF9fXykpICsNCiAgZ2VvbV9wb2ludChhbHBoYSA9IDAuNiwgc2l6ZSA9IDIpICsNCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gIl9fXyIsIHNlID0gRkFMU0UpICsNCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoImZlbWFsZSIgPSAiI0M0MUUzQSIsICJtYWxlIiA9ICIjMDAyOTY3IikpICsNCiAgZmFjZXRfd3JhcCh+X19fLCBuY29sID0gMykgKw0KICBsYWJzKA0KICAgIHRpdGxlID0gIlBlbmd1aW4gQmlsbCBEaW1lbnNpb25zIGJ5IFNwZWNpZXMgYW5kIFNleCIsDQogICAgeCA9ICJCaWxsIExlbmd0aCAobW0pIiwNCiAgICB5ID0gIl9fXyIsDQogICAgY29sb3IgPSAiU2V4Ig0KICApICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMikNCmBgYA0KOjo6DQoNCldyaXRlIDItLTMgc2VudGVuY2VzIGludGVycHJldGluZyB3aGF0IHRoZSBmYWNldGVkIHZpZXcgcmV2ZWFscy4gSG93IGRvIGJpbGwgZGltZW5zaW9ucyBkaWZmZXIgYWNyb3NzIHNwZWNpZXM/IERvZXMgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGJpbGwgbGVuZ3RoIGFuZCBiaWxsIGRlcHRoIGNoYW5nZSBieSBzcGVjaWVzPw0KDQoqKkV4ZXJjaXNlIDQ6IFRoZW1lIEN1c3RvbWl6YXRpb24gYW5kIHBhdGNod29yayoqDQoNCkNyZWF0ZSB0d28gcGxvdHMgb2YgdGhlIGBtcGdgIGRhdGFzZXQgLS0gYSBzY2F0dGVycGxvdCBhbmQgYSBib3hwbG90IC0tIGFuZCBjb21iaW5lIHRoZW0gc2lkZSBieSBzaWRlIHVzaW5nIGBwYXRjaHdvcmtgLiBGaWxsIGluIHRoZSBibGFua3MgYmVsb3cuIFRoZW4gd3JpdGUgYSBjdXN0b20gYHRoZW1lX2dvbnphZ2EoKWAgZnVuY3Rpb24gYW5kIGFwcGx5IGl0IHRvIGJvdGggcGxvdHMuDQoNCjo6OiB7LnRlbXBsYXRlLWNvZGV9DQoqKlRlbXBsYXRlIC0tIGZpbGwgaW4gdGhlIGBfX19gIGJsYW5rczoqKg0KDQpgYGByDQpsaWJyYXJ5KHBhdGNod29yaykNCg0KIyBEZWZpbmUgdGhlIGN1c3RvbSB0aGVtZQ0KdGhlbWVfZ29uemFnYSA8LSBmdW5jdGlvbihiYXNlX3NpemUgPSAxMykgew0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IGJhc2Vfc2l6ZSkgJStyZXBsYWNlJQ0KICAgIHRoZW1lKA0KICAgICAgcGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChmYWNlID0gIl9fXyIsIGNvbG9yID0gIiMwMDI5NjciLCBzaXplID0gYmFzZV9zaXplICsgMyksDQogICAgICBwbG90LnN1YnRpdGxlID0gZWxlbWVudF90ZXh0KGNvbG9yID0gIiM2NjY2NjYiKSwNCiAgICAgIGF4aXMudGl0bGUgPSBlbGVtZW50X3RleHQoY29sb3IgPSAiX19fIiksDQogICAgICBwYW5lbC5ncmlkLm1pbm9yID0gZWxlbWVudF9ibGFuaygpLA0KICAgICAgbGVnZW5kLnBvc2l0aW9uID0gIl9fXyINCiAgICApDQp9DQoNCiMgUGxvdCAxOiBzY2F0dGVycGxvdA0KcDEgPC0gZ2dwbG90KG1wZywgYWVzKHggPSBkaXNwbCwgeSA9IGh3eSkpICsNCiAgZ2VvbV9wb2ludChjb2xvciA9ICIjMDAyOTY3IiwgYWxwaGEgPSAwLjYpICsNCiAgbGFicyh0aXRsZSA9ICJFbmdpbmUgU2l6ZSB2cy4gTVBHIiwgeCA9ICJEaXNwbGFjZW1lbnQgKEwpIiwgeSA9ICJIaWdod2F5IE1QRyIpICsNCiAgdGhlbWVfZ29uemFnYSgpDQoNCiMgUGxvdCAyOiBib3hwbG90DQpwMiA8LSBnZ3Bsb3QobXBnLCBhZXMoeCA9IF9fXywgeSA9IGh3eSkpICsNCiAgZ2VvbV9ib3hwbG90KGZpbGwgPSAiI2VmZjZmZiIsIGNvbG9yID0gIiMwMDI5NjciKSArDQogIGxhYnModGl0bGUgPSAiTVBHIGJ5IERyaXZlIFR5cGUiLCB4ID0gIkRyaXZlIFR5cGUiLCB5ID0gIkhpZ2h3YXkgTVBHIikgKw0KICB0aGVtZV9nb256YWdhKCkNCg0KcDEgKyBwMiArDQogIHBsb3RfYW5ub3RhdGlvbigNCiAgICB0aXRsZSA9ICJfX18iLA0KICAgIHRoZW1lID0gdGhlbWUocGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChmYWNlID0gImJvbGQiLCBzaXplID0gMTUpKQ0KICApDQpgYGANCjo6Og0KDQoqKkV4ZXJjaXNlIDU6IENvbXBsZXRlIFZpc3VhbGl6YXRpb24gZnJvbSBTY3JhdGNoKioNCg0KVXNpbmcgYW55IGJ1aWx0LWluIGRhdGFzZXQgKGBtcGdgLCBgZGlhbW9uZHNgLCBgZWNvbm9taWNzYCwgb3IgYG10Y2Fyc2ApLCBidWlsZCBhIHBvbGlzaGVkIHZpc3VhbGl6YXRpb24gZW50aXJlbHkgZnJvbSBzY3JhdGNoIC0tIG5vIHRlbXBsYXRlLiBZb3VyIHBsb3QgbXVzdCBpbmNsdWRlIGF0IGxlYXN0IGZpdmUgb2YgdGhlIHNldmVuIGdyYW1tYXIgb2YgZ3JhcGhpY3MgbGF5ZXJzOg0KDQoxLiBEYXRhDQoyLiBBZXN0aGV0aWNzIChhdCBsZWFzdCB0d28gbWFwcGVkIHZhcmlhYmxlcykNCjMuIEdlb21ldHJ5ICh5b3VyIGNob2ljZSkNCjQuIEZhY2V0aW5nIE9SIGEgc2Vjb25kIGdlb21ldHJ5IGxheWVyDQo1LiBMYWJlbHMgKHRpdGxlLCBzdWJ0aXRsZSwgYXhpcyBsYWJlbHMpDQo2LiBBIGN1c3RvbWl6ZWQgc2NhbGUgKGNvbG9yLCBheGlzIGZvcm1hdHRpbmcsIG9yIGJvdGgpDQo3LiBBIGN1c3RvbWl6ZWQgdGhlbWUgKG1vZGlmeSBhdCBsZWFzdCB0d28gYHRoZW1lKClgIGVsZW1lbnRzKQ0KDQpTYXZlIHlvdXIgZmluYWwgcGxvdCB1c2luZyBgZ2dzYXZlKClgIGF0IDMwMCBkcGksIDggaW5jaGVzIHdpZGUgYW5kIDUgaW5jaGVzIHRhbGwuIEluIGEgZmV3IHNlbnRlbmNlcyBiZWxvdyB5b3VyIGNvZGUsIGV4cGxhaW4gd2hhdCBzdG9yeSB5b3VyIHZpc3VhbGl6YXRpb24gdGVsbHMgYW5kIHdoaWNoIGRlc2lnbiBjaG9pY2VzIHlvdSBtYWRlIHRvIHN1cHBvcnQgdGhhdCBzdG9yeS4NCg0KOjo6DQo6OjoNCg0KLS0tDQoNCiMjIEF0dHJpYnV0aW9ucw0KDQpUaGlzIGNvdXJzZSBtYXRlcmlhbCBkcmF3cyBvbiBhbmQgaXMgaW5zcGlyZWQgYnkgdGhlIHdvcmsgb2YgbWFueSBzY2hvbGFycyBhbmQgcHJhY3RpdGlvbmVyczoNCg0KLSAqKldpbGtpbnNvbiwgTC4qKiAtLSAqVGhlIEdyYW1tYXIgb2YgR3JhcGhpY3MqIChTcHJpbmdlciwgMTk5OTsgMm5kIGVkLiAyMDA1KS4gVGhlIGZvdW5kYXRpb25hbCB0aGVvcmV0aWNhbCBmcmFtZXdvcmsgZm9yIHN5c3RlbWF0aWMgdmlzdWFsaXphdGlvbiBjb25zdHJ1Y3Rpb24uDQotICoqV2lja2hhbSwgSC4qKiAtLSAqZ2dwbG90MjogRWxlZ2FudCBHcmFwaGljcyBmb3IgRGF0YSBBbmFseXNpcyogKFNwcmluZ2VyLCAzcmQgZWQuKS4gVGhlIGRlZmluaXRpdmUgZ3VpZGUgdG8gdGhlIFIgaW1wbGVtZW50YXRpb24gb2YgdGhlIGdyYW1tYXIgb2YgZ3JhcGhpY3MuDQotICoqV2lja2hhbSwgSC4qKiAoMjAxMCkuICJBIExheWVyZWQgR3JhbW1hciBvZiBHcmFwaGljcy4iICpKb3VybmFsIG9mIENvbXB1dGF0aW9uYWwgYW5kIEdyYXBoaWNhbCBTdGF0aXN0aWNzKiwgMTkoMSksIDMtLTI4LiBUaGUgYWNhZGVtaWMgcGFwZXIgZGVzY3JpYmluZyBnZ3Bsb3QyJ3MgZGVzaWduIHBoaWxvc29waHkuDQotICoqVHVmdGUsIEUuUi4qKiAtLSAqVGhlIFZpc3VhbCBEaXNwbGF5IG9mIFF1YW50aXRhdGl2ZSBJbmZvcm1hdGlvbiogKEdyYXBoaWNzIFByZXNzLCAxOTgzLCAyMDAxKS4gRm91bmRhdGlvbmFsIGRlc2lnbiBwcmluY2lwbGVzIGluY2x1ZGluZyB0aGUgZGF0YS1pbmsgcmF0aW8gYW5kIGxpZSBmYWN0b3IuDQotICoqVml2ZWsgSC4gUGF0aWwqKiAtLSBmb3VuZGF0aW9uYWwgY291cnNlIGRlc2lnbiBhbmQgbWF0ZXJpYWxzIGZvciBkYXRhIHZpc3VhbGl6YXRpb24gYXQgR29uemFnYSBVbml2ZXJzaXR5Lg0KDQo8ZGl2IGNsYXNzPSJwYWdlLW5hdiI+DQo8YSBocmVmPSJ3ZWVrMDIuaHRtbCI+JmxhcnI7IFdlZWsgMjogVmlzdWFsIFBlcmNlcHRpb248L2E+DQo8YSBocmVmPSJ3ZWVrMDQuaHRtbCI+V2VlayA0OiBDaGFydCBUeXBlcyAmcmFycjs8L2E+DQo8L2Rpdj4NCg==</div>
<footer style="background:#002967; color:rgba(255,255,255,.75); padding:2.5rem 0 1.5rem; margin-top:3rem;">
<div class="container-fluid" style="max-width:1100px; margin:0 auto; padding:0 2rem;">
  <div class="row">
    <div class="col-md-5">
      <h5 style="color:#fff; font-size:.95rem;">Data Visualization &mdash; Gonzaga University</h5>
      <p style="font-size:.85rem;">School of Business Administration. A course in the Jesuit tradition of intellectual rigor, ethical inquiry, and service to the common good.</p>
    </div>
    <div class="col-md-2">
      <h5 style="color:#fff; font-size:.95rem;">References</h5>
      <ul style="list-style:none; padding:0; font-size:.85rem;">
        <li><a href="https://clauswilke.com/dataviz/" target="_blank" style="color:rgba(255,255,255,.7);">Wilke Textbook</a></li>
        <li><a href="https://socviz.co/" target="_blank" style="color:rgba(255,255,255,.7);">Healy Textbook</a></li>
        <li><a href="https://ggplot2-book.org/" target="_blank" style="color:rgba(255,255,255,.7);">ggplot2 Book</a></li>
      </ul>
    </div>
    <div class="col-md-2">
      <h5 style="color:#fff; font-size:.95rem;">Tools</h5>
      <ul style="list-style:none; padding:0; font-size:.85rem;">
        <li><a href="https://www.r-project.org/" target="_blank" style="color:rgba(255,255,255,.7);">Download R</a></li>
        <li><a href="https://posit.co/downloads/" target="_blank" style="color:rgba(255,255,255,.7);">RStudio</a></li>
        <li><a href="https://www.tidyverse.org/" target="_blank" style="color:rgba(255,255,255,.7);">Tidyverse</a></li>
      </ul>
    </div>
    <div class="col-md-3">
      <h5 style="color:#fff; font-size:.95rem;">Instructor</h5>
      <p style="font-size:.85rem;">Dr. Vivek H. Patil<br>
      <a href="mailto:patil@gonzaga.edu" style="color:rgba(255,255,255,.7);">patil@gonzaga.edu</a><br>
      <a href="http://patilv.com" target="_blank" style="color:rgba(255,255,255,.7);">patilv.com</a></p>
    </div>
  </div>
  <hr style="border-color:rgba(255,255,255,.15); margin:1.5rem 0 1rem;">
  <p style="font-size:.78rem; text-align:center; margin:0;">&copy; Gonzaga University School of Business. Course materials by Dr. Vivek H. Patil. <em>Ad Majorem Dei Gloriam.</em></p>
</div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("week03.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
