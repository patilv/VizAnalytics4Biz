<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Week 5: Data Wrangling Essentials</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visual Analytics & Data Storytelling with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Weeks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="week01.html">Week 1: Introduction to Data Viz &amp; R</a>
    </li>
    <li>
      <a href="week02.html">Week 2: Visual Perception &amp; Design</a>
    </li>
    <li>
      <a href="week03.html">Week 3: Grammar of Graphics &amp; ggplot2</a>
    </li>
    <li>
      <a href="week04.html">Week 4: Chart Types &amp; Variations</a>
    </li>
    <li>
      <a href="week05.html">Week 5: Data Wrangling Essentials</a>
    </li>
    <li>
      <a href="week06.html">Week 6: Interactive Visualizations</a>
    </li>
    <li>
      <a href="week07.html">Week 7: Geographic Visualization</a>
    </li>
    <li>
      <a href="week08.html">Week 8: Capstone ‚Äî Viz in Practice</a>
    </li>
  </ul>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/patilv/VizAnalytics4Biz">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Week 5: Data Wrangling Essentials</h1>

</div>


<div class="hero-banner">
<div class="week-badge">
5
</div>
<h1>
Data Wrangling Essentials
</h1>
<p>
Tidy data, the pipe operator, and the core dplyr verbs you need for
every visualization
</p>
</div>
<div id="learning-objectives" class="section level2 objectives">
<h2>Learning Objectives</h2>
<p>By the end of this week, you will be able to:</p>
<ul>
<li>Define tidy data and explain why it matters for ggplot2</li>
<li>Use the pipe operator <code>%&gt;%</code> to chain operations into
readable pipelines</li>
<li>Apply the six core dplyr verbs: <code>filter()</code>,
<code>select()</code>, <code>mutate()</code>, <code>summarise()</code>,
<code>group_by()</code>, and <code>arrange()</code></li>
<li>Reshape wide data to long format with
<code>pivot_longer()</code></li>
<li>Use <code>fct_reorder()</code> to control the order of categories in
your charts</li>
<li>Build a complete wrangle-then-plot pipeline from start to
finish</li>
</ul>
</div>
<div class="callout-info">
<p><strong>A note about this week.</strong> This is the most technical
week of the course. Data wrangling is the bridge between having data and
being able to visualize it. If you have never written code that
transforms data before, this week may feel challenging ‚Äì and that is
completely normal. Go slowly, run every code chunk one at a time, and
focus on understanding what each step does before moving to the next.
You do not need to memorize every function. You need to understand the
<em>pattern</em> so you can look things up when you need them.</p>
</div>
<div class="callout-tip">
<p><strong>Pre-Wrangled Data in Weeks 6‚Äì8</strong></p>
<p>If data wrangling feels overwhelming this week, here is the most
important thing to know: <strong>Weeks 6, 7, and 8 will provide
pre-wrangled datasets</strong> ready for visualization. You will not
need to wrangle raw data from scratch to complete those assignments.</p>
<p>This week teaches you the foundations so you <em>understand</em> what
is happening when data gets transformed. But struggling here will
<strong>not</strong> cascade into failure on later weeks. Keep going, do
your best, and know that the safety net is in place.</p>
</div>
<div id="tidy-data" class="section level2">
<h2>1. Tidy Data</h2>
<p>The single most important concept this week is <strong>tidy
data</strong>. The term comes from Hadley Wickham‚Äôs influential 2014
paper in the <em>Journal of Statistical Software</em>, and it provides
the foundation for everything we do in the tidyverse.</p>
<p>Tidy data follows three simple rules:</p>
<ol style="list-style-type: decimal">
<li><strong>Each variable forms a column</strong></li>
<li><strong>Each observation forms a row</strong></li>
<li><strong>Each type of observational unit forms a table</strong></li>
</ol>
<p>These rules sound straightforward, but most data you encounter in the
real world violates at least one of them. Spreadsheets designed for
human reading often spread variables across column headers, merge cells
for visual clarity, or mix multiple observational units in a single
table.</p>
<div id="why-does-this-matter-for-ggplot2" class="section level3">
<h3>Why Does This Matter for ggplot2?</h3>
<p>Remember from Week 4 that ggplot2 maps <strong>variables</strong> to
<strong>aesthetics</strong>. If your variable is spread across multiple
columns (like <code>2020</code>, <code>2021</code>, <code>2022</code> as
separate columns), you cannot map it to a single aesthetic like
<code>x = year</code>. Tidy data makes the mapping from data to visual
properties direct and explicit.</p>
<p>Here is a concrete example. Look at this ‚Äúmessy‚Äù (wide-format)
population data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Messy (wide) data ‚Äî years are spread across columns</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>messy <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">country =</span> <span class="fu">c</span>(<span class="st">&quot;USA&quot;</span>, <span class="st">&quot;Canada&quot;</span>, <span class="st">&quot;Mexico&quot;</span>),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="st">`</span><span class="at">2020</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">331</span>, <span class="dv">38</span>, <span class="dv">129</span>),</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">2021</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">332</span>, <span class="dv">38</span>, <span class="dv">130</span>),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="st">`</span><span class="at">2022</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">333</span>, <span class="dv">39</span>, <span class="dv">131</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>messy</span></code></pre></div>
<pre><code>## # A tibble: 3 √ó 4
##   country `2020` `2021` `2022`
##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 USA        331    332    333
## 2 Canada      38     38     39
## 3 Mexico     129    130    131</code></pre>
<p>This looks fine to a human eye. But try mapping it to ggplot2 ‚Äì what
would you put on the x-axis? There is no <code>year</code> column. The
years are trapped inside column <em>names</em>, not inside column
<em>values</em>.</p>
<p>Now let us tidy it:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Tidy (long) data ‚Äî each row is one country-year observation</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>tidy <span class="ot">&lt;-</span> messy <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">2020</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2022</span><span class="st">`</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;population_millions&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>tidy</span></code></pre></div>
<pre><code>## # A tibble: 9 √ó 3
##   country year  population_millions
##   &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt;
## 1 USA     2020                  331
## 2 USA     2021                  332
## 3 USA     2022                  333
## 4 Canada  2020                   38
## 5 Canada  2021                   38
## 6 Canada  2022                   39
## 7 Mexico  2020                  129
## 8 Mexico  2021                  130
## 9 Mexico  2022                  131</code></pre>
<p>The messy data had 3 rows and 4 columns. The tidy data has 9 rows and
3 columns. Every combination of country and year is its own row, and
<code>year</code> and <code>population_millions</code> are proper
columns we can map to aesthetics.</p>
<p>Now we can plot it directly:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>tidy <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> population_millions, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;USA&quot;</span> <span class="ot">=</span> <span class="st">&quot;#002967&quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                                <span class="st">&quot;Canada&quot;</span> <span class="ot">=</span> <span class="st">&quot;#C41E3A&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                                <span class="st">&quot;Mexico&quot;</span> <span class="ot">=</span> <span class="st">&quot;#B4975A&quot;</span>)) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Population Growth (2020\u20132022)&quot;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Population (millions)&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week05_files/figure-html/w5-tidy-plot-1.png" alt="" width="768" /></p>
<div class="callout-tip">
<p><strong>Rule of thumb:</strong> If you want to map something to
color, fill, or facet but the categories are stuck in column
<em>names</em> rather than in a column of their own, you need
<code>pivot_longer()</code>.</p>
</div>
</div>
</div>
<div id="the-pipe-operator" class="section level2">
<h2>2. The Pipe Operator <code>%&gt;%</code></h2>
<p>The pipe operator <code>%&gt;%</code> is the connective tissue of
tidyverse code. Read it as <strong>‚Äúand then.‚Äù</strong> It takes the
output of the expression on its left and passes it as the <strong>first
argument</strong> to the function on its right.</p>
<p>Without the pipe, code reads <em>inside-out</em>. With the pipe, code
reads <em>top-to-bottom</em> like a recipe:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Without pipe: nested, hard to read ‚Äî you must read inside-out</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">arrange</span>(<span class="fu">summarise</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(mpg, year <span class="sc">==</span> <span class="dv">2008</span>), class), <span class="at">avg =</span> <span class="fu">mean</span>(hwy)), <span class="fu">desc</span>(avg))</span></code></pre></div>
<pre><code>## # A tibble: 7 √ó 2
##   class        avg
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 compact     28.7
## 2 midsize     28.0
## 3 subcompact  27.1
## 4 2seater     25  
## 5 minivan     22.2
## 6 suv         18.6
## 7 pickup      16.9</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># With pipe: clear, readable ‚Äî you read top to bottom</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(hwy), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg))</span></code></pre></div>
<pre><code>## # A tibble: 7 √ó 2
##   class        avg
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 compact     28.7
## 2 midsize     28.0
## 3 subcompact  27.1
## 4 2seater     25  
## 5 minivan     22.2
## 6 suv         18.6
## 7 pickup      16.9</code></pre>
<p>Both produce the exact same result. But the piped version tells a
story: <em>start with mpg, then filter to 2008, then group by class,
then calculate the average highway mpg, then arrange from highest to
lowest.</em></p>
<p>Think of it like giving directions:</p>
<ul>
<li><strong>Without pipe:</strong> ‚ÄúGo to the end of the street that is
two blocks after the left turn you make after exiting the highway at
exit 4.‚Äù</li>
<li><strong>With pipe:</strong> ‚ÄúTake exit 4. Turn left. Go two blocks.
It is at the end of the street.‚Äù</li>
</ul>
<p>Same destination. Very different readability.</p>
<div class="callout-info">
<p><strong>Base R pipe <code>|&gt;</code> vs.¬†magrittr pipe
<code>%&gt;%</code>:</strong> R 4.1+ introduced a native pipe operator
<code>|&gt;</code>. It works similarly for most use cases. In this
course we use <code>%&gt;%</code> because it is what you will encounter
in most existing tidyverse code and tutorials. Both are fine. If you see
<code>|&gt;</code> in online examples, know that it does essentially the
same thing.</p>
</div>
</div>
<div id="the-dplyr-verbs" class="section level2 tabset">
<h2 class="tabset">3. The dplyr Verbs</h2>
<p>The dplyr package provides a small set of <strong>verbs</strong> ‚Äì
functions that each do one thing well. Think of them as the building
blocks of data transformation. When you chain them together with pipes,
you can express sophisticated data transformations in clear, readable
code.</p>
<p>There are six verbs you need to know. Each one operates on a data
frame and returns a new data frame.</p>
<table>
<colgroup>
<col width="15%" />
<col width="35%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Verb</th>
<th align="left">What it does</th>
<th align="left">Think of it as‚Ä¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>filter()</code></td>
<td align="left">Keeps rows that match a condition</td>
<td align="left">‚ÄúShow me only the rows where‚Ä¶‚Äù</td>
</tr>
<tr class="even">
<td align="left"><code>select()</code></td>
<td align="left">Keeps (or removes) specific columns</td>
<td align="left">‚ÄúI only need these columns‚Ä¶‚Äù</td>
</tr>
<tr class="odd">
<td align="left"><code>mutate()</code></td>
<td align="left">Creates new columns or modifies existing ones</td>
<td align="left">‚ÄúCalculate a new variable‚Ä¶‚Äù</td>
</tr>
<tr class="even">
<td align="left"><code>summarise()</code></td>
<td align="left">Collapses many rows into a summary</td>
<td align="left">‚ÄúGive me the average/count/max‚Ä¶‚Äù</td>
</tr>
<tr class="odd">
<td align="left"><code>group_by()</code></td>
<td align="left">Sets up groups for summarise</td>
<td align="left">‚ÄúDo this separately for each‚Ä¶‚Äù</td>
</tr>
<tr class="even">
<td align="left"><code>arrange()</code></td>
<td align="left">Sorts rows</td>
<td align="left">‚ÄúPut these in order by‚Ä¶‚Äù</td>
</tr>
</tbody>
</table>
<div id="filter" class="section level3">
<h3>filter()</h3>
<p><code>filter()</code> selects <strong>rows</strong> based on
conditions. Only rows where the condition evaluates to <code>TRUE</code>
are kept. Everything else is removed.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Keep only Toyota vehicles from 2008</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">filter</span>(manufacturer <span class="sc">==</span> <span class="st">&quot;toyota&quot;</span>, year <span class="sc">==</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">select</span>(model, year, cty, hwy)</span></code></pre></div>
<pre><code>## # A tibble: 14 √ó 4
##    model                   year   cty   hwy
##    &lt;chr&gt;                  &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 4runner 4wd             2008    16    20
##  2 4runner 4wd             2008    14    17
##  3 camry                   2008    21    31
##  4 camry                   2008    21    31
##  5 camry                   2008    19    28
##  6 camry solara            2008    21    31
##  7 camry solara            2008    22    31
##  8 camry solara            2008    18    27
##  9 corolla                 2008    28    37
## 10 corolla                 2008    26    35
## 11 land cruiser wagon 4wd  2008    13    18
## 12 toyota tacoma 4wd       2008    17    22
## 13 toyota tacoma 4wd       2008    15    18
## 14 toyota tacoma 4wd       2008    16    20</code></pre>
<p>Notice two things: we use <code>==</code> (double equals) to test for
equality, not <code>=</code> (single equals). And when we list multiple
conditions separated by commas, it means ‚ÄúAND‚Äù ‚Äì both conditions must be
true.</p>
<p>Here are the most common operators you will use inside
<code>filter()</code>:</p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Meaning</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>==</code></td>
<td align="left">equals</td>
<td align="left"><code>filter(year == 2008)</code></td>
</tr>
<tr class="even">
<td align="left"><code>!=</code></td>
<td align="left">not equal</td>
<td align="left"><code>filter(class != "suv")</code></td>
</tr>
<tr class="odd">
<td align="left"><code>&gt;</code>, <code>&lt;</code>,
<code>&gt;=</code>, <code>&lt;=</code></td>
<td align="left">comparisons</td>
<td align="left"><code>filter(hwy &gt; 30)</code></td>
</tr>
<tr class="even">
<td align="left"><code>%in%</code></td>
<td align="left">value is in a set</td>
<td align="left"><code>filter(class %in% c("suv", "pickup"))</code></td>
</tr>
<tr class="odd">
<td align="left"><code>&amp;</code></td>
<td align="left">and</td>
<td
align="left"><code>filter(year == 2008 &amp; hwy &gt; 25)</code></td>
</tr>
<tr class="even">
<td align="left"><code>|</code></td>
<td align="left">or</td>
<td
align="left"><code>filter(class == "suv" | class == "pickup")</code></td>
</tr>
<tr class="odd">
<td align="left"><code>is.na()</code></td>
<td align="left">is missing</td>
<td align="left"><code>filter(is.na(hwy))</code></td>
</tr>
<tr class="even">
<td align="left"><code>!is.na()</code></td>
<td align="left">is not missing</td>
<td align="left"><code>filter(!is.na(hwy))</code></td>
</tr>
</tbody>
</table>
</div>
<div id="select" class="section level3">
<h3>select()</h3>
<p><code>select()</code> chooses <strong>columns</strong>. It is your
tool for narrowing a wide dataset down to just the variables you need.
This makes your data easier to work with and your output easier to
read.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Keep only specific columns</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">select</span>(manufacturer, model, year, hwy, cty) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## # A tibble: 8 √ó 5
##   manufacturer model       year   hwy   cty
##   &lt;chr&gt;        &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1 audi         a4          1999    29    18
## 2 audi         a4          1999    29    21
## 3 audi         a4          2008    31    20
## 4 audi         a4          2008    30    21
## 5 audi         a4          1999    26    16
## 6 audi         a4          1999    26    18
## 7 audi         a4          2008    27    18
## 8 audi         a4 quattro  1999    26    18</code></pre>
<p>You can also use helper functions inside <code>select()</code>:</p>
<ul>
<li><code>starts_with("h")</code> ‚Äì all columns whose names start with
‚Äúh‚Äù</li>
<li><code>ends_with("y")</code> ‚Äì all columns whose names end with
‚Äúy‚Äù</li>
<li><code>contains("mpg")</code> ‚Äì all columns whose names contain
‚Äúmpg‚Äù</li>
<li><code>-column_name</code> ‚Äì remove a column (keep everything
else)</li>
</ul>
</div>
<div id="mutate" class="section level3">
<h3>mutate()</h3>
<p><code>mutate()</code> creates <strong>new columns</strong> or
modifies existing ones. The original columns are preserved; new columns
are appended to the right side of the data frame.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Calculate average MPG and estimated annual fuel cost</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="at">avg_mpg =</span> (cty <span class="sc">+</span> hwy) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="at">fuel_cost_annual =</span> (<span class="dv">15000</span> <span class="sc">/</span> avg_mpg) <span class="sc">*</span> <span class="fl">3.50</span>  <span class="co"># 15k miles at $3.50/gal</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">select</span>(manufacturer, model, avg_mpg, fuel_cost_annual) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## # A tibble: 8 √ó 4
##   manufacturer model      avg_mpg fuel_cost_annual
##   &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;            &lt;dbl&gt;
## 1 audi         a4            23.5            2234.
## 2 audi         a4            25              2100 
## 3 audi         a4            25.5            2059.
## 4 audi         a4            25.5            2059.
## 5 audi         a4            21              2500 
## 6 audi         a4            22              2386.
## 7 audi         a4            22.5            2333.
## 8 audi         a4 quattro    22              2386.</code></pre>
<p>Think of <code>mutate()</code> as adding a new column to a
spreadsheet where the value in each cell is calculated from other
columns in the same row.</p>
</div>
<div id="summarise-group_by" class="section level3">
<h3>summarise() + group_by()</h3>
<p><code>summarise()</code> (you can also spell it
<code>summarize()</code>) collapses many rows into summary statistics.
On its own, it gives you a single-row summary of the entire dataset. But
when you pair it with <code>group_by()</code>, it computes summaries
<strong>within each group</strong>.</p>
<p>First, let us see <code>summarise()</code> without grouping:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># One summary for the entire dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy),</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="at">max_hwy =</span> <span class="fu">max</span>(hwy),</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="at">total_cars =</span> <span class="fu">n</span>()</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 √ó 3
##   avg_hwy max_hwy total_cars
##     &lt;dbl&gt;   &lt;int&gt;      &lt;int&gt;
## 1    23.4      44        234</code></pre>
<p>Now with <code>group_by()</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Summary statistics by vehicle class</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    <span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy),</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="at">best_hwy =</span> <span class="fu">max</span>(hwy),</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_hwy))</span></code></pre></div>
<pre><code>## # A tibble: 7 √ó 4
##   class          n avg_hwy best_hwy
##   &lt;chr&gt;      &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;
## 1 compact       47    28.3       44
## 2 subcompact    35    28.1       44
## 3 midsize       41    27.3       32
## 4 2seater        5    24.8       26
## 5 minivan       11    22.4       24
## 6 suv           62    18.1       27
## 7 pickup        33    16.9       22</code></pre>
<p>Notice the <code>.groups = "drop"</code> argument. This tells R to
remove the grouping after summarizing, which prevents surprising
behavior in downstream operations. Always include it.</p>
<p>Common summary functions you can use inside
<code>summarise()</code>:</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">What it calculates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>mean(x)</code></td>
<td align="left">Average</td>
</tr>
<tr class="even">
<td align="left"><code>median(x)</code></td>
<td align="left">Median</td>
</tr>
<tr class="odd">
<td align="left"><code>sd(x)</code></td>
<td align="left">Standard deviation</td>
</tr>
<tr class="even">
<td align="left"><code>min(x)</code>, <code>max(x)</code></td>
<td align="left">Minimum, maximum</td>
</tr>
<tr class="odd">
<td align="left"><code>n()</code></td>
<td align="left">Count of rows</td>
</tr>
<tr class="even">
<td align="left"><code>sum(x)</code></td>
<td align="left">Total</td>
</tr>
</tbody>
</table>
</div>
<div id="arrange" class="section level3">
<h3>arrange()</h3>
<p><code>arrange()</code> sorts rows. By default it sorts in ascending
order (smallest to largest). Wrap a column in <code>desc()</code> to
sort in descending order (largest to smallest).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Rank manufacturers by average highway MPG (best to worst)</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_hwy))</span></code></pre></div>
<pre><code>## # A tibble: 15 √ó 2
##    manufacturer avg_hwy
##    &lt;chr&gt;          &lt;dbl&gt;
##  1 honda           32.6
##  2 volkswagen      29.2
##  3 hyundai         26.9
##  4 audi            26.4
##  5 pontiac         26.4
##  6 subaru          25.6
##  7 toyota          24.9
##  8 nissan          24.6
##  9 chevrolet       21.9
## 10 ford            19.4
## 11 mercury         18  
## 12 dodge           17.9
## 13 jeep            17.6
## 14 lincoln         17  
## 15 land rover      16.5</code></pre>
</div>
</div>
<div id="section" class="section level2 unnumbered">
<h2 class="unnumbered"></h2>
</div>
<div id="common-errors-and-how-to-fix-them"
class="section level2 callout-error">
<h2>Common Errors and How to Fix Them</h2>
<p>When you are working through this week‚Äôs code, you will almost
certainly encounter some of these errors. <strong>This is
normal.</strong> Here is a quick reference for diagnosing and fixing
them.</p>
<p><strong>‚ÄúError: object ‚Äòhwy‚Äô not found‚Äù</strong></p>
<p>Inside dplyr verbs, use <strong>bare column names</strong> (no
quotes): <code>filter(hwy &gt; 30)</code>, not
<code>filter("hwy" &gt; 30)</code>.</p>
<p><strong>‚ÄúError in filter(): ! object ‚Äòmpg‚Äô not found‚Äù</strong></p>
<p>Did you load the tidyverse? You need to run
<code>library(tidyverse)</code> at the top of your script before using
any dplyr functions or built-in datasets like <code>mpg</code>.</p>
<p><strong>‚ÄúError: unexpected PIPE‚Äù</strong></p>
<p>The <code>%&gt;%</code> pipe must go at the <strong>end</strong> of a
line, not the start of the next line.</p>
<pre><code># WRONG ‚Äî pipe at the start of a line
mpg
  %&gt;% filter(year == 2008)

# RIGHT ‚Äî pipe at the end of a line
mpg %&gt;%
  filter(year == 2008)</code></pre>
<p><strong>‚Äú.groups argument‚Äù warning</strong></p>
<p>This is a warning, not an error ‚Äì your code still runs. But to
silence it and avoid unexpected behavior, add
<code>.groups = "drop"</code> inside <code>summarise()</code>:</p>
<pre><code>summarise(avg = mean(hwy), .groups = &quot;drop&quot;)</code></pre>
<p><strong>‚ÄúColumn <code>___</code> doesn‚Äôt exist‚Äù</strong></p>
<p>Check your spelling. <strong>R is case-sensitive.</strong>
<code>Hwy</code> is not the same as <code>hwy</code>. Use
<code>names(mpg)</code> or <code>glimpse(mpg)</code> to see the exact
column names.</p>
<p><strong>pivot_longer() does not seem to work</strong></p>
<p>Make sure <code>cols =</code> specifies which columns to pivot. If
your column names start with numbers (like <code>2020</code>), you must
wrap them in backticks:</p>
<pre><code>pivot_longer(cols = `2020`:`2022`,
             names_to = &quot;year&quot;,
             values_to = &quot;value&quot;)</code></pre>
</div>
<div id="try-it-dplyr-pipeline-builder" class="section level2">
<h2>Try It: dplyr Pipeline Builder</h2>
<p>You have just learned the six core dplyr verbs. Now build a data
transformation pipeline interactively. The sandbox below lets you toggle
each verb on and off to see how the data changes at each step ‚Äî no need
to write code.</p>
<div class="sandbox-section">
<div class="sandbox-header">
<p><span class="sandbox-icon">üß™</span> dplyr Pipeline Builder ‚Äî
Transform Data Step by Step</p>
</div>
<iframe class="sandbox-frame" src="https://analytics.gonzaga.edu/week05-pipeline/" height="600" loading="lazy" allowfullscreen>
</iframe>
<div class="sandbox-cold-start">
<p>If the app takes a few seconds to load on first visit, that is normal
‚Äî the server is waking up.</p>
</div>
</div>
<div class="try-it-box">
<p><strong>Exploration Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Start with no pipeline steps enabled. Look at the raw data ‚Äî how
many rows and columns are there?</li>
<li>Enable <strong>filter</strong> ‚Äî how many rows remain? What
criterion was applied?</li>
<li>Add <strong>select</strong> ‚Äî which columns were kept? Why might you
drop the others?</li>
<li>Toggle on <strong>mutate</strong> ‚Äî what new column was created?
Examine how it was calculated.</li>
<li>Finally, add <strong>arrange</strong> ‚Äî does sorting reveal any
patterns you did not notice before?</li>
</ol>
</div>
<div class="callout-info">
<p><strong>What You Should Have Noticed:</strong> Each verb does one
specific thing, and the pipe (<code>%&gt;%</code>) chains them together
into a readable, step-by-step transformation. The order matters ‚Äî
filtering before grouping produces different results than grouping
before filtering. Building pipelines incrementally (one verb at a time)
helps you catch errors early.</p>
</div>
<div class="callout-ai">
<p><strong>AI &amp; This Concept</strong> When asking AI to wrangle
data, describe your pipeline step by step: ‚ÄúFilter to rows where year
&gt; 2000, then group by country, then compute mean GDP per capita.‚Äù AI
tools produce much cleaner dplyr code when you break the transformation
into explicit steps rather than asking for the end result all at
once.</p>
</div>
</div>
<div id="reshaping-with-pivot_longer" class="section level2">
<h2>4. Reshaping with pivot_longer()</h2>
<p>Most data you download from the internet comes in <strong>wide
format</strong> ‚Äì designed for human reading, with categories spread
across column headers. But ggplot2 needs <strong>long format</strong> ‚Äì
one row per observation, with categories in their own column.</p>
<p><code>pivot_longer()</code> converts wide data to long data. It has
three key arguments:</p>
<table>
<colgroup>
<col width="35%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Purpose</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>cols</code></td>
<td align="left">Which columns to pivot</td>
<td align="left"><code>cols = c(City, Highway)</code> or
<code>cols =</code>2020<code>:</code>2022`<code>| |</code>names_to<code>| Name for the new column that will hold the old column names |</code>names_to
=
‚Äútype‚Äù<code>| |</code>values_to<code>| Name for the new column that will hold the values |</code>values_to
= ‚Äúmpg‚Äù`</td>
</tr>
</tbody>
</table>
<p>Let us walk through a complete example. We want to compare city and
highway fuel economy by vehicle class, shown side by side in a grouped
bar chart. To get two bars per class (one for city, one for highway), we
need a column that says ‚ÄúCity‚Äù or ‚ÄúHighway‚Äù ‚Äì which means we need to
pivot.</p>
<p><strong>Step 1: Summarise the data</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Calculate average city and highway MPG by class</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>mpg_summary <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    <span class="at">City =</span> <span class="fu">mean</span>(cty),</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    <span class="at">Highway =</span> <span class="fu">mean</span>(hwy),</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  )</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>mpg_summary</span></code></pre></div>
<pre><code>## # A tibble: 7 √ó 3
##   class       City Highway
##   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
## 1 2seater     15.4    24.8
## 2 compact     20.1    28.3
## 3 midsize     18.8    27.3
## 4 minivan     15.8    22.4
## 5 pickup      13      16.9
## 6 subcompact  20.4    28.1
## 7 suv         13.5    18.1</code></pre>
<p>Notice that <code>City</code> and <code>Highway</code> are separate
columns. We cannot map both to a single y-axis in ggplot2 while also
coloring by type.</p>
<p><strong>Step 2: Pivot to long format</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Pivot so that &quot;City&quot; and &quot;Highway&quot; become values in a new column</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>mpg_long <span class="ot">&lt;-</span> mpg_summary <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(City, Highway),</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;type&quot;</span>,</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;mpg&quot;</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  )</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>mpg_long</span></code></pre></div>
<pre><code>## # A tibble: 14 √ó 3
##    class      type      mpg
##    &lt;chr&gt;      &lt;chr&gt;   &lt;dbl&gt;
##  1 2seater    City     15.4
##  2 2seater    Highway  24.8
##  3 compact    City     20.1
##  4 compact    Highway  28.3
##  5 midsize    City     18.8
##  6 midsize    Highway  27.3
##  7 minivan    City     15.8
##  8 minivan    Highway  22.4
##  9 pickup     City     13  
## 10 pickup     Highway  16.9
## 11 subcompact City     20.4
## 12 subcompact Highway  28.1
## 13 suv        City     13.5
## 14 suv        Highway  18.1</code></pre>
<p>Now we have a <code>type</code> column with values ‚ÄúCity‚Äù and
‚ÄúHighway‚Äù and an <code>mpg</code> column with the corresponding values.
This is tidy data: each row is one class-type combination.</p>
<p><strong>Step 3: Plot</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(class, mpg), <span class="at">y =</span> mpg, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;City&quot;</span> <span class="ot">=</span> <span class="st">&quot;#C41E3A&quot;</span>, <span class="st">&quot;Highway&quot;</span> <span class="ot">=</span> <span class="st">&quot;#002967&quot;</span>)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average City vs. Highway MPG by Vehicle Class&quot;</span>,</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">&quot;Miles Per Gallon&quot;</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week05_files/figure-html/w5-pivot-step3-1.png" alt="" width="768" /></p>
<div class="callout-warning">
<p><strong>Common pitfall:</strong> Forgetting to pivot before plotting.
If you try to map both <code>cty</code> and <code>hwy</code> to the
y-axis in a single ggplot call, you will run into trouble. The tidy
approach is always: <strong>pivot first, then map</strong> the new
category column to <code>fill</code> or <code>color</code>.</p>
</div>
</div>
<div id="try-it-tidy-data-transformer" class="section level2">
<h2>Try It: Tidy Data Transformer</h2>
<p>You have just seen how <code>pivot_longer()</code> reshapes wide data
into tidy (long) format. Now try it interactively. The sandbox below
shows messy (wide) data on the left and the tidy (long) result on the
right ‚Äî color-coded so you can see exactly which columns become which
rows.</p>
<div class="sandbox-section">
<div class="sandbox-header">
<p><span class="sandbox-icon">üß™</span> Tidy Data Transformer ‚Äî See
pivot_longer() in Action</p>
</div>
<iframe class="sandbox-frame" src="https://analytics.gonzaga.edu/week05-tidydata/" height="650" loading="lazy" allowfullscreen>
</iframe>
<div class="sandbox-cold-start">
<p>If the app takes a few seconds to load on first visit, that is normal
‚Äî the server is waking up.</p>
</div>
</div>
<div class="try-it-box">
<p><strong>Exploration Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Start with the <strong>Quarterly Sales</strong> dataset. How many
rows and columns does the wide table have? How many does the tidy table
have? Why did the number of rows increase?</li>
<li>Change the <strong>names_to</strong> label from ‚Äúquarter‚Äù to
‚Äútime_period‚Äù ‚Äî watch how the generated R code and the tidy table column
header update in real time.</li>
<li><strong>Uncheck one column</strong> (e.g., Q4) from the pivot
controls. How does the tidy table change? How many rows
disappeared?</li>
<li>Switch to the <strong>City Temperatures</strong> dataset. Notice how
the default <code>names_to</code> and <code>values_to</code> labels
change to match the context. Why is ‚Äúmonth‚Äù a better column name than
‚Äúquarter‚Äù for this dataset?</li>
</ol>
</div>
<div class="callout-info">
<p><strong>What You Should Have Noticed:</strong> Pivoting is a
mechanical operation ‚Äî each selected column in the wide data generates
one new row per existing row in the tidy data. The color bands make this
mapping visible: a blue column in the wide table becomes blue-tinted
rows in the long table. The <code>names_to</code> column stores the old
column <em>names</em>, and the <code>values_to</code> column stores the
old column <em>values</em>. Understanding this mapping is the key to
knowing when and how to use <code>pivot_longer()</code>.</p>
</div>
<div class="callout-ai">
<p><strong>AI &amp; This Concept</strong> When asking AI to reshape
data, describe what the wide and long versions should look like: ‚ÄúI have
columns Q1, Q2, Q3, Q4 and I want a single ‚Äòquarter‚Äô column with a
‚Äòrevenue‚Äô column for the values.‚Äù Giving AI a concrete before-and-after
description produces much more reliable <code>pivot_longer()</code> code
than vague requests like ‚Äúmake my data tidy.‚Äù</p>
</div>
</div>
<div id="controlling-chart-order-with-forcats" class="section level2">
<h2>5. Controlling Chart Order with forcats</h2>
<p>By default, ggplot2 orders categorical axes
<strong>alphabetically</strong>. This is almost never what you want. A
bar chart ordered alphabetically makes it hard to compare values because
the bars have no meaningful progression.</p>
<p>The <strong>forcats</strong> package (part of the tidyverse ‚Äì it
loads automatically with <code>library(tidyverse)</code>) gives you
functions to reorder factor levels. The three most useful for
visualization:</p>
<table>
<colgroup>
<col width="25%" />
<col width="35%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">What it does</th>
<th align="left">When to use it</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>fct_reorder(category, value)</code></td>
<td align="left">Reorder by another variable</td>
<td align="left">Bar charts sorted by value</td>
</tr>
<tr class="even">
<td align="left"><code>fct_infreq(category)</code></td>
<td align="left">Order by frequency</td>
<td align="left">Bar charts of counts</td>
</tr>
<tr class="odd">
<td align="left"><code>fct_lump_n(category, n)</code></td>
<td align="left">Keep top n, lump rest into ‚ÄúOther‚Äù</td>
<td align="left">Too many categories</td>
</tr>
</tbody>
</table>
<p>The one you will use most often is <code>fct_reorder()</code>. Here
is the difference it makes:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># WITHOUT fct_reorder ‚Äî alphabetical order (hard to compare)</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_hwy, <span class="at">y =</span> manufacturer)) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Alphabetical Order (Default) -- Hard to Read&quot;</span>,</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Average Highway MPG&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="week05_files/figure-html/w5-fct-unsorted-1.png" alt="" width="768" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># WITH fct_reorder ‚Äî sorted by value (easy to compare)</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(hwy), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">manufacturer =</span> <span class="fu">fct_reorder</span>(manufacturer, avg_hwy)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_hwy, <span class="at">y =</span> manufacturer)) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#002967&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sorted by Value -- Much Easier to Read&quot;</span>,</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Average Highway MPG&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="week05_files/figure-html/w5-fct-sorted-1.png" alt="" width="768" /></p>
<p>The only difference between the two charts is one line:
<code>mutate(manufacturer = fct_reorder(manufacturer, avg_hwy))</code>.
That single line transforms the chart from confusing to clear.
<strong>Always sort your bar charts by value</strong> unless there is a
natural ordering (like months or rankings) that takes priority.</p>
<div class="callout-tip">
<p><strong><code>fct_reorder()</code> is your best friend for bar
charts.</strong> The pattern is always the same:
<code>fct_reorder(category_column, numeric_column)</code>. This reorders
the categories so that they appear in order of the numeric value. It
works with horizontal bars (<code>y = fct_reorder(...)</code>) and
vertical bars (<code>x = fct_reorder(...)</code>).</p>
</div>
</div>
<div id="a-brief-note-on-string-cleaning" class="section level2">
<h2>6. A Brief Note on String Cleaning</h2>
<p>Real-world data often has messy text: inconsistent capitalization,
extra whitespace, typos. The <strong>stringr</strong> package (part of
the tidyverse) provides functions for cleaning strings. All stringr
functions start with <code>str_</code> for easy discovery.</p>
<p>You do not need to master stringr this week, but here are the three
functions you are most likely to need:</p>
<table>
<colgroup>
<col width="30%" />
<col width="42%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">What it does</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>str_trim()</code></td>
<td align="left">Removes leading/trailing spaces</td>
<td align="left"><code>"  hello  "</code> becomes
<code>"hello"</code></td>
</tr>
<tr class="even">
<td align="left"><code>str_to_lower()</code></td>
<td align="left">Converts to lowercase</td>
<td align="left"><code>"HELLO"</code> becomes <code>"hello"</code></td>
</tr>
<tr class="odd">
<td align="left"><code>str_to_title()</code></td>
<td align="left">Converts to title case</td>
<td align="left"><code>"hello world"</code> becomes
<code>"Hello World"</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Quick example: cleaning messy name data</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>messy_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;  John Smith  &quot;</span>, <span class="st">&quot;JANE DOE&quot;</span>, <span class="st">&quot;bob jones&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  <span class="at">original =</span> messy_names,</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  <span class="at">cleaned =</span> messy_names <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span> <span class="fu">str_to_title</span>()</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 √ó 2
##   original         cleaned   
##   &lt;chr&gt;            &lt;chr&gt;     
## 1 &quot;  John Smith  &quot; John Smith
## 2 &quot;JANE DOE&quot;       Jane Doe  
## 3 &quot;bob jones&quot;      Bob Jones</code></pre>
<p>If you need more string manipulation in a future project, the <em>R
for Data Science</em> chapter on strings is an excellent reference: <a
href="https://r4ds.hadley.nz/strings">https://r4ds.hadley.nz/strings</a>.</p>
</div>
<div id="putting-it-all-together-a-complete-pipeline"
class="section level2">
<h2>7. Putting It All Together: A Complete Pipeline</h2>
<p>This is the section where everything connects. We will build a
complete pipeline step by step, showing the output after each operation
so you can see exactly what each verb does to the data.</p>
<p>Our goal: Create a polished visualization of U.S. unemployment trends
from 2000 to 2015, starting from the raw <code>economics</code> dataset
built into ggplot2.</p>
<p><strong>Step 1: Look at the raw data</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># What does the raw data look like?</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>economics <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 √ó 6
##   date         pce    pop psavert uempmed unemploy
##   &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 1967-07-01  507. 198712    12.6     4.5     2944
## 2 1967-08-01  510. 198911    12.6     4.7     2945
## 3 1967-09-01  516. 199113    11.9     4.6     2958
## 4 1967-10-01  512. 199311    12.9     4.9     3143
## 5 1967-11-01  517. 199498    12.8     4.7     3066</code></pre>
<p>The <code>economics</code> dataset has columns for date, population
(<code>pop</code>), unemployment count (<code>unemploy</code>), and
others. But it does not have an unemployment <em>rate</em>. We need to
compute that.</p>
<p><strong>Step 2: Select the columns we need</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Narrow down to just the columns we need</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>economics <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="fu">select</span>(date, unemploy, pop) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 √ó 3
##   date       unemploy    pop
##   &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt;
## 1 1967-07-01     2944 198712
## 2 1967-08-01     2945 198911
## 3 1967-09-01     2958 199113
## 4 1967-10-01     3143 199311
## 5 1967-11-01     3066 199498</code></pre>
<p>We only need <code>date</code>, <code>unemploy</code> (number of
unemployed persons, in thousands), and <code>pop</code> (total
population, in thousands). Everything else is clutter.</p>
<p><strong>Step 3: Create the unemployment rate</strong></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Compute unemployment rate as a percentage</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>economics <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  <span class="fu">select</span>(date, unemploy, pop) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unemploy_rate =</span> unemploy <span class="sc">/</span> pop <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 √ó 4
##   date       unemploy    pop unemploy_rate
##   &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
## 1 1967-07-01     2944 198712          1.48
## 2 1967-08-01     2945 198911          1.48
## 3 1967-09-01     2958 199113          1.49
## 4 1967-10-01     3143 199311          1.58
## 5 1967-11-01     3066 199498          1.54</code></pre>
<p>Now we have an <code>unemploy_rate</code> column that we can plot on
the y-axis.</p>
<p><strong>Step 4: Filter to our time period</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Keep only rows from 2000 onward</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>economics <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">select</span>(date, unemploy, pop) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unemploy_rate =</span> unemploy <span class="sc">/</span> pop <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="st">&quot;2000-01-01&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 √ó 4
##   date       unemploy    pop unemploy_rate
##   &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
## 1 2000-01-01     5708 280976          2.03
## 2 2000-02-01     5858 281190          2.08
## 3 2000-03-01     5733 281409          2.04
## 4 2000-04-01     5481 281653          1.95
## 5 2000-05-01     5758 281877          2.04</code></pre>
<p>We filter to January 2000 and later because we want to focus on the
modern era, including the 2008 financial crisis.</p>
<p><strong>Step 5: Save and plot</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Store the wrangled data, then plot it</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>economics_clean <span class="ot">&lt;-</span> economics <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  <span class="fu">select</span>(date, unemploy, pop) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unemploy_rate =</span> unemploy <span class="sc">/</span> pop <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="st">&quot;2000-01-01&quot;</span>)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="fu">ggplot</span>(economics_clean, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy_rate)) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2008-09-15&quot;</span>),</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#C41E3A&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2009-06-01&quot;</span>), <span class="at">y =</span> <span class="fl">6.5</span>,</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Financial</span><span class="sc">\n</span><span class="st">Crisis&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#C41E3A&quot;</span>,</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>           <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;U.S. Unemployment Rate (2000\u20132015)&quot;</span>,</span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Pipeline: select \u2192 mutate \u2192 filter \u2192 plot&quot;</span>,</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">&quot;Unemployment Rate (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="week05_files/figure-html/w5-pipeline-step5-1.png" alt="" width="960" /></p>
<p>Here is the pattern laid bare:</p>
<ol style="list-style-type: decimal">
<li><strong><code>select()</code></strong> narrows down to the columns
we need</li>
<li><strong><code>mutate()</code></strong> computes the unemployment
<em>rate</em> from raw counts</li>
<li><strong><code>filter()</code></strong> restricts to the time period
of interest</li>
<li><strong><code>ggplot()</code></strong> maps the wrangled data to
visual form</li>
</ol>
<p>This is the pattern you will use again and again: <strong>wrangle
first, then plot.</strong></p>
<div class="callout-info">
<p><strong>Why separate the wrangling from the plotting?</strong>
Keeping them in distinct steps (even if you could combine them) makes
your code easier to debug. If the plot looks wrong, you can inspect the
intermediate data frame (<code>economics_clean</code>) to see whether
the problem is in the wrangling or the visualization. Debug one thing at
a time.</p>
</div>
</div>
<div id="ignatian-reflection-data-as-human-stories"
class="section level2 callout-ignatian">
<h2>Ignatian Reflection: Data as Human Stories</h2>
<p>Data wrangling is not merely a technical exercise. It is an
<strong>act of care</strong>. Behind every row in a dataset is a person,
a community, a lived experience. When we clean data, we make choices ‚Äì
what to keep, what to discard, what to transform. These choices shape
the stories the data can tell.</p>
<p>The Jesuit principle of <strong>Cura Personalis</strong> ‚Äì care for
the whole person ‚Äì extends to how we handle data. Cleaning data
respectfully means:</p>
<ul>
<li><strong>Not erasing outliers</strong> without understanding who they
represent</li>
<li><strong>Preserving context</strong> rather than reducing people to
numbers</li>
<li><strong>Questioning categories</strong> that may reflect bias or
oversimplification</li>
</ul>
<p><strong>Discernment</strong> ‚Äì a core Ignatian practice ‚Äì applies
directly to wrangling. When you filter rows, you decide whose stories
are told. When you group and summarise, you decide what patterns are
highlighted. Approach these decisions with the same thoughtfulness and
ethical awareness that Ignatian spirituality calls us to bring to all
our work.</p>
<p>Ask yourself: <em>Who is included in this dataset? Who is excluded?
What assumptions am I making when I clean and reshape this
data?</em></p>
</div>
<div id="quick-reference" class="section level2">
<h2>8. Quick Reference</h2>
<p>Here is a one-page summary of everything covered this week. Bookmark
this section for when you are working on assignments.</p>
<p><strong>The six dplyr verbs:</strong></p>
<pre><code>data %&gt;%
  filter(condition)        # keep rows where condition is TRUE
  select(col1, col2)       # keep only these columns
  mutate(new = expr)       # create a new column
  group_by(category)       # set up groups
  summarise(stat = fn(x))  # collapse to summary statistics
  arrange(desc(column))    # sort rows</code></pre>
<p><strong>Pivoting:</strong></p>
<pre><code>wide_data %&gt;%
  pivot_longer(cols = columns_to_pivot,
               names_to = &quot;new_category_column&quot;,
               values_to = &quot;new_value_column&quot;)</code></pre>
<p><strong>Reordering for plots:</strong></p>
<pre><code>mutate(category = fct_reorder(category, numeric_value))</code></pre>
<p><strong>The full pattern:</strong></p>
<pre><code>data %&gt;%
  # wrangle
  filter(...) %&gt;%
  mutate(...) %&gt;%
  group_by(...) %&gt;%
  summarise(..., .groups = &quot;drop&quot;) %&gt;%
  # plot
  ggplot(aes(...)) +
  geom_...() +
  labs(...) +
  theme_minimal()</code></pre>
<div class="callout-info">
<p><strong>For future reference:</strong> Two advanced dplyr features
you may encounter in online code examples are <code>across()</code>
(which applies a function to multiple columns at once) and the
<code>.by</code> argument (a modern alternative to
<code>group_by()</code> that automatically ungroups the result). You do
not need these for this course, but they are useful to recognize if you
see them.</p>
</div>
<hr />
</div>
<div id="challenge-pipe-dream" class="section level2">
<h2>Challenge: Pipe Dream</h2>
<div class="sandbox-section">
<div class="sandbox-header">
<p><span class="sandbox-icon">üéÆ</span> Pipe Dream ‚Äî Get the verbs in
order or the pipeline breaks</p>
</div>
<iframe class="sandbox-frame" src="https://analytics.gonzaga.edu/week05-game/" height="700" loading="lazy" allowfullscreen>
</iframe>
<div class="sandbox-cold-start">
<p>If the app takes a few seconds to load on first visit, that is normal
‚Äî the server is waking up.</p>
</div>
</div>
<div class="try-it-box">
<p><strong>How to Play:</strong></p>
<ol style="list-style-type: decimal">
<li>Enter your name and click <strong>Start Game</strong></li>
<li>Each round describes a data wrangling goal in plain English</li>
<li>Drag dplyr verb cards into the correct pipeline order, then predict
the resulting rows and columns</li>
<li>Complete all 8 rounds, then copy your completion report into the
Canvas assignment</li>
</ol>
</div>
<hr />
</div>
<div id="exercises" class="section level2">
<h2>9. Exercises</h2>
<div class="exercise-block">
<div class="exercise-header">
<p>Exercise 1: Storm Analysis with dplyr</p>
</div>
<div class="exercise-body">
<p>Using the <code>storms</code> dataset (built into dplyr), complete
the following pipeline. Fill in each blank (<code>___</code>) to make
the code work.</p>
<p><strong>Your task:</strong> Find the top 10 strongest hurricanes
(Category 4 and above) and create a lollipop chart showing their maximum
wind speeds.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>storms <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>  <span class="fu">filter</span>(___ <span class="sc">&gt;=</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">max_wind =</span> <span class="fu">max</span>(___), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="fu">slice_max</span>(max_wind, <span class="at">n =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_reorder</span>(name, max_wind)) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> max_wind, <span class="at">y =</span> name)) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> max_wind, <span class="at">y =</span> name, <span class="at">yend =</span> name),</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;#B4975A&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;#002967&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top 10 Strongest Hurricanes (Category 4+)&quot;</span>,</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Maximum Wind Speed (knots)&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><strong>Hints:</strong></p>
<ul>
<li>The column for hurricane category is called
<code>category</code></li>
<li>Group by <code>name</code> to get one row per storm</li>
<li>Use <code>max(wind)</code> to find the highest wind speed per
storm</li>
<li><code>slice_max()</code> keeps the top n rows by a given column</li>
</ul>
</div>
</div>
<div class="exercise-block">
<div class="exercise-header">
<p>Exercise 2: Pivoting Practice</p>
</div>
<div class="exercise-body">
<p>The <code>table4a</code> dataset (built into tidyr) stores TB case
counts in wide format, with years as column names. Your job: pivot it to
tidy format and create a line chart.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Step 1: Look at the data</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>table4a</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="co"># Step 2: Pivot and plot</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>table4a <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">___</span><span class="st">`</span>, <span class="st">`</span><span class="at">___</span><span class="st">`</span>),</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;___&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Afghanistan&quot;</span> <span class="ot">=</span> <span class="st">&quot;#002967&quot;</span>,</span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>                                <span class="st">&quot;Brazil&quot;</span> <span class="ot">=</span> <span class="st">&quot;#C41E3A&quot;</span>,</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>                                <span class="st">&quot;China&quot;</span> <span class="ot">=</span> <span class="st">&quot;#B4975A&quot;</span>)) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;TB Cases by Country&quot;</span>,</span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Cases&quot;</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><strong>Hints:</strong></p>
<ul>
<li><code>table4a</code> has columns named <code>1999</code> and
<code>2000</code> ‚Äì since they start with numbers, wrap them in
backticks</li>
<li><code>names_to</code> should be <code>"year"</code> and
<code>values_to</code> should be <code>"cases"</code></li>
<li>In the ggplot aesthetics, map <code>x = year</code>,
<code>y = cases</code>, <code>color = country</code></li>
</ul>
</div>
</div>
<div class="exercise-block">
<div class="exercise-header">
<p>Exercise 3: Complete dplyr Pipeline</p>
</div>
<div class="exercise-body">
<p>Build a complete pipeline that filters, summarises, reorders, and
plots the <code>mpg</code> dataset.</p>
<p><strong>Your task:</strong> Create a horizontal bar chart showing the
average highway MPG for each manufacturer, using only 2008 vehicles,
sorted from highest to lowest.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_hwy =</span> <span class="fu">mean</span>(___), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">manufacturer =</span> <span class="fu">fct_reorder</span>(___, ___)) <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;___&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Highway MPG by Manufacturer (2008 Models)&quot;</span>,</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Highway MPG&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><strong>Hints:</strong></p>
<ul>
<li>Filter <code>year == 2008</code></li>
<li>Group by <code>manufacturer</code></li>
<li><code>mean(hwy)</code> gives you the average highway MPG</li>
<li><code>fct_reorder(manufacturer, avg_hwy)</code> reorders
manufacturers by their average</li>
<li>Map <code>x = avg_hwy</code> and <code>y = manufacturer</code> for a
horizontal bar chart</li>
<li>Gonzaga navy is <code>"#002967"</code></li>
</ul>
</div>
</div>
<div class="exercise-block">
<div class="exercise-header">
<p>Exercise 4: Reading and Reflection</p>
</div>
<div class="exercise-body">
<p>Read <strong>Chapter 4: Data Transformation</strong> from <em>R for
Data Science</em> (2nd edition) by Hadley Wickham, Mine
Cetinkaya-Rundel, and Garrett Grolemund:</p>
<p><a
href="https://r4ds.hadley.nz/data-transform">https://r4ds.hadley.nz/data-transform</a></p>
<p>As you read, pay attention to:</p>
<ul>
<li>The five key dplyr verbs and how they relate to what we covered this
week</li>
<li>The <code>|&gt;</code> (base R) pipe vs.¬†the <code>%&gt;%</code>
(magrittr) pipe ‚Äì how are they similar and different?</li>
<li>Any functions or patterns that were new to you</li>
</ul>
<p><strong>Write a short reflection (3‚Äì5 sentences)</strong> on one new
thing you learned from the chapter that you did not already know from
this week‚Äôs materials.</p>
</div>
</div>
</div>
<div id="attributions" class="section level2">
<h2>10. Attributions</h2>
<ul>
<li>Wickham, H. (2014). ‚ÄúTidy Data.‚Äù <em>Journal of Statistical
Software</em>, 59(10). <a
href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a></li>
<li>Wickham, H., Cetinkaya-Rundel, M., &amp; Grolemund, G. ‚Äì <em>R for
Data Science</em> (2nd ed.). <a
href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a></li>
<li>Vivek H. Patil ‚Äì foundational course materials</li>
<li>Gonzaga University ‚Äì Ignatian pedagogical framework</li>
</ul>
<div class="page-nav">
<p><a href="week04.html">‚Üê Week 4</a> <a href="week06.html">Week 6
‚Üí</a></p>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIldlZWsgNTogRGF0YSBXcmFuZ2xpbmcgRXNzZW50aWFscyINCm91dHB1dDoNCiAgaHRtbF9kb2N1bWVudDoNCiAgICB0b2M6IHRydWUNCiAgICB0b2NfZmxvYXQ6IHRydWUNCi0tLQ0KDQo8ZGl2IGNsYXNzPSJoZXJvLWJhbm5lciI+DQo8ZGl2IGNsYXNzPSJ3ZWVrLWJhZGdlIj41PC9kaXY+DQo8aDE+RGF0YSBXcmFuZ2xpbmcgRXNzZW50aWFsczwvaDE+DQo8cD5UaWR5IGRhdGEsIHRoZSBwaXBlIG9wZXJhdG9yLCBhbmQgdGhlIGNvcmUgZHBseXIgdmVyYnMgeW91IG5lZWQgZm9yIGV2ZXJ5IHZpc3VhbGl6YXRpb248L3A+DQo8L2Rpdj4NCg0KOjo6IHsub2JqZWN0aXZlc30NCiMjIExlYXJuaW5nIE9iamVjdGl2ZXMNCg0KQnkgdGhlIGVuZCBvZiB0aGlzIHdlZWssIHlvdSB3aWxsIGJlIGFibGUgdG86DQoNCi0gRGVmaW5lIHRpZHkgZGF0YSBhbmQgZXhwbGFpbiB3aHkgaXQgbWF0dGVycyBmb3IgZ2dwbG90Mg0KLSBVc2UgdGhlIHBpcGUgb3BlcmF0b3IgYCU+JWAgdG8gY2hhaW4gb3BlcmF0aW9ucyBpbnRvIHJlYWRhYmxlIHBpcGVsaW5lcw0KLSBBcHBseSB0aGUgc2l4IGNvcmUgZHBseXIgdmVyYnM6IGBmaWx0ZXIoKWAsIGBzZWxlY3QoKWAsIGBtdXRhdGUoKWAsIGBzdW1tYXJpc2UoKWAsIGBncm91cF9ieSgpYCwgYW5kIGBhcnJhbmdlKClgDQotIFJlc2hhcGUgd2lkZSBkYXRhIHRvIGxvbmcgZm9ybWF0IHdpdGggYHBpdm90X2xvbmdlcigpYA0KLSBVc2UgYGZjdF9yZW9yZGVyKClgIHRvIGNvbnRyb2wgdGhlIG9yZGVyIG9mIGNhdGVnb3JpZXMgaW4geW91ciBjaGFydHMNCi0gQnVpbGQgYSBjb21wbGV0ZSB3cmFuZ2xlLXRoZW4tcGxvdCBwaXBlbGluZSBmcm9tIHN0YXJ0IHRvIGZpbmlzaA0KOjo6DQoNCjo6OiB7LmNhbGxvdXQtaW5mb30NCioqQSBub3RlIGFib3V0IHRoaXMgd2Vlay4qKiBUaGlzIGlzIHRoZSBtb3N0IHRlY2huaWNhbCB3ZWVrIG9mIHRoZSBjb3Vyc2UuIERhdGEgd3JhbmdsaW5nIGlzIHRoZSBicmlkZ2UgYmV0d2VlbiBoYXZpbmcgZGF0YSBhbmQgYmVpbmcgYWJsZSB0byB2aXN1YWxpemUgaXQuIElmIHlvdSBoYXZlIG5ldmVyIHdyaXR0ZW4gY29kZSB0aGF0IHRyYW5zZm9ybXMgZGF0YSBiZWZvcmUsIHRoaXMgd2VlayBtYXkgZmVlbCBjaGFsbGVuZ2luZyAtLSBhbmQgdGhhdCBpcyBjb21wbGV0ZWx5IG5vcm1hbC4gR28gc2xvd2x5LCBydW4gZXZlcnkgY29kZSBjaHVuayBvbmUgYXQgYSB0aW1lLCBhbmQgZm9jdXMgb24gdW5kZXJzdGFuZGluZyB3aGF0IGVhY2ggc3RlcCBkb2VzIGJlZm9yZSBtb3ZpbmcgdG8gdGhlIG5leHQuIFlvdSBkbyBub3QgbmVlZCB0byBtZW1vcml6ZSBldmVyeSBmdW5jdGlvbi4gWW91IG5lZWQgdG8gdW5kZXJzdGFuZCB0aGUgKnBhdHRlcm4qIHNvIHlvdSBjYW4gbG9vayB0aGluZ3MgdXAgd2hlbiB5b3UgbmVlZCB0aGVtLg0KOjo6DQoNCjo6OiB7LmNhbGxvdXQtdGlwfQ0KKipQcmUtV3JhbmdsZWQgRGF0YSBpbiBXZWVrcyA2LS04KioNCg0KSWYgZGF0YSB3cmFuZ2xpbmcgZmVlbHMgb3ZlcndoZWxtaW5nIHRoaXMgd2VlaywgaGVyZSBpcyB0aGUgbW9zdCBpbXBvcnRhbnQgdGhpbmcgdG8ga25vdzogKipXZWVrcyA2LCA3LCBhbmQgOCB3aWxsIHByb3ZpZGUgcHJlLXdyYW5nbGVkIGRhdGFzZXRzKiogcmVhZHkgZm9yIHZpc3VhbGl6YXRpb24uIFlvdSB3aWxsIG5vdCBuZWVkIHRvIHdyYW5nbGUgcmF3IGRhdGEgZnJvbSBzY3JhdGNoIHRvIGNvbXBsZXRlIHRob3NlIGFzc2lnbm1lbnRzLg0KDQpUaGlzIHdlZWsgdGVhY2hlcyB5b3UgdGhlIGZvdW5kYXRpb25zIHNvIHlvdSAqdW5kZXJzdGFuZCogd2hhdCBpcyBoYXBwZW5pbmcgd2hlbiBkYXRhIGdldHMgdHJhbnNmb3JtZWQuIEJ1dCBzdHJ1Z2dsaW5nIGhlcmUgd2lsbCAqKm5vdCoqIGNhc2NhZGUgaW50byBmYWlsdXJlIG9uIGxhdGVyIHdlZWtzLiBLZWVwIGdvaW5nLCBkbyB5b3VyIGJlc3QsIGFuZCBrbm93IHRoYXQgdGhlIHNhZmV0eSBuZXQgaXMgaW4gcGxhY2UuDQo6OjoNCg0KIyMgMS4gVGlkeSBEYXRhDQoNClRoZSBzaW5nbGUgbW9zdCBpbXBvcnRhbnQgY29uY2VwdCB0aGlzIHdlZWsgaXMgKip0aWR5IGRhdGEqKi4gVGhlIHRlcm0gY29tZXMgZnJvbSBIYWRsZXkgV2lja2hhbSdzIGluZmx1ZW50aWFsIDIwMTQgcGFwZXIgaW4gdGhlICpKb3VybmFsIG9mIFN0YXRpc3RpY2FsIFNvZnR3YXJlKiwgYW5kIGl0IHByb3ZpZGVzIHRoZSBmb3VuZGF0aW9uIGZvciBldmVyeXRoaW5nIHdlIGRvIGluIHRoZSB0aWR5dmVyc2UuDQoNClRpZHkgZGF0YSBmb2xsb3dzIHRocmVlIHNpbXBsZSBydWxlczoNCg0KMS4gKipFYWNoIHZhcmlhYmxlIGZvcm1zIGEgY29sdW1uKioNCjIuICoqRWFjaCBvYnNlcnZhdGlvbiBmb3JtcyBhIHJvdyoqDQozLiAqKkVhY2ggdHlwZSBvZiBvYnNlcnZhdGlvbmFsIHVuaXQgZm9ybXMgYSB0YWJsZSoqDQoNClRoZXNlIHJ1bGVzIHNvdW5kIHN0cmFpZ2h0Zm9yd2FyZCwgYnV0IG1vc3QgZGF0YSB5b3UgZW5jb3VudGVyIGluIHRoZSByZWFsIHdvcmxkIHZpb2xhdGVzIGF0IGxlYXN0IG9uZSBvZiB0aGVtLiBTcHJlYWRzaGVldHMgZGVzaWduZWQgZm9yIGh1bWFuIHJlYWRpbmcgb2Z0ZW4gc3ByZWFkIHZhcmlhYmxlcyBhY3Jvc3MgY29sdW1uIGhlYWRlcnMsIG1lcmdlIGNlbGxzIGZvciB2aXN1YWwgY2xhcml0eSwgb3IgbWl4IG11bHRpcGxlIG9ic2VydmF0aW9uYWwgdW5pdHMgaW4gYSBzaW5nbGUgdGFibGUuDQoNCiMjIyBXaHkgRG9lcyBUaGlzIE1hdHRlciBmb3IgZ2dwbG90Mj8NCg0KUmVtZW1iZXIgZnJvbSBXZWVrIDQgdGhhdCBnZ3Bsb3QyIG1hcHMgKip2YXJpYWJsZXMqKiB0byAqKmFlc3RoZXRpY3MqKi4gSWYgeW91ciB2YXJpYWJsZSBpcyBzcHJlYWQgYWNyb3NzIG11bHRpcGxlIGNvbHVtbnMgKGxpa2UgYDIwMjBgLCBgMjAyMWAsIGAyMDIyYCBhcyBzZXBhcmF0ZSBjb2x1bW5zKSwgeW91IGNhbm5vdCBtYXAgaXQgdG8gYSBzaW5nbGUgYWVzdGhldGljIGxpa2UgYHggPSB5ZWFyYC4gVGlkeSBkYXRhIG1ha2VzIHRoZSBtYXBwaW5nIGZyb20gZGF0YSB0byB2aXN1YWwgcHJvcGVydGllcyBkaXJlY3QgYW5kIGV4cGxpY2l0Lg0KDQpIZXJlIGlzIGEgY29uY3JldGUgZXhhbXBsZS4gTG9vayBhdCB0aGlzICJtZXNzeSIgKHdpZGUtZm9ybWF0KSBwb3B1bGF0aW9uIGRhdGE6DQoNCmBgYHtyIHc1LWxvYWQtdGlkeXZlcnNlLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KbGlicmFyeSh0aWR5dmVyc2UpDQpgYGANCg0KYGBge3IgdzUtbWVzc3ktZGF0YSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCiMgTWVzc3kgKHdpZGUpIGRhdGEg4oCUIHllYXJzIGFyZSBzcHJlYWQgYWNyb3NzIGNvbHVtbnMNCm1lc3N5IDwtIHRpYmJsZSgNCiAgY291bnRyeSA9IGMoIlVTQSIsICJDYW5hZGEiLCAiTWV4aWNvIiksDQogIGAyMDIwYCA9IGMoMzMxLCAzOCwgMTI5KSwNCiAgYDIwMjFgID0gYygzMzIsIDM4LCAxMzApLA0KICBgMjAyMmAgPSBjKDMzMywgMzksIDEzMSkNCikNCm1lc3N5DQpgYGANCg0KVGhpcyBsb29rcyBmaW5lIHRvIGEgaHVtYW4gZXllLiBCdXQgdHJ5IG1hcHBpbmcgaXQgdG8gZ2dwbG90MiAtLSB3aGF0IHdvdWxkIHlvdSBwdXQgb24gdGhlIHgtYXhpcz8gVGhlcmUgaXMgbm8gYHllYXJgIGNvbHVtbi4gVGhlIHllYXJzIGFyZSB0cmFwcGVkIGluc2lkZSBjb2x1bW4gKm5hbWVzKiwgbm90IGluc2lkZSBjb2x1bW4gKnZhbHVlcyouDQoNCk5vdyBsZXQgdXMgdGlkeSBpdDoNCg0KYGBge3IgdzUtdGlkeS1kYXRhLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBUaWR5IChsb25nKSBkYXRhIOKAlCBlYWNoIHJvdyBpcyBvbmUgY291bnRyeS15ZWFyIG9ic2VydmF0aW9uDQp0aWR5IDwtIG1lc3N5ICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IGAyMDIwYDpgMjAyMmAsDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJ5ZWFyIiwNCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJwb3B1bGF0aW9uX21pbGxpb25zIikNCnRpZHkNCmBgYA0KDQpUaGUgbWVzc3kgZGF0YSBoYWQgMyByb3dzIGFuZCA0IGNvbHVtbnMuIFRoZSB0aWR5IGRhdGEgaGFzIDkgcm93cyBhbmQgMyBjb2x1bW5zLiBFdmVyeSBjb21iaW5hdGlvbiBvZiBjb3VudHJ5IGFuZCB5ZWFyIGlzIGl0cyBvd24gcm93LCBhbmQgYHllYXJgIGFuZCBgcG9wdWxhdGlvbl9taWxsaW9uc2AgYXJlIHByb3BlciBjb2x1bW5zIHdlIGNhbiBtYXAgdG8gYWVzdGhldGljcy4NCg0KTm93IHdlIGNhbiBwbG90IGl0IGRpcmVjdGx5Og0KDQpgYGB7ciB3NS10aWR5LXBsb3QsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTQsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQp0aWR5ICU+JQ0KICBtdXRhdGUoeWVhciA9IGFzLmludGVnZXIoeWVhcikpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSB5ZWFyLCB5ID0gcG9wdWxhdGlvbl9taWxsaW9ucywgY29sb3IgPSBjb3VudHJ5KSkgKw0KICBnZW9tX2xpbmUobGluZXdpZHRoID0gMS4yKSArDQogIGdlb21fcG9pbnQoc2l6ZSA9IDMpICsNCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoIlVTQSIgPSAiIzAwMjk2NyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDYW5hZGEiID0gIiNDNDFFM0EiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTWV4aWNvIiA9ICIjQjQ5NzVBIikpICsNCiAgbGFicyh0aXRsZSA9ICJQb3B1bGF0aW9uIEdyb3d0aCAoMjAyMFx1MjAxMzIwMjIpIiwNCiAgICAgICB5ID0gIlBvcHVsYXRpb24gKG1pbGxpb25zKSIsIHggPSBOVUxMLCBjb2xvciA9IE5VTEwpICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMykNCmBgYA0KDQo6Ojogey5jYWxsb3V0LXRpcH0NCioqUnVsZSBvZiB0aHVtYjoqKiBJZiB5b3Ugd2FudCB0byBtYXAgc29tZXRoaW5nIHRvIGNvbG9yLCBmaWxsLCBvciBmYWNldCBidXQgdGhlIGNhdGVnb3JpZXMgYXJlIHN0dWNrIGluIGNvbHVtbiAqbmFtZXMqIHJhdGhlciB0aGFuIGluIGEgY29sdW1uIG9mIHRoZWlyIG93biwgeW91IG5lZWQgYHBpdm90X2xvbmdlcigpYC4NCjo6Og0KDQojIyAyLiBUaGUgUGlwZSBPcGVyYXRvciBgJT4lYA0KDQpUaGUgcGlwZSBvcGVyYXRvciBgJT4lYCBpcyB0aGUgY29ubmVjdGl2ZSB0aXNzdWUgb2YgdGlkeXZlcnNlIGNvZGUuIFJlYWQgaXQgYXMgKioiYW5kIHRoZW4uIioqIEl0IHRha2VzIHRoZSBvdXRwdXQgb2YgdGhlIGV4cHJlc3Npb24gb24gaXRzIGxlZnQgYW5kIHBhc3NlcyBpdCBhcyB0aGUgKipmaXJzdCBhcmd1bWVudCoqIHRvIHRoZSBmdW5jdGlvbiBvbiBpdHMgcmlnaHQuDQoNCldpdGhvdXQgdGhlIHBpcGUsIGNvZGUgcmVhZHMgKmluc2lkZS1vdXQqLiBXaXRoIHRoZSBwaXBlLCBjb2RlIHJlYWRzICp0b3AtdG8tYm90dG9tKiBsaWtlIGEgcmVjaXBlOg0KDQpgYGB7ciB3NS1waXBlLW5lc3RlZCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCiMgV2l0aG91dCBwaXBlOiBuZXN0ZWQsIGhhcmQgdG8gcmVhZCDigJQgeW91IG11c3QgcmVhZCBpbnNpZGUtb3V0DQphcnJhbmdlKHN1bW1hcmlzZShncm91cF9ieShmaWx0ZXIobXBnLCB5ZWFyID09IDIwMDgpLCBjbGFzcyksIGF2ZyA9IG1lYW4oaHd5KSksIGRlc2MoYXZnKSkNCmBgYA0KDQpgYGB7ciB3NS1waXBlLWNsZWFyLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBXaXRoIHBpcGU6IGNsZWFyLCByZWFkYWJsZSDigJQgeW91IHJlYWQgdG9wIHRvIGJvdHRvbQ0KbXBnICU+JQ0KICBmaWx0ZXIoeWVhciA9PSAyMDA4KSAlPiUNCiAgZ3JvdXBfYnkoY2xhc3MpICU+JQ0KICBzdW1tYXJpc2UoYXZnID0gbWVhbihod3kpLCAuZ3JvdXBzID0gImRyb3AiKSAlPiUNCiAgYXJyYW5nZShkZXNjKGF2ZykpDQpgYGANCg0KQm90aCBwcm9kdWNlIHRoZSBleGFjdCBzYW1lIHJlc3VsdC4gQnV0IHRoZSBwaXBlZCB2ZXJzaW9uIHRlbGxzIGEgc3Rvcnk6ICpzdGFydCB3aXRoIG1wZywgdGhlbiBmaWx0ZXIgdG8gMjAwOCwgdGhlbiBncm91cCBieSBjbGFzcywgdGhlbiBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgaGlnaHdheSBtcGcsIHRoZW4gYXJyYW5nZSBmcm9tIGhpZ2hlc3QgdG8gbG93ZXN0LioNCg0KVGhpbmsgb2YgaXQgbGlrZSBnaXZpbmcgZGlyZWN0aW9uczoNCg0KLSAqKldpdGhvdXQgcGlwZToqKiAiR28gdG8gdGhlIGVuZCBvZiB0aGUgc3RyZWV0IHRoYXQgaXMgdHdvIGJsb2NrcyBhZnRlciB0aGUgbGVmdCB0dXJuIHlvdSBtYWtlIGFmdGVyIGV4aXRpbmcgdGhlIGhpZ2h3YXkgYXQgZXhpdCA0LiINCi0gKipXaXRoIHBpcGU6KiogIlRha2UgZXhpdCA0LiBUdXJuIGxlZnQuIEdvIHR3byBibG9ja3MuIEl0IGlzIGF0IHRoZSBlbmQgb2YgdGhlIHN0cmVldC4iDQoNClNhbWUgZGVzdGluYXRpb24uIFZlcnkgZGlmZmVyZW50IHJlYWRhYmlsaXR5Lg0KDQo6Ojogey5jYWxsb3V0LWluZm99DQoqKkJhc2UgUiBwaXBlIGB8PmAgdnMuIG1hZ3JpdHRyIHBpcGUgYCU+JWA6KiogUiA0LjErIGludHJvZHVjZWQgYSBuYXRpdmUgcGlwZSBvcGVyYXRvciBgfD5gLiBJdCB3b3JrcyBzaW1pbGFybHkgZm9yIG1vc3QgdXNlIGNhc2VzLiBJbiB0aGlzIGNvdXJzZSB3ZSB1c2UgYCU+JWAgYmVjYXVzZSBpdCBpcyB3aGF0IHlvdSB3aWxsIGVuY291bnRlciBpbiBtb3N0IGV4aXN0aW5nIHRpZHl2ZXJzZSBjb2RlIGFuZCB0dXRvcmlhbHMuIEJvdGggYXJlIGZpbmUuIElmIHlvdSBzZWUgYHw+YCBpbiBvbmxpbmUgZXhhbXBsZXMsIGtub3cgdGhhdCBpdCBkb2VzIGVzc2VudGlhbGx5IHRoZSBzYW1lIHRoaW5nLg0KOjo6DQoNCiMjIDMuIFRoZSBkcGx5ciBWZXJicyB7LnRhYnNldH0NCg0KVGhlIGRwbHlyIHBhY2thZ2UgcHJvdmlkZXMgYSBzbWFsbCBzZXQgb2YgKip2ZXJicyoqIC0tIGZ1bmN0aW9ucyB0aGF0IGVhY2ggZG8gb25lIHRoaW5nIHdlbGwuIFRoaW5rIG9mIHRoZW0gYXMgdGhlIGJ1aWxkaW5nIGJsb2NrcyBvZiBkYXRhIHRyYW5zZm9ybWF0aW9uLiBXaGVuIHlvdSBjaGFpbiB0aGVtIHRvZ2V0aGVyIHdpdGggcGlwZXMsIHlvdSBjYW4gZXhwcmVzcyBzb3BoaXN0aWNhdGVkIGRhdGEgdHJhbnNmb3JtYXRpb25zIGluIGNsZWFyLCByZWFkYWJsZSBjb2RlLg0KDQpUaGVyZSBhcmUgc2l4IHZlcmJzIHlvdSBuZWVkIHRvIGtub3cuIEVhY2ggb25lIG9wZXJhdGVzIG9uIGEgZGF0YSBmcmFtZSBhbmQgcmV0dXJucyBhIG5ldyBkYXRhIGZyYW1lLg0KDQp8IFZlcmIgfCBXaGF0IGl0IGRvZXMgfCBUaGluayBvZiBpdCBhcy4uLiB8DQp8Oi0tLS0tfDotLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS0tLS18DQp8IGBmaWx0ZXIoKWAgfCBLZWVwcyByb3dzIHRoYXQgbWF0Y2ggYSBjb25kaXRpb24gfCAiU2hvdyBtZSBvbmx5IHRoZSByb3dzIHdoZXJlLi4uIiB8DQp8IGBzZWxlY3QoKWAgfCBLZWVwcyAob3IgcmVtb3Zlcykgc3BlY2lmaWMgY29sdW1ucyB8ICJJIG9ubHkgbmVlZCB0aGVzZSBjb2x1bW5zLi4uIiB8DQp8IGBtdXRhdGUoKWAgfCBDcmVhdGVzIG5ldyBjb2x1bW5zIG9yIG1vZGlmaWVzIGV4aXN0aW5nIG9uZXMgfCAiQ2FsY3VsYXRlIGEgbmV3IHZhcmlhYmxlLi4uIiB8DQp8IGBzdW1tYXJpc2UoKWAgfCBDb2xsYXBzZXMgbWFueSByb3dzIGludG8gYSBzdW1tYXJ5IHwgIkdpdmUgbWUgdGhlIGF2ZXJhZ2UvY291bnQvbWF4Li4uIiB8DQp8IGBncm91cF9ieSgpYCB8IFNldHMgdXAgZ3JvdXBzIGZvciBzdW1tYXJpc2UgfCAiRG8gdGhpcyBzZXBhcmF0ZWx5IGZvciBlYWNoLi4uIiB8DQp8IGBhcnJhbmdlKClgIHwgU29ydHMgcm93cyB8ICJQdXQgdGhlc2UgaW4gb3JkZXIgYnkuLi4iIHwNCg0KIyMjIGZpbHRlcigpDQoNCmBmaWx0ZXIoKWAgc2VsZWN0cyAqKnJvd3MqKiBiYXNlZCBvbiBjb25kaXRpb25zLiBPbmx5IHJvd3Mgd2hlcmUgdGhlIGNvbmRpdGlvbiBldmFsdWF0ZXMgdG8gYFRSVUVgIGFyZSBrZXB0LiBFdmVyeXRoaW5nIGVsc2UgaXMgcmVtb3ZlZC4NCg0KYGBge3IgdzUtZmlsdGVyLWRlbW8sIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQojIEtlZXAgb25seSBUb3lvdGEgdmVoaWNsZXMgZnJvbSAyMDA4DQptcGcgJT4lDQogIGZpbHRlcihtYW51ZmFjdHVyZXIgPT0gInRveW90YSIsIHllYXIgPT0gMjAwOCkgJT4lDQogIHNlbGVjdChtb2RlbCwgeWVhciwgY3R5LCBod3kpDQpgYGANCg0KTm90aWNlIHR3byB0aGluZ3M6IHdlIHVzZSBgPT1gIChkb3VibGUgZXF1YWxzKSB0byB0ZXN0IGZvciBlcXVhbGl0eSwgbm90IGA9YCAoc2luZ2xlIGVxdWFscykuIEFuZCB3aGVuIHdlIGxpc3QgbXVsdGlwbGUgY29uZGl0aW9ucyBzZXBhcmF0ZWQgYnkgY29tbWFzLCBpdCBtZWFucyAiQU5EIiAtLSBib3RoIGNvbmRpdGlvbnMgbXVzdCBiZSB0cnVlLg0KDQpIZXJlIGFyZSB0aGUgbW9zdCBjb21tb24gb3BlcmF0b3JzIHlvdSB3aWxsIHVzZSBpbnNpZGUgYGZpbHRlcigpYDoNCg0KfCBPcGVyYXRvciB8IE1lYW5pbmcgfCBFeGFtcGxlIHwNCnw6LS0tLS0tLS0tfDotLS0tLS0tLXw6LS0tLS0tLS18DQp8IGA9PWAgfCBlcXVhbHMgfCBgZmlsdGVyKHllYXIgPT0gMjAwOClgIHwNCnwgYCE9YCB8IG5vdCBlcXVhbCB8IGBmaWx0ZXIoY2xhc3MgIT0gInN1diIpYCB8DQp8IGA+YCwgYDxgLCBgPj1gLCBgPD1gIHwgY29tcGFyaXNvbnMgfCBgZmlsdGVyKGh3eSA+IDMwKWAgfA0KfCBgJWluJWAgfCB2YWx1ZSBpcyBpbiBhIHNldCB8IGBmaWx0ZXIoY2xhc3MgJWluJSBjKCJzdXYiLCAicGlja3VwIikpYCB8DQp8IGAmYCB8IGFuZCB8IGBmaWx0ZXIoeWVhciA9PSAyMDA4ICYgaHd5ID4gMjUpYCB8DQp8IGB8YCB8IG9yIHwgYGZpbHRlcihjbGFzcyA9PSAic3V2IiB8IGNsYXNzID09ICJwaWNrdXAiKWAgfA0KfCBgaXMubmEoKWAgfCBpcyBtaXNzaW5nIHwgYGZpbHRlcihpcy5uYShod3kpKWAgfA0KfCBgIWlzLm5hKClgIHwgaXMgbm90IG1pc3NpbmcgfCBgZmlsdGVyKCFpcy5uYShod3kpKWAgfA0KDQojIyMgc2VsZWN0KCkNCg0KYHNlbGVjdCgpYCBjaG9vc2VzICoqY29sdW1ucyoqLiBJdCBpcyB5b3VyIHRvb2wgZm9yIG5hcnJvd2luZyBhIHdpZGUgZGF0YXNldCBkb3duIHRvIGp1c3QgdGhlIHZhcmlhYmxlcyB5b3UgbmVlZC4gVGhpcyBtYWtlcyB5b3VyIGRhdGEgZWFzaWVyIHRvIHdvcmsgd2l0aCBhbmQgeW91ciBvdXRwdXQgZWFzaWVyIHRvIHJlYWQuDQoNCmBgYHtyIHc1LXNlbGVjdC1kZW1vLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBLZWVwIG9ubHkgc3BlY2lmaWMgY29sdW1ucw0KbXBnICU+JQ0KICBzZWxlY3QobWFudWZhY3R1cmVyLCBtb2RlbCwgeWVhciwgaHd5LCBjdHkpICU+JQ0KICBoZWFkKDgpDQpgYGANCg0KWW91IGNhbiBhbHNvIHVzZSBoZWxwZXIgZnVuY3Rpb25zIGluc2lkZSBgc2VsZWN0KClgOg0KDQotIGBzdGFydHNfd2l0aCgiaCIpYCAtLSBhbGwgY29sdW1ucyB3aG9zZSBuYW1lcyBzdGFydCB3aXRoICJoIg0KLSBgZW5kc193aXRoKCJ5IilgIC0tIGFsbCBjb2x1bW5zIHdob3NlIG5hbWVzIGVuZCB3aXRoICJ5Ig0KLSBgY29udGFpbnMoIm1wZyIpYCAtLSBhbGwgY29sdW1ucyB3aG9zZSBuYW1lcyBjb250YWluICJtcGciDQotIGAtY29sdW1uX25hbWVgIC0tIHJlbW92ZSBhIGNvbHVtbiAoa2VlcCBldmVyeXRoaW5nIGVsc2UpDQoNCiMjIyBtdXRhdGUoKQ0KDQpgbXV0YXRlKClgIGNyZWF0ZXMgKipuZXcgY29sdW1ucyoqIG9yIG1vZGlmaWVzIGV4aXN0aW5nIG9uZXMuIFRoZSBvcmlnaW5hbCBjb2x1bW5zIGFyZSBwcmVzZXJ2ZWQ7IG5ldyBjb2x1bW5zIGFyZSBhcHBlbmRlZCB0byB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgZGF0YSBmcmFtZS4NCg0KYGBge3IgdzUtbXV0YXRlLWRlbW8sIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQojIENhbGN1bGF0ZSBhdmVyYWdlIE1QRyBhbmQgZXN0aW1hdGVkIGFubnVhbCBmdWVsIGNvc3QNCm1wZyAlPiUNCiAgbXV0YXRlKA0KICAgIGF2Z19tcGcgPSAoY3R5ICsgaHd5KSAvIDIsDQogICAgZnVlbF9jb3N0X2FubnVhbCA9ICgxNTAwMCAvIGF2Z19tcGcpICogMy41MCAgIyAxNWsgbWlsZXMgYXQgJDMuNTAvZ2FsDQogICkgJT4lDQogIHNlbGVjdChtYW51ZmFjdHVyZXIsIG1vZGVsLCBhdmdfbXBnLCBmdWVsX2Nvc3RfYW5udWFsKSAlPiUNCiAgaGVhZCg4KQ0KYGBgDQoNClRoaW5rIG9mIGBtdXRhdGUoKWAgYXMgYWRkaW5nIGEgbmV3IGNvbHVtbiB0byBhIHNwcmVhZHNoZWV0IHdoZXJlIHRoZSB2YWx1ZSBpbiBlYWNoIGNlbGwgaXMgY2FsY3VsYXRlZCBmcm9tIG90aGVyIGNvbHVtbnMgaW4gdGhlIHNhbWUgcm93Lg0KDQojIyMgc3VtbWFyaXNlKCkgKyBncm91cF9ieSgpDQoNCmBzdW1tYXJpc2UoKWAgKHlvdSBjYW4gYWxzbyBzcGVsbCBpdCBgc3VtbWFyaXplKClgKSBjb2xsYXBzZXMgbWFueSByb3dzIGludG8gc3VtbWFyeSBzdGF0aXN0aWNzLiBPbiBpdHMgb3duLCBpdCBnaXZlcyB5b3UgYSBzaW5nbGUtcm93IHN1bW1hcnkgb2YgdGhlIGVudGlyZSBkYXRhc2V0LiBCdXQgd2hlbiB5b3UgcGFpciBpdCB3aXRoIGBncm91cF9ieSgpYCwgaXQgY29tcHV0ZXMgc3VtbWFyaWVzICoqd2l0aGluIGVhY2ggZ3JvdXAqKi4NCg0KRmlyc3QsIGxldCB1cyBzZWUgYHN1bW1hcmlzZSgpYCB3aXRob3V0IGdyb3VwaW5nOg0KDQpgYGB7ciB3NS1zdW1tYXJpc2UtdW5ncm91cGVkLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBPbmUgc3VtbWFyeSBmb3IgdGhlIGVudGlyZSBkYXRhc2V0DQptcGcgJT4lDQogIHN1bW1hcmlzZSgNCiAgICBhdmdfaHd5ID0gbWVhbihod3kpLA0KICAgIG1heF9od3kgPSBtYXgoaHd5KSwNCiAgICB0b3RhbF9jYXJzID0gbigpDQogICkNCmBgYA0KDQpOb3cgd2l0aCBgZ3JvdXBfYnkoKWA6DQoNCmBgYHtyIHc1LXN1bW1hcmlzZS1ncm91cGVkLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBTdW1tYXJ5IHN0YXRpc3RpY3MgYnkgdmVoaWNsZSBjbGFzcw0KbXBnICU+JQ0KICBncm91cF9ieShjbGFzcykgJT4lDQogIHN1bW1hcmlzZSgNCiAgICBuID0gbigpLA0KICAgIGF2Z19od3kgPSBtZWFuKGh3eSksDQogICAgYmVzdF9od3kgPSBtYXgoaHd5KSwNCiAgICAuZ3JvdXBzID0gImRyb3AiDQogICkgJT4lDQogIGFycmFuZ2UoZGVzYyhhdmdfaHd5KSkNCmBgYA0KDQpOb3RpY2UgdGhlIGAuZ3JvdXBzID0gImRyb3AiYCBhcmd1bWVudC4gVGhpcyB0ZWxscyBSIHRvIHJlbW92ZSB0aGUgZ3JvdXBpbmcgYWZ0ZXIgc3VtbWFyaXppbmcsIHdoaWNoIHByZXZlbnRzIHN1cnByaXNpbmcgYmVoYXZpb3IgaW4gZG93bnN0cmVhbSBvcGVyYXRpb25zLiBBbHdheXMgaW5jbHVkZSBpdC4NCg0KQ29tbW9uIHN1bW1hcnkgZnVuY3Rpb25zIHlvdSBjYW4gdXNlIGluc2lkZSBgc3VtbWFyaXNlKClgOg0KDQp8IEZ1bmN0aW9uIHwgV2hhdCBpdCBjYWxjdWxhdGVzIHwNCnw6LS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS0tLS0tfA0KfCBgbWVhbih4KWAgfCBBdmVyYWdlIHwNCnwgYG1lZGlhbih4KWAgfCBNZWRpYW4gfA0KfCBgc2QoeClgIHwgU3RhbmRhcmQgZGV2aWF0aW9uIHwNCnwgYG1pbih4KWAsIGBtYXgoeClgIHwgTWluaW11bSwgbWF4aW11bSB8DQp8IGBuKClgIHwgQ291bnQgb2Ygcm93cyB8DQp8IGBzdW0oeClgIHwgVG90YWwgfA0KDQojIyMgYXJyYW5nZSgpDQoNCmBhcnJhbmdlKClgIHNvcnRzIHJvd3MuIEJ5IGRlZmF1bHQgaXQgc29ydHMgaW4gYXNjZW5kaW5nIG9yZGVyIChzbWFsbGVzdCB0byBsYXJnZXN0KS4gV3JhcCBhIGNvbHVtbiBpbiBgZGVzYygpYCB0byBzb3J0IGluIGRlc2NlbmRpbmcgb3JkZXIgKGxhcmdlc3QgdG8gc21hbGxlc3QpLg0KDQpgYGB7ciB3NS1hcnJhbmdlLWRlbW8sIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQojIFJhbmsgbWFudWZhY3R1cmVycyBieSBhdmVyYWdlIGhpZ2h3YXkgTVBHIChiZXN0IHRvIHdvcnN0KQ0KbXBnICU+JQ0KICBncm91cF9ieShtYW51ZmFjdHVyZXIpICU+JQ0KICBzdW1tYXJpc2UoYXZnX2h3eSA9IG1lYW4oaHd5KSwgLmdyb3VwcyA9ICJkcm9wIikgJT4lDQogIGFycmFuZ2UoZGVzYyhhdmdfaHd5KSkNCmBgYA0KDQojIyB7LX0NCg0KOjo6IHsuY2FsbG91dC1lcnJvcn0NCiMjIENvbW1vbiBFcnJvcnMgYW5kIEhvdyB0byBGaXggVGhlbQ0KDQpXaGVuIHlvdSBhcmUgd29ya2luZyB0aHJvdWdoIHRoaXMgd2VlaydzIGNvZGUsIHlvdSB3aWxsIGFsbW9zdCBjZXJ0YWlubHkgZW5jb3VudGVyIHNvbWUgb2YgdGhlc2UgZXJyb3JzLiAqKlRoaXMgaXMgbm9ybWFsLioqIEhlcmUgaXMgYSBxdWljayByZWZlcmVuY2UgZm9yIGRpYWdub3NpbmcgYW5kIGZpeGluZyB0aGVtLg0KDQoqKiJFcnJvcjogb2JqZWN0ICdod3knIG5vdCBmb3VuZCIqKg0KDQpJbnNpZGUgZHBseXIgdmVyYnMsIHVzZSAqKmJhcmUgY29sdW1uIG5hbWVzKiogKG5vIHF1b3Rlcyk6IGBmaWx0ZXIoaHd5ID4gMzApYCwgbm90IGBmaWx0ZXIoImh3eSIgPiAzMClgLg0KDQoqKiJFcnJvciBpbiBmaWx0ZXIoKTogISBvYmplY3QgJ21wZycgbm90IGZvdW5kIioqDQoNCkRpZCB5b3UgbG9hZCB0aGUgdGlkeXZlcnNlPyBZb3UgbmVlZCB0byBydW4gYGxpYnJhcnkodGlkeXZlcnNlKWAgYXQgdGhlIHRvcCBvZiB5b3VyIHNjcmlwdCBiZWZvcmUgdXNpbmcgYW55IGRwbHlyIGZ1bmN0aW9ucyBvciBidWlsdC1pbiBkYXRhc2V0cyBsaWtlIGBtcGdgLg0KDQoqKiJFcnJvcjogdW5leHBlY3RlZCBQSVBFIioqDQoNClRoZSBgJT4lYCBwaXBlIG11c3QgZ28gYXQgdGhlICoqZW5kKiogb2YgYSBsaW5lLCBub3QgdGhlIHN0YXJ0IG9mIHRoZSBuZXh0IGxpbmUuDQoNCmBgYA0KIyBXUk9ORyDigJQgcGlwZSBhdCB0aGUgc3RhcnQgb2YgYSBsaW5lDQptcGcNCiAgJT4lIGZpbHRlcih5ZWFyID09IDIwMDgpDQoNCiMgUklHSFQg4oCUIHBpcGUgYXQgdGhlIGVuZCBvZiBhIGxpbmUNCm1wZyAlPiUNCiAgZmlsdGVyKHllYXIgPT0gMjAwOCkNCmBgYA0KDQoqKiIuZ3JvdXBzIGFyZ3VtZW50IiB3YXJuaW5nKioNCg0KVGhpcyBpcyBhIHdhcm5pbmcsIG5vdCBhbiBlcnJvciAtLSB5b3VyIGNvZGUgc3RpbGwgcnVucy4gQnV0IHRvIHNpbGVuY2UgaXQgYW5kIGF2b2lkIHVuZXhwZWN0ZWQgYmVoYXZpb3IsIGFkZCBgLmdyb3VwcyA9ICJkcm9wImAgaW5zaWRlIGBzdW1tYXJpc2UoKWA6DQoNCmBgYA0Kc3VtbWFyaXNlKGF2ZyA9IG1lYW4oaHd5KSwgLmdyb3VwcyA9ICJkcm9wIikNCmBgYA0KDQoqKiJDb2x1bW4gYF9fX2AgZG9lc24ndCBleGlzdCIqKg0KDQpDaGVjayB5b3VyIHNwZWxsaW5nLiAqKlIgaXMgY2FzZS1zZW5zaXRpdmUuKiogYEh3eWAgaXMgbm90IHRoZSBzYW1lIGFzIGBod3lgLiBVc2UgYG5hbWVzKG1wZylgIG9yIGBnbGltcHNlKG1wZylgIHRvIHNlZSB0aGUgZXhhY3QgY29sdW1uIG5hbWVzLg0KDQoqKnBpdm90X2xvbmdlcigpIGRvZXMgbm90IHNlZW0gdG8gd29yayoqDQoNCk1ha2Ugc3VyZSBgY29scyA9YCBzcGVjaWZpZXMgd2hpY2ggY29sdW1ucyB0byBwaXZvdC4gSWYgeW91ciBjb2x1bW4gbmFtZXMgc3RhcnQgd2l0aCBudW1iZXJzIChsaWtlIGAyMDIwYCksIHlvdSBtdXN0IHdyYXAgdGhlbSBpbiBiYWNrdGlja3M6DQoNCmBgYA0KcGl2b3RfbG9uZ2VyKGNvbHMgPSBgMjAyMGA6YDIwMjJgLA0KICAgICAgICAgICAgIG5hbWVzX3RvID0gInllYXIiLA0KICAgICAgICAgICAgIHZhbHVlc190byA9ICJ2YWx1ZSIpDQpgYGANCjo6Og0KDQojIyBUcnkgSXQ6IGRwbHlyIFBpcGVsaW5lIEJ1aWxkZXINCg0KWW91IGhhdmUganVzdCBsZWFybmVkIHRoZSBzaXggY29yZSBkcGx5ciB2ZXJicy4gTm93IGJ1aWxkIGEgZGF0YSB0cmFuc2Zvcm1hdGlvbiBwaXBlbGluZSBpbnRlcmFjdGl2ZWx5LiBUaGUgc2FuZGJveCBiZWxvdyBsZXRzIHlvdSB0b2dnbGUgZWFjaCB2ZXJiIG9uIGFuZCBvZmYgdG8gc2VlIGhvdyB0aGUgZGF0YSBjaGFuZ2VzIGF0IGVhY2ggc3RlcCDigJQgbm8gbmVlZCB0byB3cml0ZSBjb2RlLg0KDQo8ZGl2IGNsYXNzPSJzYW5kYm94LXNlY3Rpb24iPg0KPGRpdiBjbGFzcz0ic2FuZGJveC1oZWFkZXIiPg0KPHNwYW4gY2xhc3M9InNhbmRib3gtaWNvbiI+8J+nqjwvc3Bhbj4gZHBseXIgUGlwZWxpbmUgQnVpbGRlciDigJQgVHJhbnNmb3JtIERhdGEgU3RlcCBieSBTdGVwDQo8L2Rpdj4NCjxpZnJhbWUgY2xhc3M9InNhbmRib3gtZnJhbWUiIHNyYz0iaHR0cHM6Ly9hbmFseXRpY3MuZ29uemFnYS5lZHUvd2VlazA1LXBpcGVsaW5lLyINCiAgICAgICAgaGVpZ2h0PSI2MDAiIGxvYWRpbmc9ImxhenkiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4NCjxkaXYgY2xhc3M9InNhbmRib3gtY29sZC1zdGFydCI+DQpJZiB0aGUgYXBwIHRha2VzIGEgZmV3IHNlY29uZHMgdG8gbG9hZCBvbiBmaXJzdCB2aXNpdCwgdGhhdCBpcyBub3JtYWwg4oCUIHRoZSBzZXJ2ZXIgaXMgd2FraW5nIHVwLg0KPC9kaXY+DQo8L2Rpdj4NCg0KOjo6IHsudHJ5LWl0LWJveH0NCioqRXhwbG9yYXRpb24gVGFza3M6KioNCg0KMS4gU3RhcnQgd2l0aCBubyBwaXBlbGluZSBzdGVwcyBlbmFibGVkLiBMb29rIGF0IHRoZSByYXcgZGF0YSDigJQgaG93IG1hbnkgcm93cyBhbmQgY29sdW1ucyBhcmUgdGhlcmU/DQoyLiBFbmFibGUgKipmaWx0ZXIqKiDigJQgaG93IG1hbnkgcm93cyByZW1haW4/IFdoYXQgY3JpdGVyaW9uIHdhcyBhcHBsaWVkPw0KMy4gQWRkICoqc2VsZWN0Kiog4oCUIHdoaWNoIGNvbHVtbnMgd2VyZSBrZXB0PyBXaHkgbWlnaHQgeW91IGRyb3AgdGhlIG90aGVycz8NCjQuIFRvZ2dsZSBvbiAqKm11dGF0ZSoqIOKAlCB3aGF0IG5ldyBjb2x1bW4gd2FzIGNyZWF0ZWQ/IEV4YW1pbmUgaG93IGl0IHdhcyBjYWxjdWxhdGVkLg0KNS4gRmluYWxseSwgYWRkICoqYXJyYW5nZSoqIOKAlCBkb2VzIHNvcnRpbmcgcmV2ZWFsIGFueSBwYXR0ZXJucyB5b3UgZGlkIG5vdCBub3RpY2UgYmVmb3JlPw0KOjo6DQoNCjo6OiB7LmNhbGxvdXQtaW5mb30NCioqV2hhdCBZb3UgU2hvdWxkIEhhdmUgTm90aWNlZDoqKiBFYWNoIHZlcmIgZG9lcyBvbmUgc3BlY2lmaWMgdGhpbmcsIGFuZCB0aGUgcGlwZSAoYCU+JWApIGNoYWlucyB0aGVtIHRvZ2V0aGVyIGludG8gYSByZWFkYWJsZSwgc3RlcC1ieS1zdGVwIHRyYW5zZm9ybWF0aW9uLiBUaGUgb3JkZXIgbWF0dGVycyDigJQgZmlsdGVyaW5nIGJlZm9yZSBncm91cGluZyBwcm9kdWNlcyBkaWZmZXJlbnQgcmVzdWx0cyB0aGFuIGdyb3VwaW5nIGJlZm9yZSBmaWx0ZXJpbmcuIEJ1aWxkaW5nIHBpcGVsaW5lcyBpbmNyZW1lbnRhbGx5IChvbmUgdmVyYiBhdCBhIHRpbWUpIGhlbHBzIHlvdSBjYXRjaCBlcnJvcnMgZWFybHkuDQo6OjoNCg0KOjo6IHsuY2FsbG91dC1haX0NCioqQUkgJiBUaGlzIENvbmNlcHQqKg0KV2hlbiBhc2tpbmcgQUkgdG8gd3JhbmdsZSBkYXRhLCBkZXNjcmliZSB5b3VyIHBpcGVsaW5lIHN0ZXAgYnkgc3RlcDogIkZpbHRlciB0byByb3dzIHdoZXJlIHllYXIgPiAyMDAwLCB0aGVuIGdyb3VwIGJ5IGNvdW50cnksIHRoZW4gY29tcHV0ZSBtZWFuIEdEUCBwZXIgY2FwaXRhLiIgQUkgdG9vbHMgcHJvZHVjZSBtdWNoIGNsZWFuZXIgZHBseXIgY29kZSB3aGVuIHlvdSBicmVhayB0aGUgdHJhbnNmb3JtYXRpb24gaW50byBleHBsaWNpdCBzdGVwcyByYXRoZXIgdGhhbiBhc2tpbmcgZm9yIHRoZSBlbmQgcmVzdWx0IGFsbCBhdCBvbmNlLg0KOjo6DQoNCiMjIDQuIFJlc2hhcGluZyB3aXRoIHBpdm90X2xvbmdlcigpDQoNCk1vc3QgZGF0YSB5b3UgZG93bmxvYWQgZnJvbSB0aGUgaW50ZXJuZXQgY29tZXMgaW4gKip3aWRlIGZvcm1hdCoqIC0tIGRlc2lnbmVkIGZvciBodW1hbiByZWFkaW5nLCB3aXRoIGNhdGVnb3JpZXMgc3ByZWFkIGFjcm9zcyBjb2x1bW4gaGVhZGVycy4gQnV0IGdncGxvdDIgbmVlZHMgKipsb25nIGZvcm1hdCoqIC0tIG9uZSByb3cgcGVyIG9ic2VydmF0aW9uLCB3aXRoIGNhdGVnb3JpZXMgaW4gdGhlaXIgb3duIGNvbHVtbi4NCg0KYHBpdm90X2xvbmdlcigpYCBjb252ZXJ0cyB3aWRlIGRhdGEgdG8gbG9uZyBkYXRhLiBJdCBoYXMgdGhyZWUga2V5IGFyZ3VtZW50czoNCg0KfCBBcmd1bWVudCB8IFB1cnBvc2UgfCBFeGFtcGxlIHwNCnw6LS0tLS0tLS0tfDotLS0tLS0tLXw6LS0tLS0tLS18DQp8IGBjb2xzYCB8IFdoaWNoIGNvbHVtbnMgdG8gcGl2b3QgfCBgY29scyA9IGMoQ2l0eSwgSGlnaHdheSlgIG9yIGBjb2xzID0gYDIwMjBgOmAyMDIyYGAgfA0KfCBgbmFtZXNfdG9gIHwgTmFtZSBmb3IgdGhlIG5ldyBjb2x1bW4gdGhhdCB3aWxsIGhvbGQgdGhlIG9sZCBjb2x1bW4gbmFtZXMgfCBgbmFtZXNfdG8gPSAidHlwZSJgIHwNCnwgYHZhbHVlc190b2AgfCBOYW1lIGZvciB0aGUgbmV3IGNvbHVtbiB0aGF0IHdpbGwgaG9sZCB0aGUgdmFsdWVzIHwgYHZhbHVlc190byA9ICJtcGciYCB8DQoNCkxldCB1cyB3YWxrIHRocm91Z2ggYSBjb21wbGV0ZSBleGFtcGxlLiBXZSB3YW50IHRvIGNvbXBhcmUgY2l0eSBhbmQgaGlnaHdheSBmdWVsIGVjb25vbXkgYnkgdmVoaWNsZSBjbGFzcywgc2hvd24gc2lkZSBieSBzaWRlIGluIGEgZ3JvdXBlZCBiYXIgY2hhcnQuIFRvIGdldCB0d28gYmFycyBwZXIgY2xhc3MgKG9uZSBmb3IgY2l0eSwgb25lIGZvciBoaWdod2F5KSwgd2UgbmVlZCBhIGNvbHVtbiB0aGF0IHNheXMgIkNpdHkiIG9yICJIaWdod2F5IiAtLSB3aGljaCBtZWFucyB3ZSBuZWVkIHRvIHBpdm90Lg0KDQoqKlN0ZXAgMTogU3VtbWFyaXNlIHRoZSBkYXRhKioNCg0KYGBge3IgdzUtcGl2b3Qtc3RlcDEsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQojIENhbGN1bGF0ZSBhdmVyYWdlIGNpdHkgYW5kIGhpZ2h3YXkgTVBHIGJ5IGNsYXNzDQptcGdfc3VtbWFyeSA8LSBtcGcgJT4lDQogIGdyb3VwX2J5KGNsYXNzKSAlPiUNCiAgc3VtbWFyaXNlKA0KICAgIENpdHkgPSBtZWFuKGN0eSksDQogICAgSGlnaHdheSA9IG1lYW4oaHd5KSwNCiAgICAuZ3JvdXBzID0gImRyb3AiDQogICkNCm1wZ19zdW1tYXJ5DQpgYGANCg0KTm90aWNlIHRoYXQgYENpdHlgIGFuZCBgSGlnaHdheWAgYXJlIHNlcGFyYXRlIGNvbHVtbnMuIFdlIGNhbm5vdCBtYXAgYm90aCB0byBhIHNpbmdsZSB5LWF4aXMgaW4gZ2dwbG90MiB3aGlsZSBhbHNvIGNvbG9yaW5nIGJ5IHR5cGUuDQoNCioqU3RlcCAyOiBQaXZvdCB0byBsb25nIGZvcm1hdCoqDQoNCmBgYHtyIHc1LXBpdm90LXN0ZXAyLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBQaXZvdCBzbyB0aGF0ICJDaXR5IiBhbmQgIkhpZ2h3YXkiIGJlY29tZSB2YWx1ZXMgaW4gYSBuZXcgY29sdW1uDQptcGdfbG9uZyA8LSBtcGdfc3VtbWFyeSAlPiUNCiAgcGl2b3RfbG9uZ2VyKA0KICAgIGNvbHMgPSBjKENpdHksIEhpZ2h3YXkpLA0KICAgIG5hbWVzX3RvID0gInR5cGUiLA0KICAgIHZhbHVlc190byA9ICJtcGciDQogICkNCm1wZ19sb25nDQpgYGANCg0KTm93IHdlIGhhdmUgYSBgdHlwZWAgY29sdW1uIHdpdGggdmFsdWVzICJDaXR5IiBhbmQgIkhpZ2h3YXkiIGFuZCBhbiBgbXBnYCBjb2x1bW4gd2l0aCB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZXMuIFRoaXMgaXMgdGlkeSBkYXRhOiBlYWNoIHJvdyBpcyBvbmUgY2xhc3MtdHlwZSBjb21iaW5hdGlvbi4NCg0KKipTdGVwIDM6IFBsb3QqKg0KDQpgYGB7ciB3NS1waXZvdC1zdGVwMywgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCmdncGxvdChtcGdfbG9uZywgYWVzKHggPSBmY3RfcmVvcmRlcihjbGFzcywgbXBnKSwgeSA9IG1wZywgZmlsbCA9IHR5cGUpKSArDQogIGdlb21fY29sKHBvc2l0aW9uID0gImRvZGdlIikgKw0KICBzY2FsZV9maWxsX21hbnVhbCh2YWx1ZXMgPSBjKCJDaXR5IiA9ICIjQzQxRTNBIiwgIkhpZ2h3YXkiID0gIiMwMDI5NjciKSkgKw0KICBjb29yZF9mbGlwKCkgKw0KICBsYWJzKHRpdGxlID0gIkF2ZXJhZ2UgQ2l0eSB2cy4gSGlnaHdheSBNUEcgYnkgVmVoaWNsZSBDbGFzcyIsDQogICAgICAgeCA9IE5VTEwsIHkgPSAiTWlsZXMgUGVyIEdhbGxvbiIsIGZpbGwgPSBOVUxMKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTMpDQpgYGANCg0KOjo6IHsuY2FsbG91dC13YXJuaW5nfQ0KKipDb21tb24gcGl0ZmFsbDoqKiBGb3JnZXR0aW5nIHRvIHBpdm90IGJlZm9yZSBwbG90dGluZy4gSWYgeW91IHRyeSB0byBtYXAgYm90aCBgY3R5YCBhbmQgYGh3eWAgdG8gdGhlIHktYXhpcyBpbiBhIHNpbmdsZSBnZ3Bsb3QgY2FsbCwgeW91IHdpbGwgcnVuIGludG8gdHJvdWJsZS4gVGhlIHRpZHkgYXBwcm9hY2ggaXMgYWx3YXlzOiAqKnBpdm90IGZpcnN0LCB0aGVuIG1hcCoqIHRoZSBuZXcgY2F0ZWdvcnkgY29sdW1uIHRvIGBmaWxsYCBvciBgY29sb3JgLg0KOjo6DQoNCiMjIFRyeSBJdDogVGlkeSBEYXRhIFRyYW5zZm9ybWVyDQoNCllvdSBoYXZlIGp1c3Qgc2VlbiBob3cgYHBpdm90X2xvbmdlcigpYCByZXNoYXBlcyB3aWRlIGRhdGEgaW50byB0aWR5IChsb25nKSBmb3JtYXQuIE5vdyB0cnkgaXQgaW50ZXJhY3RpdmVseS4gVGhlIHNhbmRib3ggYmVsb3cgc2hvd3MgbWVzc3kgKHdpZGUpIGRhdGEgb24gdGhlIGxlZnQgYW5kIHRoZSB0aWR5IChsb25nKSByZXN1bHQgb24gdGhlIHJpZ2h0IOKAlCBjb2xvci1jb2RlZCBzbyB5b3UgY2FuIHNlZSBleGFjdGx5IHdoaWNoIGNvbHVtbnMgYmVjb21lIHdoaWNoIHJvd3MuDQoNCjxkaXYgY2xhc3M9InNhbmRib3gtc2VjdGlvbiI+DQo8ZGl2IGNsYXNzPSJzYW5kYm94LWhlYWRlciI+DQo8c3BhbiBjbGFzcz0ic2FuZGJveC1pY29uIj7wn6eqPC9zcGFuPiBUaWR5IERhdGEgVHJhbnNmb3JtZXIg4oCUIFNlZSBwaXZvdF9sb25nZXIoKSBpbiBBY3Rpb24NCjwvZGl2Pg0KPGlmcmFtZSBjbGFzcz0ic2FuZGJveC1mcmFtZSIgc3JjPSJodHRwczovL2FuYWx5dGljcy5nb256YWdhLmVkdS93ZWVrMDUtdGlkeWRhdGEvIg0KICAgICAgICBoZWlnaHQ9IjY1MCIgbG9hZGluZz0ibGF6eSIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPg0KPGRpdiBjbGFzcz0ic2FuZGJveC1jb2xkLXN0YXJ0Ij4NCklmIHRoZSBhcHAgdGFrZXMgYSBmZXcgc2Vjb25kcyB0byBsb2FkIG9uIGZpcnN0IHZpc2l0LCB0aGF0IGlzIG5vcm1hbCDigJQgdGhlIHNlcnZlciBpcyB3YWtpbmcgdXAuDQo8L2Rpdj4NCjwvZGl2Pg0KDQo6Ojogey50cnktaXQtYm94fQ0KKipFeHBsb3JhdGlvbiBUYXNrczoqKg0KDQoxLiBTdGFydCB3aXRoIHRoZSAqKlF1YXJ0ZXJseSBTYWxlcyoqIGRhdGFzZXQuIEhvdyBtYW55IHJvd3MgYW5kIGNvbHVtbnMgZG9lcyB0aGUgd2lkZSB0YWJsZSBoYXZlPyBIb3cgbWFueSBkb2VzIHRoZSB0aWR5IHRhYmxlIGhhdmU/IFdoeSBkaWQgdGhlIG51bWJlciBvZiByb3dzIGluY3JlYXNlPw0KMi4gQ2hhbmdlIHRoZSAqKm5hbWVzX3RvKiogbGFiZWwgZnJvbSAicXVhcnRlciIgdG8gInRpbWVfcGVyaW9kIiDigJQgd2F0Y2ggaG93IHRoZSBnZW5lcmF0ZWQgUiBjb2RlIGFuZCB0aGUgdGlkeSB0YWJsZSBjb2x1bW4gaGVhZGVyIHVwZGF0ZSBpbiByZWFsIHRpbWUuDQozLiAqKlVuY2hlY2sgb25lIGNvbHVtbioqIChlLmcuLCBRNCkgZnJvbSB0aGUgcGl2b3QgY29udHJvbHMuIEhvdyBkb2VzIHRoZSB0aWR5IHRhYmxlIGNoYW5nZT8gSG93IG1hbnkgcm93cyBkaXNhcHBlYXJlZD8NCjQuIFN3aXRjaCB0byB0aGUgKipDaXR5IFRlbXBlcmF0dXJlcyoqIGRhdGFzZXQuIE5vdGljZSBob3cgdGhlIGRlZmF1bHQgYG5hbWVzX3RvYCBhbmQgYHZhbHVlc190b2AgbGFiZWxzIGNoYW5nZSB0byBtYXRjaCB0aGUgY29udGV4dC4gV2h5IGlzICJtb250aCIgYSBiZXR0ZXIgY29sdW1uIG5hbWUgdGhhbiAicXVhcnRlciIgZm9yIHRoaXMgZGF0YXNldD8NCjo6Og0KDQo6Ojogey5jYWxsb3V0LWluZm99DQoqKldoYXQgWW91IFNob3VsZCBIYXZlIE5vdGljZWQ6KiogUGl2b3RpbmcgaXMgYSBtZWNoYW5pY2FsIG9wZXJhdGlvbiDigJQgZWFjaCBzZWxlY3RlZCBjb2x1bW4gaW4gdGhlIHdpZGUgZGF0YSBnZW5lcmF0ZXMgb25lIG5ldyByb3cgcGVyIGV4aXN0aW5nIHJvdyBpbiB0aGUgdGlkeSBkYXRhLiBUaGUgY29sb3IgYmFuZHMgbWFrZSB0aGlzIG1hcHBpbmcgdmlzaWJsZTogYSBibHVlIGNvbHVtbiBpbiB0aGUgd2lkZSB0YWJsZSBiZWNvbWVzIGJsdWUtdGludGVkIHJvd3MgaW4gdGhlIGxvbmcgdGFibGUuIFRoZSBgbmFtZXNfdG9gIGNvbHVtbiBzdG9yZXMgdGhlIG9sZCBjb2x1bW4gKm5hbWVzKiwgYW5kIHRoZSBgdmFsdWVzX3RvYCBjb2x1bW4gc3RvcmVzIHRoZSBvbGQgY29sdW1uICp2YWx1ZXMqLiBVbmRlcnN0YW5kaW5nIHRoaXMgbWFwcGluZyBpcyB0aGUga2V5IHRvIGtub3dpbmcgd2hlbiBhbmQgaG93IHRvIHVzZSBgcGl2b3RfbG9uZ2VyKClgLg0KOjo6DQoNCjo6OiB7LmNhbGxvdXQtYWl9DQoqKkFJICYgVGhpcyBDb25jZXB0KioNCldoZW4gYXNraW5nIEFJIHRvIHJlc2hhcGUgZGF0YSwgZGVzY3JpYmUgd2hhdCB0aGUgd2lkZSBhbmQgbG9uZyB2ZXJzaW9ucyBzaG91bGQgbG9vayBsaWtlOiAiSSBoYXZlIGNvbHVtbnMgUTEsIFEyLCBRMywgUTQgYW5kIEkgd2FudCBhIHNpbmdsZSAncXVhcnRlcicgY29sdW1uIHdpdGggYSAncmV2ZW51ZScgY29sdW1uIGZvciB0aGUgdmFsdWVzLiIgR2l2aW5nIEFJIGEgY29uY3JldGUgYmVmb3JlLWFuZC1hZnRlciBkZXNjcmlwdGlvbiBwcm9kdWNlcyBtdWNoIG1vcmUgcmVsaWFibGUgYHBpdm90X2xvbmdlcigpYCBjb2RlIHRoYW4gdmFndWUgcmVxdWVzdHMgbGlrZSAibWFrZSBteSBkYXRhIHRpZHkuIg0KOjo6DQoNCiMjIDUuIENvbnRyb2xsaW5nIENoYXJ0IE9yZGVyIHdpdGggZm9yY2F0cw0KDQpCeSBkZWZhdWx0LCBnZ3Bsb3QyIG9yZGVycyBjYXRlZ29yaWNhbCBheGVzICoqYWxwaGFiZXRpY2FsbHkqKi4gVGhpcyBpcyBhbG1vc3QgbmV2ZXIgd2hhdCB5b3Ugd2FudC4gQSBiYXIgY2hhcnQgb3JkZXJlZCBhbHBoYWJldGljYWxseSBtYWtlcyBpdCBoYXJkIHRvIGNvbXBhcmUgdmFsdWVzIGJlY2F1c2UgdGhlIGJhcnMgaGF2ZSBubyBtZWFuaW5nZnVsIHByb2dyZXNzaW9uLg0KDQpUaGUgKipmb3JjYXRzKiogcGFja2FnZSAocGFydCBvZiB0aGUgdGlkeXZlcnNlIC0tIGl0IGxvYWRzIGF1dG9tYXRpY2FsbHkgd2l0aCBgbGlicmFyeSh0aWR5dmVyc2UpYCkgZ2l2ZXMgeW91IGZ1bmN0aW9ucyB0byByZW9yZGVyIGZhY3RvciBsZXZlbHMuIFRoZSB0aHJlZSBtb3N0IHVzZWZ1bCBmb3IgdmlzdWFsaXphdGlvbjoNCg0KfCBGdW5jdGlvbiB8IFdoYXQgaXQgZG9lcyB8IFdoZW4gdG8gdXNlIGl0IHwNCnw6LS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tfDotLS0tLS0tLS0tLS0tLS18DQp8IGBmY3RfcmVvcmRlcihjYXRlZ29yeSwgdmFsdWUpYCB8IFJlb3JkZXIgYnkgYW5vdGhlciB2YXJpYWJsZSB8IEJhciBjaGFydHMgc29ydGVkIGJ5IHZhbHVlIHwNCnwgYGZjdF9pbmZyZXEoY2F0ZWdvcnkpYCB8IE9yZGVyIGJ5IGZyZXF1ZW5jeSB8IEJhciBjaGFydHMgb2YgY291bnRzIHwNCnwgYGZjdF9sdW1wX24oY2F0ZWdvcnksIG4pYCB8IEtlZXAgdG9wIG4sIGx1bXAgcmVzdCBpbnRvICJPdGhlciIgfCBUb28gbWFueSBjYXRlZ29yaWVzIHwNCg0KVGhlIG9uZSB5b3Ugd2lsbCB1c2UgbW9zdCBvZnRlbiBpcyBgZmN0X3Jlb3JkZXIoKWAuIEhlcmUgaXMgdGhlIGRpZmZlcmVuY2UgaXQgbWFrZXM6DQoNCmBgYHtyIHc1LWZjdC11bnNvcnRlZCwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NC41LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBXSVRIT1VUIGZjdF9yZW9yZGVyIOKAlCBhbHBoYWJldGljYWwgb3JkZXIgKGhhcmQgdG8gY29tcGFyZSkNCm1wZyAlPiUNCiAgZ3JvdXBfYnkobWFudWZhY3R1cmVyKSAlPiUNCiAgc3VtbWFyaXNlKGF2Z19od3kgPSBtZWFuKGh3eSksIC5ncm91cHMgPSAiZHJvcCIpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSBhdmdfaHd5LCB5ID0gbWFudWZhY3R1cmVyKSkgKw0KICBnZW9tX2NvbChmaWxsID0gIiMwMDI5NjciKSArDQogIGxhYnModGl0bGUgPSAiQWxwaGFiZXRpY2FsIE9yZGVyIChEZWZhdWx0KSAtLSBIYXJkIHRvIFJlYWQiLA0KICAgICAgIHggPSAiQXZlcmFnZSBIaWdod2F5IE1QRyIsIHkgPSBOVUxMKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTIpDQpgYGANCg0KYGBge3IgdzUtZmN0LXNvcnRlZCwgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9NC41LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBXSVRIIGZjdF9yZW9yZGVyIOKAlCBzb3J0ZWQgYnkgdmFsdWUgKGVhc3kgdG8gY29tcGFyZSkNCm1wZyAlPiUNCiAgZ3JvdXBfYnkobWFudWZhY3R1cmVyKSAlPiUNCiAgc3VtbWFyaXNlKGF2Z19od3kgPSBtZWFuKGh3eSksIC5ncm91cHMgPSAiZHJvcCIpICU+JQ0KICBtdXRhdGUobWFudWZhY3R1cmVyID0gZmN0X3Jlb3JkZXIobWFudWZhY3R1cmVyLCBhdmdfaHd5KSkgJT4lDQogIGdncGxvdChhZXMoeCA9IGF2Z19od3ksIHkgPSBtYW51ZmFjdHVyZXIpKSArDQogIGdlb21fY29sKGZpbGwgPSAiIzAwMjk2NyIpICsNCiAgbGFicyh0aXRsZSA9ICJTb3J0ZWQgYnkgVmFsdWUgLS0gTXVjaCBFYXNpZXIgdG8gUmVhZCIsDQogICAgICAgeCA9ICJBdmVyYWdlIEhpZ2h3YXkgTVBHIiwgeSA9IE5VTEwpICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMikNCmBgYA0KDQpUaGUgb25seSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHR3byBjaGFydHMgaXMgb25lIGxpbmU6IGBtdXRhdGUobWFudWZhY3R1cmVyID0gZmN0X3Jlb3JkZXIobWFudWZhY3R1cmVyLCBhdmdfaHd5KSlgLiBUaGF0IHNpbmdsZSBsaW5lIHRyYW5zZm9ybXMgdGhlIGNoYXJ0IGZyb20gY29uZnVzaW5nIHRvIGNsZWFyLiAqKkFsd2F5cyBzb3J0IHlvdXIgYmFyIGNoYXJ0cyBieSB2YWx1ZSoqIHVubGVzcyB0aGVyZSBpcyBhIG5hdHVyYWwgb3JkZXJpbmcgKGxpa2UgbW9udGhzIG9yIHJhbmtpbmdzKSB0aGF0IHRha2VzIHByaW9yaXR5Lg0KDQo6Ojogey5jYWxsb3V0LXRpcH0NCioqYGZjdF9yZW9yZGVyKClgIGlzIHlvdXIgYmVzdCBmcmllbmQgZm9yIGJhciBjaGFydHMuKiogVGhlIHBhdHRlcm4gaXMgYWx3YXlzIHRoZSBzYW1lOiBgZmN0X3Jlb3JkZXIoY2F0ZWdvcnlfY29sdW1uLCBudW1lcmljX2NvbHVtbilgLiBUaGlzIHJlb3JkZXJzIHRoZSBjYXRlZ29yaWVzIHNvIHRoYXQgdGhleSBhcHBlYXIgaW4gb3JkZXIgb2YgdGhlIG51bWVyaWMgdmFsdWUuIEl0IHdvcmtzIHdpdGggaG9yaXpvbnRhbCBiYXJzIChgeSA9IGZjdF9yZW9yZGVyKC4uLilgKSBhbmQgdmVydGljYWwgYmFycyAoYHggPSBmY3RfcmVvcmRlciguLi4pYCkuDQo6OjoNCg0KIyMgNi4gQSBCcmllZiBOb3RlIG9uIFN0cmluZyBDbGVhbmluZw0KDQpSZWFsLXdvcmxkIGRhdGEgb2Z0ZW4gaGFzIG1lc3N5IHRleHQ6IGluY29uc2lzdGVudCBjYXBpdGFsaXphdGlvbiwgZXh0cmEgd2hpdGVzcGFjZSwgdHlwb3MuIFRoZSAqKnN0cmluZ3IqKiBwYWNrYWdlIChwYXJ0IG9mIHRoZSB0aWR5dmVyc2UpIHByb3ZpZGVzIGZ1bmN0aW9ucyBmb3IgY2xlYW5pbmcgc3RyaW5ncy4gQWxsIHN0cmluZ3IgZnVuY3Rpb25zIHN0YXJ0IHdpdGggYHN0cl9gIGZvciBlYXN5IGRpc2NvdmVyeS4NCg0KWW91IGRvIG5vdCBuZWVkIHRvIG1hc3RlciBzdHJpbmdyIHRoaXMgd2VlaywgYnV0IGhlcmUgYXJlIHRoZSB0aHJlZSBmdW5jdGlvbnMgeW91IGFyZSBtb3N0IGxpa2VseSB0byBuZWVkOg0KDQp8IEZ1bmN0aW9uIHwgV2hhdCBpdCBkb2VzIHwgRXhhbXBsZSB8DQp8Oi0tLS0tLS0tLXw6LS0tLS0tLS0tLS0tLXw6LS0tLS0tLS18DQp8IGBzdHJfdHJpbSgpYCB8IFJlbW92ZXMgbGVhZGluZy90cmFpbGluZyBzcGFjZXMgfCBgIiAgaGVsbG8gICJgIGJlY29tZXMgYCJoZWxsbyJgIHwNCnwgYHN0cl90b19sb3dlcigpYCB8IENvbnZlcnRzIHRvIGxvd2VyY2FzZSB8IGAiSEVMTE8iYCBiZWNvbWVzIGAiaGVsbG8iYCB8DQp8IGBzdHJfdG9fdGl0bGUoKWAgfCBDb252ZXJ0cyB0byB0aXRsZSBjYXNlIHwgYCJoZWxsbyB3b3JsZCJgIGJlY29tZXMgYCJIZWxsbyBXb3JsZCJgIHwNCg0KYGBge3IgdzUtc3RyaW5nci1icmllZiwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCiMgUXVpY2sgZXhhbXBsZTogY2xlYW5pbmcgbWVzc3kgbmFtZSBkYXRhDQptZXNzeV9uYW1lcyA8LSBjKCIgIEpvaG4gU21pdGggICIsICJKQU5FIERPRSIsICJib2Igam9uZXMiKQ0KDQp0aWJibGUoDQogIG9yaWdpbmFsID0gbWVzc3lfbmFtZXMsDQogIGNsZWFuZWQgPSBtZXNzeV9uYW1lcyAlPiUgc3RyX3RyaW0oKSAlPiUgc3RyX3RvX3RpdGxlKCkNCikNCmBgYA0KDQpJZiB5b3UgbmVlZCBtb3JlIHN0cmluZyBtYW5pcHVsYXRpb24gaW4gYSBmdXR1cmUgcHJvamVjdCwgdGhlICpSIGZvciBEYXRhIFNjaWVuY2UqIGNoYXB0ZXIgb24gc3RyaW5ncyBpcyBhbiBleGNlbGxlbnQgcmVmZXJlbmNlOiBbaHR0cHM6Ly9yNGRzLmhhZGxleS5uei9zdHJpbmdzXShodHRwczovL3I0ZHMuaGFkbGV5Lm56L3N0cmluZ3MpLg0KDQojIyA3LiBQdXR0aW5nIEl0IEFsbCBUb2dldGhlcjogQSBDb21wbGV0ZSBQaXBlbGluZQ0KDQpUaGlzIGlzIHRoZSBzZWN0aW9uIHdoZXJlIGV2ZXJ5dGhpbmcgY29ubmVjdHMuIFdlIHdpbGwgYnVpbGQgYSBjb21wbGV0ZSBwaXBlbGluZSBzdGVwIGJ5IHN0ZXAsIHNob3dpbmcgdGhlIG91dHB1dCBhZnRlciBlYWNoIG9wZXJhdGlvbiBzbyB5b3UgY2FuIHNlZSBleGFjdGx5IHdoYXQgZWFjaCB2ZXJiIGRvZXMgdG8gdGhlIGRhdGEuDQoNCk91ciBnb2FsOiBDcmVhdGUgYSBwb2xpc2hlZCB2aXN1YWxpemF0aW9uIG9mIFUuUy4gdW5lbXBsb3ltZW50IHRyZW5kcyBmcm9tIDIwMDAgdG8gMjAxNSwgc3RhcnRpbmcgZnJvbSB0aGUgcmF3IGBlY29ub21pY3NgIGRhdGFzZXQgYnVpbHQgaW50byBnZ3Bsb3QyLg0KDQoqKlN0ZXAgMTogTG9vayBhdCB0aGUgcmF3IGRhdGEqKg0KDQpgYGB7ciB3NS1waXBlbGluZS1zdGVwMSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0NCiMgV2hhdCBkb2VzIHRoZSByYXcgZGF0YSBsb29rIGxpa2U/DQplY29ub21pY3MgJT4lDQogIGhlYWQoNSkNCmBgYA0KDQpUaGUgYGVjb25vbWljc2AgZGF0YXNldCBoYXMgY29sdW1ucyBmb3IgZGF0ZSwgcG9wdWxhdGlvbiAoYHBvcGApLCB1bmVtcGxveW1lbnQgY291bnQgKGB1bmVtcGxveWApLCBhbmQgb3RoZXJzLiBCdXQgaXQgZG9lcyBub3QgaGF2ZSBhbiB1bmVtcGxveW1lbnQgKnJhdGUqLiBXZSBuZWVkIHRvIGNvbXB1dGUgdGhhdC4NCg0KKipTdGVwIDI6IFNlbGVjdCB0aGUgY29sdW1ucyB3ZSBuZWVkKioNCg0KYGBge3IgdzUtcGlwZWxpbmUtc3RlcDIsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQojIE5hcnJvdyBkb3duIHRvIGp1c3QgdGhlIGNvbHVtbnMgd2UgbmVlZA0KZWNvbm9taWNzICU+JQ0KICBzZWxlY3QoZGF0ZSwgdW5lbXBsb3ksIHBvcCkgJT4lDQogIGhlYWQoNSkNCmBgYA0KDQpXZSBvbmx5IG5lZWQgYGRhdGVgLCBgdW5lbXBsb3lgIChudW1iZXIgb2YgdW5lbXBsb3llZCBwZXJzb25zLCBpbiB0aG91c2FuZHMpLCBhbmQgYHBvcGAgKHRvdGFsIHBvcHVsYXRpb24sIGluIHRob3VzYW5kcykuIEV2ZXJ5dGhpbmcgZWxzZSBpcyBjbHV0dGVyLg0KDQoqKlN0ZXAgMzogQ3JlYXRlIHRoZSB1bmVtcGxveW1lbnQgcmF0ZSoqDQoNCmBgYHtyIHc1LXBpcGVsaW5lLXN0ZXAzLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBDb21wdXRlIHVuZW1wbG95bWVudCByYXRlIGFzIGEgcGVyY2VudGFnZQ0KZWNvbm9taWNzICU+JQ0KICBzZWxlY3QoZGF0ZSwgdW5lbXBsb3ksIHBvcCkgJT4lDQogIG11dGF0ZSh1bmVtcGxveV9yYXRlID0gdW5lbXBsb3kgLyBwb3AgKiAxMDApICU+JQ0KICBoZWFkKDUpDQpgYGANCg0KTm93IHdlIGhhdmUgYW4gYHVuZW1wbG95X3JhdGVgIGNvbHVtbiB0aGF0IHdlIGNhbiBwbG90IG9uIHRoZSB5LWF4aXMuDQoNCioqU3RlcCA0OiBGaWx0ZXIgdG8gb3VyIHRpbWUgcGVyaW9kKioNCg0KYGBge3IgdzUtcGlwZWxpbmUtc3RlcDQsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9DQojIEtlZXAgb25seSByb3dzIGZyb20gMjAwMCBvbndhcmQNCmVjb25vbWljcyAlPiUNCiAgc2VsZWN0KGRhdGUsIHVuZW1wbG95LCBwb3ApICU+JQ0KICBtdXRhdGUodW5lbXBsb3lfcmF0ZSA9IHVuZW1wbG95IC8gcG9wICogMTAwKSAlPiUNCiAgZmlsdGVyKGRhdGUgPj0gIjIwMDAtMDEtMDEiKSAlPiUNCiAgaGVhZCg1KQ0KYGBgDQoNCldlIGZpbHRlciB0byBKYW51YXJ5IDIwMDAgYW5kIGxhdGVyIGJlY2F1c2Ugd2Ugd2FudCB0byBmb2N1cyBvbiB0aGUgbW9kZXJuIGVyYSwgaW5jbHVkaW5nIHRoZSAyMDA4IGZpbmFuY2lhbCBjcmlzaXMuDQoNCioqU3RlcCA1OiBTYXZlIGFuZCBwbG90KioNCg0KYGBge3IgdzUtcGlwZWxpbmUtc3RlcDUsIGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD01LCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQ0KIyBTdG9yZSB0aGUgd3JhbmdsZWQgZGF0YSwgdGhlbiBwbG90IGl0DQplY29ub21pY3NfY2xlYW4gPC0gZWNvbm9taWNzICU+JQ0KICBzZWxlY3QoZGF0ZSwgdW5lbXBsb3ksIHBvcCkgJT4lDQogIG11dGF0ZSh1bmVtcGxveV9yYXRlID0gdW5lbXBsb3kgLyBwb3AgKiAxMDApICU+JQ0KICBmaWx0ZXIoZGF0ZSA+PSAiMjAwMC0wMS0wMSIpDQoNCmdncGxvdChlY29ub21pY3NfY2xlYW4sIGFlcyh4ID0gZGF0ZSwgeSA9IHVuZW1wbG95X3JhdGUpKSArDQogIGdlb21fYXJlYShmaWxsID0gIiMwMDI5NjciLCBhbHBoYSA9IDAuMykgKw0KICBnZW9tX2xpbmUoY29sb3IgPSAiIzAwMjk2NyIsIGxpbmV3aWR0aCA9IDAuOCkgKw0KICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSBhcy5EYXRlKCIyMDA4LTA5LTE1IiksDQogICAgICAgICAgICAgbGluZXR5cGUgPSAiZGFzaGVkIiwgY29sb3IgPSAiI0M0MUUzQSIpICsNCiAgYW5ub3RhdGUoInRleHQiLCB4ID0gYXMuRGF0ZSgiMjAwOS0wNi0wMSIpLCB5ID0gNi41LA0KICAgICAgICAgICBsYWJlbCA9ICJGaW5hbmNpYWxcbkNyaXNpcyIsIGNvbG9yID0gIiNDNDFFM0EiLA0KICAgICAgICAgICBmb250ZmFjZSA9ICJib2xkIiwgc2l6ZSA9IDMuNSkgKw0KICBsYWJzKHRpdGxlID0gIlUuUy4gVW5lbXBsb3ltZW50IFJhdGUgKDIwMDBcdTIwMTMyMDE1KSIsDQogICAgICAgc3VidGl0bGUgPSAiUGlwZWxpbmU6IHNlbGVjdCBcdTIxOTIgbXV0YXRlIFx1MjE5MiBmaWx0ZXIgXHUyMTkyIHBsb3QiLA0KICAgICAgIHggPSBOVUxMLCB5ID0gIlVuZW1wbG95bWVudCBSYXRlICglKSIpICsNCiAgdGhlbWVfbWluaW1hbChiYXNlX3NpemUgPSAxMykNCmBgYA0KDQpIZXJlIGlzIHRoZSBwYXR0ZXJuIGxhaWQgYmFyZToNCg0KMS4gKipgc2VsZWN0KClgKiogbmFycm93cyBkb3duIHRvIHRoZSBjb2x1bW5zIHdlIG5lZWQNCjIuICoqYG11dGF0ZSgpYCoqIGNvbXB1dGVzIHRoZSB1bmVtcGxveW1lbnQgKnJhdGUqIGZyb20gcmF3IGNvdW50cw0KMy4gKipgZmlsdGVyKClgKiogcmVzdHJpY3RzIHRvIHRoZSB0aW1lIHBlcmlvZCBvZiBpbnRlcmVzdA0KNC4gKipgZ2dwbG90KClgKiogbWFwcyB0aGUgd3JhbmdsZWQgZGF0YSB0byB2aXN1YWwgZm9ybQ0KDQpUaGlzIGlzIHRoZSBwYXR0ZXJuIHlvdSB3aWxsIHVzZSBhZ2FpbiBhbmQgYWdhaW46ICoqd3JhbmdsZSBmaXJzdCwgdGhlbiBwbG90LioqDQoNCjo6OiB7LmNhbGxvdXQtaW5mb30NCioqV2h5IHNlcGFyYXRlIHRoZSB3cmFuZ2xpbmcgZnJvbSB0aGUgcGxvdHRpbmc/KiogS2VlcGluZyB0aGVtIGluIGRpc3RpbmN0IHN0ZXBzIChldmVuIGlmIHlvdSBjb3VsZCBjb21iaW5lIHRoZW0pIG1ha2VzIHlvdXIgY29kZSBlYXNpZXIgdG8gZGVidWcuIElmIHRoZSBwbG90IGxvb2tzIHdyb25nLCB5b3UgY2FuIGluc3BlY3QgdGhlIGludGVybWVkaWF0ZSBkYXRhIGZyYW1lIChgZWNvbm9taWNzX2NsZWFuYCkgdG8gc2VlIHdoZXRoZXIgdGhlIHByb2JsZW0gaXMgaW4gdGhlIHdyYW5nbGluZyBvciB0aGUgdmlzdWFsaXphdGlvbi4gRGVidWcgb25lIHRoaW5nIGF0IGEgdGltZS4NCjo6Og0KDQo6Ojogey5jYWxsb3V0LWlnbmF0aWFufQ0KIyMgSWduYXRpYW4gUmVmbGVjdGlvbjogRGF0YSBhcyBIdW1hbiBTdG9yaWVzDQoNCkRhdGEgd3JhbmdsaW5nIGlzIG5vdCBtZXJlbHkgYSB0ZWNobmljYWwgZXhlcmNpc2UuIEl0IGlzIGFuICoqYWN0IG9mIGNhcmUqKi4gQmVoaW5kIGV2ZXJ5IHJvdyBpbiBhIGRhdGFzZXQgaXMgYSBwZXJzb24sIGEgY29tbXVuaXR5LCBhIGxpdmVkIGV4cGVyaWVuY2UuIFdoZW4gd2UgY2xlYW4gZGF0YSwgd2UgbWFrZSBjaG9pY2VzIC0tIHdoYXQgdG8ga2VlcCwgd2hhdCB0byBkaXNjYXJkLCB3aGF0IHRvIHRyYW5zZm9ybS4gVGhlc2UgY2hvaWNlcyBzaGFwZSB0aGUgc3RvcmllcyB0aGUgZGF0YSBjYW4gdGVsbC4NCg0KVGhlIEplc3VpdCBwcmluY2lwbGUgb2YgKipDdXJhIFBlcnNvbmFsaXMqKiAtLSBjYXJlIGZvciB0aGUgd2hvbGUgcGVyc29uIC0tIGV4dGVuZHMgdG8gaG93IHdlIGhhbmRsZSBkYXRhLiBDbGVhbmluZyBkYXRhIHJlc3BlY3RmdWxseSBtZWFuczoNCg0KLSAqKk5vdCBlcmFzaW5nIG91dGxpZXJzKiogd2l0aG91dCB1bmRlcnN0YW5kaW5nIHdobyB0aGV5IHJlcHJlc2VudA0KLSAqKlByZXNlcnZpbmcgY29udGV4dCoqIHJhdGhlciB0aGFuIHJlZHVjaW5nIHBlb3BsZSB0byBudW1iZXJzDQotICoqUXVlc3Rpb25pbmcgY2F0ZWdvcmllcyoqIHRoYXQgbWF5IHJlZmxlY3QgYmlhcyBvciBvdmVyc2ltcGxpZmljYXRpb24NCg0KKipEaXNjZXJubWVudCoqIC0tIGEgY29yZSBJZ25hdGlhbiBwcmFjdGljZSAtLSBhcHBsaWVzIGRpcmVjdGx5IHRvIHdyYW5nbGluZy4gV2hlbiB5b3UgZmlsdGVyIHJvd3MsIHlvdSBkZWNpZGUgd2hvc2Ugc3RvcmllcyBhcmUgdG9sZC4gV2hlbiB5b3UgZ3JvdXAgYW5kIHN1bW1hcmlzZSwgeW91IGRlY2lkZSB3aGF0IHBhdHRlcm5zIGFyZSBoaWdobGlnaHRlZC4gQXBwcm9hY2ggdGhlc2UgZGVjaXNpb25zIHdpdGggdGhlIHNhbWUgdGhvdWdodGZ1bG5lc3MgYW5kIGV0aGljYWwgYXdhcmVuZXNzIHRoYXQgSWduYXRpYW4gc3Bpcml0dWFsaXR5IGNhbGxzIHVzIHRvIGJyaW5nIHRvIGFsbCBvdXIgd29yay4NCg0KQXNrIHlvdXJzZWxmOiAqV2hvIGlzIGluY2x1ZGVkIGluIHRoaXMgZGF0YXNldD8gV2hvIGlzIGV4Y2x1ZGVkPyBXaGF0IGFzc3VtcHRpb25zIGFtIEkgbWFraW5nIHdoZW4gSSBjbGVhbiBhbmQgcmVzaGFwZSB0aGlzIGRhdGE/Kg0KOjo6DQoNCiMjIDguIFF1aWNrIFJlZmVyZW5jZQ0KDQpIZXJlIGlzIGEgb25lLXBhZ2Ugc3VtbWFyeSBvZiBldmVyeXRoaW5nIGNvdmVyZWQgdGhpcyB3ZWVrLiBCb29rbWFyayB0aGlzIHNlY3Rpb24gZm9yIHdoZW4geW91IGFyZSB3b3JraW5nIG9uIGFzc2lnbm1lbnRzLg0KDQoqKlRoZSBzaXggZHBseXIgdmVyYnM6KioNCg0KYGBgDQpkYXRhICU+JQ0KICBmaWx0ZXIoY29uZGl0aW9uKSAgICAgICAgIyBrZWVwIHJvd3Mgd2hlcmUgY29uZGl0aW9uIGlzIFRSVUUNCiAgc2VsZWN0KGNvbDEsIGNvbDIpICAgICAgICMga2VlcCBvbmx5IHRoZXNlIGNvbHVtbnMNCiAgbXV0YXRlKG5ldyA9IGV4cHIpICAgICAgICMgY3JlYXRlIGEgbmV3IGNvbHVtbg0KICBncm91cF9ieShjYXRlZ29yeSkgICAgICAgIyBzZXQgdXAgZ3JvdXBzDQogIHN1bW1hcmlzZShzdGF0ID0gZm4oeCkpICAjIGNvbGxhcHNlIHRvIHN1bW1hcnkgc3RhdGlzdGljcw0KICBhcnJhbmdlKGRlc2MoY29sdW1uKSkgICAgIyBzb3J0IHJvd3MNCmBgYA0KDQoqKlBpdm90aW5nOioqDQoNCmBgYA0Kd2lkZV9kYXRhICU+JQ0KICBwaXZvdF9sb25nZXIoY29scyA9IGNvbHVtbnNfdG9fcGl2b3QsDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJuZXdfY2F0ZWdvcnlfY29sdW1uIiwNCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJuZXdfdmFsdWVfY29sdW1uIikNCmBgYA0KDQoqKlJlb3JkZXJpbmcgZm9yIHBsb3RzOioqDQoNCmBgYA0KbXV0YXRlKGNhdGVnb3J5ID0gZmN0X3Jlb3JkZXIoY2F0ZWdvcnksIG51bWVyaWNfdmFsdWUpKQ0KYGBgDQoNCioqVGhlIGZ1bGwgcGF0dGVybjoqKg0KDQpgYGANCmRhdGEgJT4lDQogICMgd3JhbmdsZQ0KICBmaWx0ZXIoLi4uKSAlPiUNCiAgbXV0YXRlKC4uLikgJT4lDQogIGdyb3VwX2J5KC4uLikgJT4lDQogIHN1bW1hcmlzZSguLi4sIC5ncm91cHMgPSAiZHJvcCIpICU+JQ0KICAjIHBsb3QNCiAgZ2dwbG90KGFlcyguLi4pKSArDQogIGdlb21fLi4uKCkgKw0KICBsYWJzKC4uLikgKw0KICB0aGVtZV9taW5pbWFsKCkNCmBgYA0KDQo6Ojogey5jYWxsb3V0LWluZm99DQoqKkZvciBmdXR1cmUgcmVmZXJlbmNlOioqIFR3byBhZHZhbmNlZCBkcGx5ciBmZWF0dXJlcyB5b3UgbWF5IGVuY291bnRlciBpbiBvbmxpbmUgY29kZSBleGFtcGxlcyBhcmUgYGFjcm9zcygpYCAod2hpY2ggYXBwbGllcyBhIGZ1bmN0aW9uIHRvIG11bHRpcGxlIGNvbHVtbnMgYXQgb25jZSkgYW5kIHRoZSBgLmJ5YCBhcmd1bWVudCAoYSBtb2Rlcm4gYWx0ZXJuYXRpdmUgdG8gYGdyb3VwX2J5KClgIHRoYXQgYXV0b21hdGljYWxseSB1bmdyb3VwcyB0aGUgcmVzdWx0KS4gWW91IGRvIG5vdCBuZWVkIHRoZXNlIGZvciB0aGlzIGNvdXJzZSwgYnV0IHRoZXkgYXJlIHVzZWZ1bCB0byByZWNvZ25pemUgaWYgeW91IHNlZSB0aGVtLg0KOjo6DQoNCi0tLQ0KDQojIyBDaGFsbGVuZ2U6IFBpcGUgRHJlYW0NCg0KPGRpdiBjbGFzcz0ic2FuZGJveC1zZWN0aW9uIj4NCjxkaXYgY2xhc3M9InNhbmRib3gtaGVhZGVyIj4NCjxzcGFuIGNsYXNzPSJzYW5kYm94LWljb24iPvCfjq48L3NwYW4+IFBpcGUgRHJlYW0g4oCUIEdldCB0aGUgdmVyYnMgaW4gb3JkZXIgb3IgdGhlIHBpcGVsaW5lIGJyZWFrcw0KPC9kaXY+DQo8aWZyYW1lIGNsYXNzPSJzYW5kYm94LWZyYW1lIiBzcmM9Imh0dHBzOi8vYW5hbHl0aWNzLmdvbnphZ2EuZWR1L3dlZWswNS1nYW1lLyINCiAgICAgICAgaGVpZ2h0PSI3MDAiIGxvYWRpbmc9ImxhenkiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4NCjxkaXYgY2xhc3M9InNhbmRib3gtY29sZC1zdGFydCI+DQpJZiB0aGUgYXBwIHRha2VzIGEgZmV3IHNlY29uZHMgdG8gbG9hZCBvbiBmaXJzdCB2aXNpdCwgdGhhdCBpcyBub3JtYWwg4oCUIHRoZSBzZXJ2ZXIgaXMgd2FraW5nIHVwLg0KPC9kaXY+DQo8L2Rpdj4NCg0KOjo6IHsudHJ5LWl0LWJveH0NCioqSG93IHRvIFBsYXk6KioNCg0KMS4gRW50ZXIgeW91ciBuYW1lIGFuZCBjbGljayAqKlN0YXJ0IEdhbWUqKg0KMi4gRWFjaCByb3VuZCBkZXNjcmliZXMgYSBkYXRhIHdyYW5nbGluZyBnb2FsIGluIHBsYWluIEVuZ2xpc2gNCjMuIERyYWcgZHBseXIgdmVyYiBjYXJkcyBpbnRvIHRoZSBjb3JyZWN0IHBpcGVsaW5lIG9yZGVyLCB0aGVuIHByZWRpY3QgdGhlIHJlc3VsdGluZyByb3dzIGFuZCBjb2x1bW5zDQo0LiBDb21wbGV0ZSBhbGwgOCByb3VuZHMsIHRoZW4gY29weSB5b3VyIGNvbXBsZXRpb24gcmVwb3J0IGludG8gdGhlIENhbnZhcyBhc3NpZ25tZW50DQo6OjoNCg0KLS0tDQoNCiMjIDkuIEV4ZXJjaXNlcw0KDQo6Ojogey5leGVyY2lzZS1ibG9ja30NCjo6OiB7LmV4ZXJjaXNlLWhlYWRlcn0NCkV4ZXJjaXNlIDE6IFN0b3JtIEFuYWx5c2lzIHdpdGggZHBseXINCjo6Og0KOjo6IHsuZXhlcmNpc2UtYm9keX0NClVzaW5nIHRoZSBgc3Rvcm1zYCBkYXRhc2V0IChidWlsdCBpbnRvIGRwbHlyKSwgY29tcGxldGUgdGhlIGZvbGxvd2luZyBwaXBlbGluZS4gRmlsbCBpbiBlYWNoIGJsYW5rIChgX19fYCkgdG8gbWFrZSB0aGUgY29kZSB3b3JrLg0KDQoqKllvdXIgdGFzazoqKiBGaW5kIHRoZSB0b3AgMTAgc3Ryb25nZXN0IGh1cnJpY2FuZXMgKENhdGVnb3J5IDQgYW5kIGFib3ZlKSBhbmQgY3JlYXRlIGEgbG9sbGlwb3AgY2hhcnQgc2hvd2luZyB0aGVpciBtYXhpbXVtIHdpbmQgc3BlZWRzLg0KDQpgYGB7ciB3NS1leGVyY2lzZTEtc3RhcnRlciwgZXZhbD1GQUxTRX0NCnN0b3JtcyAlPiUNCiAgZmlsdGVyKF9fXyA+PSA0KSAlPiUNCiAgZ3JvdXBfYnkoX19fKSAlPiUNCiAgc3VtbWFyaXNlKG1heF93aW5kID0gbWF4KF9fXyksIC5ncm91cHMgPSAiZHJvcCIpICU+JQ0KICBzbGljZV9tYXgobWF4X3dpbmQsIG4gPSBfX18pICU+JQ0KICBtdXRhdGUobmFtZSA9IGZjdF9yZW9yZGVyKG5hbWUsIG1heF93aW5kKSkgJT4lDQogIGdncGxvdChhZXMoeCA9IG1heF93aW5kLCB5ID0gbmFtZSkpICsNCiAgZ2VvbV9zZWdtZW50KGFlcyh4ID0gMCwgeGVuZCA9IG1heF93aW5kLCB5ID0gbmFtZSwgeWVuZCA9IG5hbWUpLA0KICAgICAgICAgICAgICAgY29sb3IgPSAiI0I0OTc1QSIsIGxpbmV3aWR0aCA9IDEpICsNCiAgZ2VvbV9wb2ludChjb2xvciA9ICIjMDAyOTY3Iiwgc2l6ZSA9IDQpICsNCiAgbGFicyh0aXRsZSA9ICJUb3AgMTAgU3Ryb25nZXN0IEh1cnJpY2FuZXMgKENhdGVnb3J5IDQrKSIsDQogICAgICAgeCA9ICJNYXhpbXVtIFdpbmQgU3BlZWQgKGtub3RzKSIsIHkgPSBOVUxMKSArDQogIHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTMpDQpgYGANCg0KKipIaW50czoqKg0KDQotIFRoZSBjb2x1bW4gZm9yIGh1cnJpY2FuZSBjYXRlZ29yeSBpcyBjYWxsZWQgYGNhdGVnb3J5YA0KLSBHcm91cCBieSBgbmFtZWAgdG8gZ2V0IG9uZSByb3cgcGVyIHN0b3JtDQotIFVzZSBgbWF4KHdpbmQpYCB0byBmaW5kIHRoZSBoaWdoZXN0IHdpbmQgc3BlZWQgcGVyIHN0b3JtDQotIGBzbGljZV9tYXgoKWAga2VlcHMgdGhlIHRvcCBuIHJvd3MgYnkgYSBnaXZlbiBjb2x1bW4NCjo6Og0KOjo6DQoNCjo6OiB7LmV4ZXJjaXNlLWJsb2NrfQ0KOjo6IHsuZXhlcmNpc2UtaGVhZGVyfQ0KRXhlcmNpc2UgMjogUGl2b3RpbmcgUHJhY3RpY2UNCjo6Og0KOjo6IHsuZXhlcmNpc2UtYm9keX0NClRoZSBgdGFibGU0YWAgZGF0YXNldCAoYnVpbHQgaW50byB0aWR5cikgc3RvcmVzIFRCIGNhc2UgY291bnRzIGluIHdpZGUgZm9ybWF0LCB3aXRoIHllYXJzIGFzIGNvbHVtbiBuYW1lcy4gWW91ciBqb2I6IHBpdm90IGl0IHRvIHRpZHkgZm9ybWF0IGFuZCBjcmVhdGUgYSBsaW5lIGNoYXJ0Lg0KDQpgYGB7ciB3NS1leGVyY2lzZTItc3RhcnRlciwgZXZhbD1GQUxTRX0NCiMgU3RlcCAxOiBMb29rIGF0IHRoZSBkYXRhDQp0YWJsZTRhDQoNCiMgU3RlcCAyOiBQaXZvdCBhbmQgcGxvdA0KdGFibGU0YSAlPiUNCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSBjKGBfX19gLCBgX19fYCksDQogICAgICAgICAgICAgICBuYW1lc190byA9ICJfX18iLA0KICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIl9fXyIpICU+JQ0KICBtdXRhdGUoeWVhciA9IGFzLmludGVnZXIoeWVhcikpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSBfX18sIHkgPSBfX18sIGNvbG9yID0gX19fKSkgKw0KICBnZW9tX2xpbmUobGluZXdpZHRoID0gMS4yKSArDQogIGdlb21fcG9pbnQoc2l6ZSA9IDMpICsNCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoIkFmZ2hhbmlzdGFuIiA9ICIjMDAyOTY3IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJyYXppbCIgPSAiI0M0MUUzQSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDaGluYSIgPSAiI0I0OTc1QSIpKSArDQogIGxhYnModGl0bGUgPSAiVEIgQ2FzZXMgYnkgQ291bnRyeSIsDQogICAgICAgeCA9ICJZZWFyIiwgeSA9ICJDYXNlcyIsIGNvbG9yID0gTlVMTCkgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDEzKQ0KYGBgDQoNCioqSGludHM6KioNCg0KLSBgdGFibGU0YWAgaGFzIGNvbHVtbnMgbmFtZWQgYDE5OTlgIGFuZCBgMjAwMGAgLS0gc2luY2UgdGhleSBzdGFydCB3aXRoIG51bWJlcnMsIHdyYXAgdGhlbSBpbiBiYWNrdGlja3MNCi0gYG5hbWVzX3RvYCBzaG91bGQgYmUgYCJ5ZWFyImAgYW5kIGB2YWx1ZXNfdG9gIHNob3VsZCBiZSBgImNhc2VzImANCi0gSW4gdGhlIGdncGxvdCBhZXN0aGV0aWNzLCBtYXAgYHggPSB5ZWFyYCwgYHkgPSBjYXNlc2AsIGBjb2xvciA9IGNvdW50cnlgDQo6OjoNCjo6Og0KDQo6Ojogey5leGVyY2lzZS1ibG9ja30NCjo6OiB7LmV4ZXJjaXNlLWhlYWRlcn0NCkV4ZXJjaXNlIDM6IENvbXBsZXRlIGRwbHlyIFBpcGVsaW5lDQo6OjoNCjo6OiB7LmV4ZXJjaXNlLWJvZHl9DQpCdWlsZCBhIGNvbXBsZXRlIHBpcGVsaW5lIHRoYXQgZmlsdGVycywgc3VtbWFyaXNlcywgcmVvcmRlcnMsIGFuZCBwbG90cyB0aGUgYG1wZ2AgZGF0YXNldC4NCg0KKipZb3VyIHRhc2s6KiogQ3JlYXRlIGEgaG9yaXpvbnRhbCBiYXIgY2hhcnQgc2hvd2luZyB0aGUgYXZlcmFnZSBoaWdod2F5IE1QRyBmb3IgZWFjaCBtYW51ZmFjdHVyZXIsIHVzaW5nIG9ubHkgMjAwOCB2ZWhpY2xlcywgc29ydGVkIGZyb20gaGlnaGVzdCB0byBsb3dlc3QuDQoNCmBgYHtyIHc1LWV4ZXJjaXNlMy1zdGFydGVyLCBldmFsPUZBTFNFfQ0KbXBnICU+JQ0KICBmaWx0ZXIoeWVhciA9PSBfX18pICU+JQ0KICBncm91cF9ieShfX18pICU+JQ0KICBzdW1tYXJpc2UoYXZnX2h3eSA9IG1lYW4oX19fKSwgLmdyb3VwcyA9ICJkcm9wIikgJT4lDQogIG11dGF0ZShtYW51ZmFjdHVyZXIgPSBmY3RfcmVvcmRlcihfX18sIF9fXykpICU+JQ0KICBnZ3Bsb3QoYWVzKHggPSBfX18sIHkgPSBfX18pKSArDQogIGdlb21fY29sKGZpbGwgPSAiX19fIikgKw0KICBsYWJzKHRpdGxlID0gIkF2ZXJhZ2UgSGlnaHdheSBNUEcgYnkgTWFudWZhY3R1cmVyICgyMDA4IE1vZGVscykiLA0KICAgICAgIHggPSAiSGlnaHdheSBNUEciLCB5ID0gTlVMTCkgKw0KICB0aGVtZV9taW5pbWFsKGJhc2Vfc2l6ZSA9IDEzKQ0KYGBgDQoNCioqSGludHM6KioNCg0KLSBGaWx0ZXIgYHllYXIgPT0gMjAwOGANCi0gR3JvdXAgYnkgYG1hbnVmYWN0dXJlcmANCi0gYG1lYW4oaHd5KWAgZ2l2ZXMgeW91IHRoZSBhdmVyYWdlIGhpZ2h3YXkgTVBHDQotIGBmY3RfcmVvcmRlcihtYW51ZmFjdHVyZXIsIGF2Z19od3kpYCByZW9yZGVycyBtYW51ZmFjdHVyZXJzIGJ5IHRoZWlyIGF2ZXJhZ2UNCi0gTWFwIGB4ID0gYXZnX2h3eWAgYW5kIGB5ID0gbWFudWZhY3R1cmVyYCBmb3IgYSBob3Jpem9udGFsIGJhciBjaGFydA0KLSBHb256YWdhIG5hdnkgaXMgYCIjMDAyOTY3ImANCjo6Og0KOjo6DQoNCjo6OiB7LmV4ZXJjaXNlLWJsb2NrfQ0KOjo6IHsuZXhlcmNpc2UtaGVhZGVyfQ0KRXhlcmNpc2UgNDogUmVhZGluZyBhbmQgUmVmbGVjdGlvbg0KOjo6DQo6Ojogey5leGVyY2lzZS1ib2R5fQ0KUmVhZCAqKkNoYXB0ZXIgNDogRGF0YSBUcmFuc2Zvcm1hdGlvbioqIGZyb20gKlIgZm9yIERhdGEgU2NpZW5jZSogKDJuZCBlZGl0aW9uKSBieSBIYWRsZXkgV2lja2hhbSwgTWluZSBDZXRpbmtheWEtUnVuZGVsLCBhbmQgR2FycmV0dCBHcm9sZW11bmQ6DQoNCltodHRwczovL3I0ZHMuaGFkbGV5Lm56L2RhdGEtdHJhbnNmb3JtXShodHRwczovL3I0ZHMuaGFkbGV5Lm56L2RhdGEtdHJhbnNmb3JtKQ0KDQpBcyB5b3UgcmVhZCwgcGF5IGF0dGVudGlvbiB0bzoNCg0KLSBUaGUgZml2ZSBrZXkgZHBseXIgdmVyYnMgYW5kIGhvdyB0aGV5IHJlbGF0ZSB0byB3aGF0IHdlIGNvdmVyZWQgdGhpcyB3ZWVrDQotIFRoZSBgfD5gIChiYXNlIFIpIHBpcGUgdnMuIHRoZSBgJT4lYCAobWFncml0dHIpIHBpcGUgLS0gaG93IGFyZSB0aGV5IHNpbWlsYXIgYW5kIGRpZmZlcmVudD8NCi0gQW55IGZ1bmN0aW9ucyBvciBwYXR0ZXJucyB0aGF0IHdlcmUgbmV3IHRvIHlvdQ0KDQoqKldyaXRlIGEgc2hvcnQgcmVmbGVjdGlvbiAoMy0tNSBzZW50ZW5jZXMpKiogb24gb25lIG5ldyB0aGluZyB5b3UgbGVhcm5lZCBmcm9tIHRoZSBjaGFwdGVyIHRoYXQgeW91IGRpZCBub3QgYWxyZWFkeSBrbm93IGZyb20gdGhpcyB3ZWVrJ3MgbWF0ZXJpYWxzLg0KOjo6DQo6OjoNCg0KIyMgMTAuIEF0dHJpYnV0aW9ucw0KDQotIFdpY2toYW0sIEguICgyMDE0KS4gIlRpZHkgRGF0YS4iICpKb3VybmFsIG9mIFN0YXRpc3RpY2FsIFNvZnR3YXJlKiwgNTkoMTApLiBbaHR0cHM6Ly9kb2kub3JnLzEwLjE4NjM3L2pzcy52MDU5LmkxMF0oaHR0cHM6Ly9kb2kub3JnLzEwLjE4NjM3L2pzcy52MDU5LmkxMCkNCi0gV2lja2hhbSwgSC4sIENldGlua2F5YS1SdW5kZWwsIE0uLCAmIEdyb2xlbXVuZCwgRy4gLS0gKlIgZm9yIERhdGEgU2NpZW5jZSogKDJuZCBlZC4pLiBbaHR0cHM6Ly9yNGRzLmhhZGxleS5uel0oaHR0cHM6Ly9yNGRzLmhhZGxleS5ueikNCi0gVml2ZWsgSC4gUGF0aWwgLS0gZm91bmRhdGlvbmFsIGNvdXJzZSBtYXRlcmlhbHMNCi0gR29uemFnYSBVbml2ZXJzaXR5IC0tIElnbmF0aWFuIHBlZGFnb2dpY2FsIGZyYW1ld29yaw0KDQo8ZGl2IGNsYXNzPSJwYWdlLW5hdiI+DQo8YSBocmVmPSJ3ZWVrMDQuaHRtbCI+JmxhcnI7IFdlZWsgNDwvYT4NCjxhIGhyZWY9IndlZWswNi5odG1sIj5XZWVrIDYgJnJhcnI7PC9hPg0KPC9kaXY+DQo=</div>
<footer style="background:#002967; color:rgba(255,255,255,.75); padding:2.5rem 0 1.5rem; margin-top:3rem;">
<div class="container-fluid" style="max-width:1100px; margin:0 auto; padding:0 2rem;">
  <div class="row">
    <div class="col-md-5">
      <h5 style="color:#fff; font-size:.95rem;">Data Visualization &mdash; Gonzaga University</h5>
      <p style="font-size:.85rem;">School of Business Administration. A course in the Jesuit tradition of intellectual rigor, ethical inquiry, and service to the common good.</p>
    </div>
    <div class="col-md-2">
      <h5 style="color:#fff; font-size:.95rem;">References</h5>
      <ul style="list-style:none; padding:0; font-size:.85rem;">
        <li><a href="https://clauswilke.com/dataviz/" target="_blank" style="color:rgba(255,255,255,.7);">Wilke Textbook</a></li>
        <li><a href="https://socviz.co/" target="_blank" style="color:rgba(255,255,255,.7);">Healy Textbook</a></li>
        <li><a href="https://ggplot2-book.org/" target="_blank" style="color:rgba(255,255,255,.7);">ggplot2 Book</a></li>
      </ul>
    </div>
    <div class="col-md-2">
      <h5 style="color:#fff; font-size:.95rem;">Tools</h5>
      <ul style="list-style:none; padding:0; font-size:.85rem;">
        <li><a href="https://www.r-project.org/" target="_blank" style="color:rgba(255,255,255,.7);">Download R</a></li>
        <li><a href="https://posit.co/downloads/" target="_blank" style="color:rgba(255,255,255,.7);">RStudio</a></li>
        <li><a href="https://www.tidyverse.org/" target="_blank" style="color:rgba(255,255,255,.7);">Tidyverse</a></li>
      </ul>
    </div>
    <div class="col-md-3">
      <h5 style="color:#fff; font-size:.95rem;">Instructor</h5>
      <p style="font-size:.85rem;">Dr. Vivek H. Patil<br>
      <a href="mailto:patil@gonzaga.edu" style="color:rgba(255,255,255,.7);">patil@gonzaga.edu</a><br>
      <a href="http://patilv.com" target="_blank" style="color:rgba(255,255,255,.7);">patilv.com</a></p>
    </div>
  </div>
  <hr style="border-color:rgba(255,255,255,.15); margin:1.5rem 0 1rem;">
  <p style="font-size:.78rem; text-align:center; margin:0;">&copy; Gonzaga University School of Business. Course materials by Dr. Vivek H. Patil. <em>Ad Majorem Dei Gloriam.</em></p>
</div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("week05.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
